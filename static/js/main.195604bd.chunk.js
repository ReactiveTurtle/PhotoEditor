(this["webpackJsonpphoto-editor"]=this["webpackJsonpphoto-editor"]||[]).push([[0],{150:function(e,t,n){e.exports={App:"App_App__3B_72",AppBar:"App_AppBar__2yUSo"}},188:function(e,t,n){},193:function(e,t,n){},194:function(e,t,n){},301:function(e,t,n){},302:function(e,t){},303:function(e,t,n){},304:function(e,t,n){},308:function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return sn}));var a=n(2),r=n(18),o=n(13),i=n(0),c=n.n(i),l=n(150),s=n.n(l),u=(n(188),n(59),n(343)),d=n(352),x=n(8),p=n(344),f=n(7),h=n(369),b=n(346),j=n(345),y=n(85),v=n(371),O=n(51),g=n(342),m=n(79),C=n.n(m),w=Object(f.a)((function(e){return Object(v.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:"#FFFFFF8a",borderRadius:"50%",backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21"},title:{userSelect:"none",msUserSelect:"none",fontFamily:"cursive",color:"#FFFFFFd0",marginLeft:e.spacing(2)}})}))((function(e){var t=e.children,n=e.classes,r=e.onClose,o=Object(y.a)(e,["children","classes","onClose"]);return Object(a.jsxs)(g.a,Object(x.a)(Object(x.a)({disableTypography:!0,className:n.root},o),{},{children:[Object(a.jsx)(O.a,{className:n.title,variant:"h6",children:t}),r?Object(a.jsx)(u.a,{type:"submit","aria-label":"close",className:n.closeButton,onClick:r,children:Object(a.jsx)(C.a,{})}):null]}))})),F=c.a.forwardRef((function(e,t){return Object(a.jsx)(p.a,Object(x.a)({direction:"up",ref:t},e))})),k=Object(f.a)((function(e){return{root:{padding:e.spacing(2)}}}))(j.a),T=Object(f.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(b.a),S=Object(f.a)((function(e){return{root:{"& .MuiDialog-paper":{background:"#cfcfcf33",boxShadow:"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )",backdropFilter:"blur(10.0px)",WebkitBackdropFilter:"blur( 10.0px )",borderRadius:"32px",borderTop:"1px solid rgba( 255, 255, 255, 0.18 )",borderLeft:"1px solid rgba( 255, 255, 255, 0.18 )"},"& label":{color:"#FFFFFF8a"},"& label.Mui-focused":{color:"#62ebff"},"& .MuiInputBase-root":{color:"white"},"& .MuiOutlinedInput-root":{backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21","& fieldset":{borderColor:"transparent"},"&:hover fieldset":{borderColor:"transparent"},"&.Mui-focused fieldset":{borderColor:"#62ebff42"}}}}}))(h.a);var E,M=function(e){var t=function(){e.onClose()};return Object(a.jsxs)(S,{PaperProps:{style:Object(x.a)({},e.paperStyle)},TransitionComponent:F,onClose:function(){return t()},"aria-labelledby":"customized-dialog-title",open:e.isOpen,children:[Object(a.jsx)(w,{id:"customized-dialog-title",onClose:function(){return t()},children:e.title}),Object(a.jsx)(k,{dividers:!0,onScroll:e.onScroll,style:e.contentStyle,children:e.children}),void 0!==e.actions&&Object(a.jsx)(T,{children:void 0!==e.actions&&e.actions()})]})},A=n(364),z=n(347),P=Object(z.a)((function(){return Object(v.a)({root:{"& .MuiOutlinedInput-root":{borderRadius:"24px"}}})})),L=function(e){var t=P();return Object(a.jsx)(A.a,{classes:{root:"".concat(t.root," ").concat(e.className)},label:e.label,id:void 0===e.id?"outlined-textfield":e.id,variant:"outlined",autoComplete:e.autocomplete,InputProps:{inputProps:{min:e.min}},type:e.type,defaultValue:e.text,onFocus:function(){void 0!==e.onClick&&e.onClick()},onClick:function(){void 0!==e.onClick&&e.onClick()},onChange:function(t){return e.onChange(t)}})},R=Object(z.a)((function(){return Object(v.a)({searchField:{margin:"0 8px"}})}));function I(e){var t=R(),n=Object(r.c)(),c=Object(i.useState)(!1),l=Object(o.a)(c,2),s=l[0],x=l[1],p=Object(i.useState)(!0),f=Object(o.a)(p,2),h=f[0],b=f[1],j=Object(i.useState)({x:800,y:600}),y=Object(o.a)(j,1)[0],v=function(){x(!1)},O=function(){h&&(v(),e.action.value=y,n(e.action))};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){x(!0)},children:e.children}),Object(a.jsxs)(M,{isOpen:s,title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440",onClose:function(){return v()},actions:function(){return Object(a.jsx)(d.a,{autoFocus:!0,onClick:O,color:"secondary",children:e.applyText})},children:[Object(a.jsx)(L,{className:t.searchField,text:y.x+"",type:"number",label:"\u0428\u0438\u0440\u0438\u043d\u0430",min:"0",onChange:function(e){b(""!==e.target.value),""!==e.target.value&&(y.x=Math.abs(parseInt(e.target.value)))}}),Object(a.jsx)(L,{text:y.y+"",type:"number",label:"\u0412\u044b\u0441\u043e\u0442\u0430",min:"0",onChange:function(e){b(""!==e.target.value),""!==e.target.value&&(y.y=Math.abs(parseInt(e.target.value)))}})]})]})}function D(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16),a:parseInt(e.substr(7,2),16)/255}}function N(e){return _(e)+H(Math.floor(255*e.a))}function H(e){return B(Math.floor(e/16))+B(e%16)}!function(e){e[e.Art=0]="Art",e[e.Rectangle=1]="Rectangle",e[e.Triangle=2]="Triangle",e[e.Circle=3]="Circle",e[e.TextObject=4]="TextObject",e[e.Area=5]="Area"}(E||(E={}));var W=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function B(e){return W[e]}function _(e){return"#"+H(e.r)+H(e.g)+H(e.b)}var G=n(44),V=n.n(G);function U(e,t){var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var a=n.getContext("2d");if(null===a)throw new Error;a.putImageData(t,0,0),e.drawImage(n,0,0),n.remove()}function X(e,t,n){var a,r={x:t.x,y:t.y};switch(n.type){case E.Rectangle:a=Y(e,r,n);break;case E.Triangle:a=function(e,t,n){e.beginPath(),e.moveTo(n.p0.x,n.p0.y),e.lineTo(n.p1.x,n.p1.y),e.lineTo(n.p2.x,n.p2.y),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=_(n.props.fillColor),e.fill(),n.props.strokeWidth>0&&(e.lineWidth=n.props.strokeWidth,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=_(n.props.strokeColor),e.stroke());return e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case E.Circle:a=function(e,t,n){e.beginPath(),e.moveTo(n.position.x+n.radius,n.position.y),e.arc(n.position.x,n.position.y,n.radius,0,2*Math.PI),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=_(n.props.fillColor),e.fill(),n.props.strokeWidth>0&&(e.lineWidth=n.props.strokeWidth,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=_(n.props.strokeColor),e.stroke());return e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case E.Art:a=function(e,t,n){var a=document.createElement("canvas");a.width=n.image.width,a.height=n.image.height;var r=a.getContext("2d");if(null===r)throw new Error;r.putImageData(n.image,0,0);var o=document.createElement("canvas");o.width=Math.max(1,n.size.x),o.height=Math.max(1,n.size.y);var i=o.getContext("2d");if(null===i)throw new Error;return i.scale(n.size.x/n.image.width,n.size.y/n.image.height),i.drawImage(a,0,0),e.drawImage(o,n.position.x,n.position.y),e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case E.TextObject:a=function(e,t,n){return Y(e,t,n.rectangle),e.fillStyle=_(n.textColor),V.a.fontSize=n.textSize,V.a.font="monospace",V.a.align="left",V.a.vAlign="top",V.a.lineHeight=1.15*n.textSize,V.a.drawText(e,n.text,n.rectangle.position.x+2,n.rectangle.position.y,n.rectangle.size.x,n.rectangle.size.y),e.getImageData(0,0,t.x,t.y)}(e,r,n)}if(e.globalAlpha=1,void 0===a)throw new Error;return a}function Y(e,t,n){return e.beginPath(),e.moveTo(n.position.x,n.position.y),e.lineTo(n.position.x+n.size.x,n.position.y),e.lineTo(n.position.x+n.size.x,n.position.y+n.size.y),e.lineTo(n.position.x,n.position.y+n.size.y),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=_(n.props.fillColor),e.fill(),n.props.strokeWidth>0&&(e.lineWidth=n.props.strokeWidth,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=_(n.props.strokeColor),e.stroke()),e.getImageData(0,0,t.x,t.y)}n(193);function K(e,t,n){var a={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},r=Math.max(e.x,t.x),o=Math.max(e.y,t.y);return{type:E.Rectangle,position:a,size:{x:r-a.x,y:o-a.y},props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}function J(e,t,n){var a={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},r=Math.max(e.x,t.x),o=Math.max(e.y,t.y);return{type:E.Area,position:a,size:{x:r-a.x,y:o-a.y}}}var q="REMOVE_SELECTED_OBJECT";function Z(){return{type:q}}var Q="SELECT_AREA";var $=function(e){return{type:Q,value:e}},ee="CUT_SELECTED_AREA";var te=function(){return{type:ee}},ne="PUSH_TO_HISTORY";var ae=function(e){return{type:ne,value:e}},re="REPLACE_SELECTED_OBJECT";var oe=function(e){return{type:re,value:e}},ie="SET_EDITOR";var ce,le=function(e){return{type:ie,value:e}};function se(e){switch(e){case ce.JPEG:return"jpeg";case ce.PNG:return"png";default:return"unknown"}}function ue(e){var t=new ImageData(e.width,e.height);return t.data.set(new Uint8ClampedArray(e.data)),t}function de(e){return{canvas:ue(e.selectedObject.image),selectedObject:null}}function xe(e,t){for(var n={type:E.Art,image:new ImageData(t.size.x,t.size.y),position:t.position,size:t.size},a=ue(e.canvas),r=0;r<n.size.y;r++)for(var o=0;o<n.size.x;o++){for(var i=4*(r*n.size.x+o),c=4*((r+n.position.y)*a.width+o+n.position.x),l=0;l<4;l++)n.image.data[i+l]=e.canvas.data[c+l];a.data[c+3]=0}return Object(x.a)(Object(x.a)({},e),{},{selectedObject:n,canvas:a})}function pe(e,t){var n=new Image;n.crossOrigin="anonymous",n.onload=function(){URL.revokeObjectURL(n.src);var e=document.createElement("canvas");e.width=n.width,e.height=n.height;var a=e.getContext("2d");if(null!==a){a.drawImage(n,0,0),console.log(n);var r={type:E.Art,image:a.getImageData(0,0,n.width,n.height),position:{x:0,y:0},size:{x:n.width,y:n.height}};t(r)}e.remove()},n.src=e}function fe(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=he(t,n);e(ae(null==a?r.canvas:a)),e(le(r))}function he(e,t){var n=Object(x.a)(Object(x.a)({},e),{},{selectedObject:t});if(null!=e.selectedObject){var a=document.createElement("canvas");if(a.width=e.canvas.width,a.height=e.canvas.height,null!=a){var r=a.getContext("2d");null!=r&&(r.putImageData(e.canvas,0,0),n.canvas=X(r,{x:e.canvas.width,y:e.canvas.height},e.selectedObject))}}return n}function be(e){return{canvas:ue(e.canvas),selectedObject:null}}function je(e){return Math.floor(Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)))}!function(e){e[e.JPEG=0]="JPEG",e[e.PNG=1]="PNG"}(ce||(ce={}));var ye="UPDATE_CANVAS_VIEW_MODEL";var ve=function(e){return{type:ye,value:e}},Oe="UPDATE_TEXT";function ge(e){return{type:Oe,value:e}}var me=n(310),Ce=n(312),we=n(313),Fe=n(80),ke="UPDATE_TOOL";var Te;n(194);!function(e){e[e.Rectangle=0]="Rectangle",e[e.Triangle=1]="Triangle",e[e.Circle=2]="Circle",e[e.Text=3]="Text",e[e.Area=4]="Area"}(Te||(Te={}));var Se=Object(z.a)((function(e){return Object(v.a)({root:{backgroundColor:"#FFFFFF8a"},item:{minWidth:"0",width:"48px",height:"48px",borderRadius:"24px",alignContent:"center",margin:"0 4px",padding:"0","&:hover":{background:"#42424242"}},selectedItem:{background:e.palette.secondary.light+"CC","&:hover":{background:e.palette.secondary.light}}})}));function Ee(e){var t=e.onSelected,n=Object(r.c)(),o=Object(r.d)((function(e){return e.currentTool})),i=function(e){e!==o&&(n({type:ke,value:e}),t())},c=Se();return Object(a.jsxs)(me.a,{className:"Tools-root "+c.root,children:[Object(a.jsx)(O.a,{className:"Tools-title",variant:"subtitle1",color:"inherit",children:"\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b"}),Object(a.jsxs)(Ce.a,{className:"Tools-list",component:"nav","aria-label":"\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b",children:[Object(a.jsx)(we.a,{button:!0,onClick:function(){return i(Te.Rectangle)},className:c.item+" "+(o===Te.Rectangle?c.selectedItem:""),children:Object(a.jsx)(Fe.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("rect",{x:"0",y:"0",width:"32",height:"32",fill:o===Te.Rectangle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(we.a,{button:!0,onClick:function(){return i(Te.Triangle)},className:c.item+" "+(o===Te.Triangle?c.selectedItem:""),children:Object(a.jsx)(Fe.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("polygon",{points:"0,32 32,32 16,0",fill:o===Te.Triangle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(we.a,{button:!0,onClick:function(){return i(Te.Circle)},className:c.item+" "+(o===Te.Circle?c.selectedItem:""),children:Object(a.jsx)(Fe.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("circle",{r:"16",cx:"16",cy:"16",fill:o===Te.Circle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(we.a,{button:!0,onClick:function(){return i(Te.Text)},className:c.item+" "+(o===Te.Text?c.selectedItem:""),children:Object(a.jsx)(Fe.a,{viewBox:"0 0 24 24",style:{margin:"auto"},children:Object(a.jsx)("path",{d:"M5 4v3h5.5v12h3V7H19V4z",fill:o===Te.Text?"#FFFFFF":"#424242"})})}),Object(a.jsx)(we.a,{button:!0,onClick:function(){return i(Te.Area)},className:c.item+" "+(o===Te.Area?c.selectedItem:""),children:Object(a.jsx)(Fe.a,{viewBox:"0 0 24 24",style:{margin:"auto"},children:Object(a.jsx)("path",{d:"M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z",fill:o===Te.Area?"#FFFFFF":"#424242"})})})]})]})}function Me(e,t,n,a){var r=a.canvasModel,o=Object(x.a)({},r);if(!r.isMiddleMouseDown){var i,c,l={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop},s=a.editor,u=s.selectedObject,d=r.tempObject,p=r.scale;if(r.isCanvasDown){var f=r.tempPoint,h=r.start;null!=u&&fe(t,s,null);var b=(l.x-h.x)/p,j=(l.y-h.y)/p;if("pointer"===n.style.cursor){if(null!==d&&null!==f)if(d.type===E.Rectangle||d.type===E.TextObject||d.type===E.Art||d.type===E.Area){var y;if(y=d.type===E.TextObject?d.rectangle:d,e.shiftKey&&y.type===E.Art){var v={x:b,y:j},O=je(v),g=je(y.size);b=O*(y.size.x/g),j=O*(y.size.y/g);var m=Math.sign(((i=v).x*(c=f).x+i.y*c.y)/(je(i)*je(c)));y.position.x+=b*Math.min(f.x,0)*m,y.position.y+=j*Math.min(f.y,0)*m,y.size.x+=b*m,y.size.y+=j*m}else f.x>0?y.size.x+=b:f.x<0&&(y.position.x+=b,y.size.x+=-b),f.y>0?y.size.y+=j:f.y<0&&(y.position.y+=j,y.size.y+=-j);0===y.size.x&&(y.size.x=-1),0===y.size.y&&(y.size.y=-1),y.size.x<0&&(f.x*=-1,y.size.x=Math.abs(y.size.x),y.position.x-=y.size.x),y.size.y<0&&(f.y*=-1,y.size.y=Math.abs(y.size.y),y.position.y-=y.size.y)}else if(d.type===E.Triangle)f.x+=b,f.y+=j;else if(d.type===E.Circle){var C=d;C.radius=je({x:l.x-C.position.x,y:l.y-C.position.y})}o.start=l}else if("grabbing"===n.style.cursor){var w;if(null!=d)if(d.type===E.Rectangle||d.type===E.Circle||d.type===E.TextObject||d.type===E.Art||d.type===E.Area)(w=d.type===E.TextObject?d.rectangle:d).position.x+=b,w.position.y+=j;else if(d.type===E.Triangle){var F=d;F.p0.x+=b,F.p0.y+=j,F.p1.x+=b,F.p1.y+=j,F.p2.x+=b,F.p2.y+=j}o.start=l}else"default"===n.style.cursor&&""!==a.objectState.text&&t(ge("")),function(e,n){if(r.isCanvasDown){var i=null,c=a.currentTool,l=a.objectState;switch(c){case Te.Rectangle:i=K(e,n,l);break;case Te.Triangle:i=function(e,t,n){var a={x:Math.min(e.x,t.x),y:e.y},r={x:Math.max(e.x,t.x),y:t.y};return{type:E.Triangle,p0:{x:a.x,y:a.y},p1:{x:r.x,y:a.y},p2:{x:a.x/2+r.x/2,y:r.y},props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}(e,n,l);break;case Te.Circle:i=function(e,t,n){var a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));return{type:E.Circle,position:{x:e.x,y:e.y},radius:a,props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}(e,n,l);break;case Te.Text:i=function(e,t,n){return{type:E.TextObject,rectangle:K(e,t,n),text:n.text,textSize:n.textSize,textColor:n.textColor}}(e,n,l);break;case Te.Area:i=J(e,n)}o.tempObject=i,t(ve(r))}}({x:h.x/p,y:h.y/p},{x:l.x/p,y:l.y/p})}else{var k=function(e){o.tempPoint=e};null===u&&null!==d&&d.type===E.Area?Ae(n,p,l,d,k):Ae(n,p,l,u,k),o.start=l}t(ve(o))}}function Ae(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;if(null!=a){if(a.type===E.Rectangle||a.type===E.TextObject||a.type===E.Art||a.type===E.Area){var o,i={x:(o=a.type===E.TextObject?a.rectangle:a).position.x*t,y:o.position.y*t},c={x:o.size.x*t,y:o.size.y*t},l=[{x:i.x,y:i.y},{x:i.x+c.x/2,y:i.y},{x:i.x+c.x,y:i.y},{x:i.x+c.x,y:i.y+c.y/2},{x:i.x+c.x,y:i.y+c.y},{x:i.x+c.x/2,y:i.y+c.y},{x:i.x,y:i.y+c.y},{x:i.x,y:i.y+c.y/2}],s=l.map((function(e){return je({x:e.x-n.x,y:e.y-n.y})<=12})).findIndex((function(e){return e}));s>-1?(r({x:Math.sign(l[s].x-(i.x+c.x/2)),y:Math.sign(l[s].y-(i.y+c.y/2))}),e.style.cursor="pointer"):n.x>=i.x&&n.x<=i.x+c.x&&n.y>=i.y&&n.y<=i.y+c.y?e.style.cursor="grab":e.style.cursor="default"}else if(a.type===E.Triangle){var u=a,d=[u.p0,u.p1,u.p2],x=[{x:u.p0.x*t,y:u.p0.y*t},{x:u.p1.x*t,y:u.p1.y*t},{x:u.p2.x*t,y:u.p2.y*t}],p=x.map((function(e){return je({x:e.x-n.x,y:e.y-n.y})<=12})).findIndex((function(e){return e}));p>-1?(r(d[p]),e.style.cursor="pointer"):ze(n,x[0],x[1],x[2])?e.style.cursor="grab":e.style.cursor="default"}else if(a.type===E.Circle){var f=a,h={x:f.position.x*t,y:f.position.y*t},b=f.radius*t,j=je({x:n.x-h.x,y:n.y-h.y});j>=b-12&&j<=b+12?e.style.cursor="pointer":je({x:n.x-h.x,y:n.y-h.y})<Math.max(b-12,0)?e.style.cursor="grab":e.style.cursor="default"}}else e.style.cursor="default"}function ze(e,t,n,a){var r=e.x-a.x,o=e.y-a.y,i=a.x-n.x,c=n.y-a.y,l=c*(t.x-a.x)+i*(t.y-a.y),s=c*r+i*o,u=(a.y-t.y)*r+(t.x-a.x)*o;return l<0?s<=0&&u<=0&&s+u>=l:s>=0&&u>=0&&s+u<=l}function Pe(){var e=Object(r.c)(),t=Object(r.d)((function(e){return e})),n=t.editor.selectedObject,o=t.objectState,c=t.canvasModel,l=c.tempObject,s=Object(r.d)((function(e){return e.editor}),r.b),u=s.canvas,d=c.canvasPosition;if(null!=n&&(n.type===E.Rectangle||n.type===E.Triangle||n.type===E.Circle||n.type===E.TextObject)){var p;if(n.type===E.TextObject){var f=n;f.text=o.text,f.textSize=o.textSize,f.textColor=o.textColor,p=f.rectangle.props}else p=n.props;p.fillColor=o.fillColor,p.strokeColor=o.strokeColor,p.strokeWidth=o.strokeWidth}var h=Object(i.useRef)(null),b=Object(i.useRef)(null);Object(i.useEffect)((function(){var t=c.scale;null!==b.current&&null!==h.current&&(b.current.width=Math.min(u.width*t,h.current.clientWidth),b.current.height=Math.min(u.height*t,h.current.clientHeight),null!=b.current&&function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null==e)return;var o=e.getContext("2d");if(null!=o){if(o.scale(t,t),U(o,n),null!=a&&(a.type===E.TextObject?o.putImageData(X(o,{x:n.width,y:n.height},a.rectangle),0,0):o.putImageData(X(o,{x:n.width,y:n.height},a),0,0),Re(t,a,o)),null!=r)if(r.type!==E.Area){var i=r;i.type===E.TextObject?o.putImageData(X(o,{x:n.width,y:n.height},i.rectangle),0,0):o.putImageData(X(o,{x:n.width,y:n.height},i),0,0)}else Re(t,r,o);o.scale(1/t,1/t)}}(b.current,t,u,n,c.tempObject));var a=function(n){var a=Math.sign(n.deltaY),r=t;1===a?r/=1.125:r*=1.125,c.scale=r,e(ve(c))};window.addEventListener("wheel",a);var r=function(t){1===t.button&&(document.body.style.cursor="move",null!==b.current&&(b.current.style.cursor="move"),c.isMiddleMouseDown=!0,c.middleMouseStart={x:t.clientX,y:t.clientY},e(ve(c)))};window.addEventListener("mousedown",r);var o=function(t){c.isMiddleMouseDown&&null!==b.current&&(c.canvasPosition={x:c.canvasPosition.x+(t.clientX-c.middleMouseStart.x),y:c.canvasPosition.y+(t.clientY-c.middleMouseStart.y)},b.current.style.marginLeft="".concat(c.canvasPosition.x,"px"),b.current.style.marginTop="".concat(c.canvasPosition.y,"px"),c.middleMouseStart={x:t.clientX,y:t.clientY},e(ve(c)))};window.addEventListener("mousemove",o);var i=function(t){1===t.button&&(document.body.style.cursor="default",null!==b.current&&(b.current.style.cursor="default"),c.isMiddleMouseDown=!1,e(ve(c)))};return window.addEventListener("mouseup",i),function(){window.removeEventListener("wheel",a),window.removeEventListener("mousedown",r),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",i)}}),[c,e,n,u]),Object(i.useEffect)((function(){var t=function(t){if(t.ctrlKey)if("KeyX"===t.code){if(null!=l&&l.type===E.Area){e($(l));var n=s.canvas;e(te()),e(ae(n)),c.tempObject=null,e(ve(c)),e(Z())}}else"KeyA"===t.code&&(c.tempObject=J({x:0,y:0},{x:u.width,y:u.height}),e(ve(c)));else switch(t.code){case"Escape":c.tempObject=null,e(ve(c)),fe(e,s,null),e(ge(""));break;case"Delete":if(null!=l&&l.type===E.Area){e($(l));var a=s.canvas;e(Z()),e(ae(a))}else e(Z());c.tempObject=null,e(ve(c)),e(ge(""));break;case"Enter":if(t.shiftKey)break;if(null==l||l.type!==E.Area){var r=s.canvas;e(oe(null)),e(ae(r))}c.tempObject=null,e(ve(c)),e(ge(""))}};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}));var j=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e;null===(e=j.current)||void 0===e||e.focus()})),Object(a.jsxs)("div",{ref:h,className:"Canvas-container",children:[null!==n&&n.type===E.TextObject&&Object(a.jsx)("textarea",{ref:j,style:{marginLeft:d.x+n.rectangle.position.x*c.scale+n.rectangle.props.strokeWidth/2*c.scale,marginTop:d.y+n.rectangle.position.y*c.scale+n.rectangle.props.strokeWidth/2*c.scale,position:"fixed",width:n.rectangle.size.x*c.scale,height:n.rectangle.size.y*c.scale,resize:"none",fontFamily:"monospace",fontSize:"".concat(n.textSize*c.scale,"px"),backgroundColor:"#FFFFFF00",border:"none",outline:"none",color:"".concat(N(o.textColor))},value:o.text,onChange:function(t){e(ge(t.target.value))}}),Object(a.jsx)("canvas",{id:"canvas",ref:b,className:"Canvas",width:0,height:0,style:{marginLeft:d.x,marginTop:d.y},onMouseDown:function(t){b.current&&function(e,t,n,a,r){if(0===e.button){var o=Object(x.a)({},r);if(!r.isMiddleMouseDown){var i=a.selectedObject,c=r.tempObject;if("pointer"===n.style.cursor){if(null!=i){if(o.tempObject=i,null==n.getContext("2d"))throw new Error("CanvasHandler: context is null");null!=i&&t(Z()),o.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop}}}else"grab"===n.style.cursor?(null!=i||null!==c&&c.type===E.Area)&&(n.style.cursor="grabbing",null===i&&null!==c&&c.type===E.Area||(o.tempObject=i),t(Z()),o.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop}):(null!=i&&fe(t,a,null),o.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop});o.isCanvasDown=!0,t(ve(o))}}}(t,e,b.current,s,c)},onMouseMove:function(n){b.current&&Me(n,e,b.current,t)},onMouseUp:function(n){b.current&&function(e,t,n,a){var r={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop},o=a.canvasModel,i=Object(x.a)({},o),c=a.editor,l=c.selectedObject,s=o.tempObject,u=o.scale;if(null!=s)if(Ae(n,u,r,s,(function(e){i.tempPoint=e})),s.type!==E.Area)t(oe(s)),i.tempObject=null;else{t($(s));var d=c.canvas;t(oe(null)),t(ae(d)),i.tempObject=null,t(ve(i))}else"default"===n.style.cursor&&(null!=l?fe(t,c,null,c.canvas):t(ge("")));i.isCanvasDown=!1,t(ve(i))}(n,e,b.current,t)}})]})}function Le(e,t,n){var a=e.createLinearGradient(t.x,t.y,t.x+n.x,t.y+n.y);return a.addColorStop(0,"#F00"),a.addColorStop(.2,"#FF0"),a.addColorStop(.4,"#0F0"),a.addColorStop(.6,"#0FF"),a.addColorStop(.8,"#00F"),a.addColorStop(1,"#F0F"),a}function Re(e,t,n){if(n.lineWidth=2/e,t.type===E.Rectangle||t.type===E.TextObject||t.type===E.Art||t.type===E.Area){var a;a=t.type===E.TextObject?t.rectangle:t,t.type===E.Area&&n.setLineDash([3,4]);var r={x:a.position.x,y:a.position.y},o={x:a.size.x,y:a.size.y};n.beginPath();var i=Math.min(r.y+o.y,r.y);n.moveTo(r.x-n.lineWidth,i-n.lineWidth),n.lineTo(r.x+o.x+n.lineWidth,i-n.lineWidth),n.lineTo(r.x+o.x+n.lineWidth,i+Math.abs(o.y)+n.lineWidth),n.lineTo(r.x-n.lineWidth,i+Math.abs(o.y)+n.lineWidth),n.lineTo(r.x-n.lineWidth,i-n.lineWidth),n.closePath(),n.strokeStyle=Le(n,r,o),n.fillStyle=n.strokeStyle,n.stroke();var c=[{x:r.x,y:r.y},{x:r.x+o.x/2,y:r.y},{x:r.x+o.x,y:r.y},{x:r.x+o.x,y:r.y+o.y/2},{x:r.x+o.x,y:r.y+o.y},{x:r.x+o.x/2,y:r.y+o.y},{x:r.x,y:r.y+o.y},{x:r.x,y:r.y+o.y/2}];t.type===E.Area&&n.setLineDash([]),c.forEach((function(t){n.beginPath(),n.arc(t.x,t.y,8/e,0,2*Math.PI,!1),n.closePath(),n.fill(),n.strokeStyle="#424242",n.stroke()}))}else if(t.type===E.Triangle){var l=t;n.beginPath(),n.moveTo(l.p0.x,l.p0.y),n.lineTo(l.p1.x,l.p1.y),n.lineTo(l.p2.x,l.p2.y),n.closePath();var s=[l.p0,l.p1,l.p2],u={x:Math.min(l.p0.x,l.p1.x,l.p2.x),y:Math.min(l.p0.y,l.p1.y,l.p2.y)},d={x:Math.max(l.p0.x,l.p1.x,l.p2.x),y:Math.max(l.p0.y,l.p1.y,l.p2.y)};n.strokeStyle=Le(n,u,{x:d.x-u.x,y:d.y-u.y}),n.fillStyle=n.strokeStyle,n.stroke();s.forEach((function(t){n.beginPath(),n.arc(t.x,t.y,8/e,0,2*Math.PI,!1),n.fill(),n.strokeStyle="#424242",n.stroke(),n.closePath()}))}else if(t.type===E.Circle){var x=t,p=x.position;n.beginPath(),n.moveTo(p.x+x.radius+n.lineWidth,p.y),n.arc(p.x,p.y,x.radius+n.lineWidth,0,2*Math.PI),n.closePath(),n.strokeStyle=Le(n,{x:p.x-x.radius,y:p.y-x.radius},{x:2*x.radius,y:2*x.radius}),n.fillStyle=n.strokeStyle,n.stroke()}}var Ie=n(163),De=Object(z.a)((function(){return Object(v.a)({root:{margin:"8px 0","& label":{color:"#aa00ff"},"& .MuiOutlinedInput-root":{backgroundColor:"#FFFFFFa5",boxShadow:"4px 4px 16px #646464a5, -4px -4px 16px #ffffffa5","& fieldset":{borderColor:"#aa00ff"},"&:hover fieldset":{borderColor:"#aa00ff"},"&.Mui-focused fieldset":{borderColor:"#aa00ff"}}}})}));function Ne(e){var t=De(),n=Object(i.useState)(e.defaultColor),r=Object(o.a)(n,2),c=r[0],l=r[1],s=Object(i.useState)(!1),u=Object(o.a)(s,2),d=u[0],x=u[1],p=function(t){if(void 0!==t){var n=t.rgb.a;void 0===n&&(n=1);var a={r:t.rgb.r,g:t.rgb.g,b:t.rgb.b,a:n};l(a),document.getElementById(e.id).value="".concat(N(a)),e.onChange(a)}};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{children:[d?Object(a.jsxs)("div",{style:{position:"fixed",zIndex:4},children:[Object(a.jsx)("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:function(){x(!1)}}),Object(a.jsx)("div",{ref:function(e){null!==e&&(e.style.transform="translateY(".concat(-e.clientHeight-8,"px)"))},children:Object(a.jsx)(Ie.a,{color:{r:c.r,g:c.g,b:c.b,a:c.a},disableAlpha:!1,onChangeComplete:p,onChange:p})})]}):null,Object(a.jsx)(L,{className:t.root,id:e.id,label:e.title,text:N(c),type:"text",onClick:function(){x(!d)},onChange:function(t){t.target.oninput=null;var n=D(t.target.value);l(n),e.onChange(n)}})]})})}var He="UPDATE_FILL_COLOR";var We="UPDATE_STROKE_COLOR";var Be="UPDATE_STROKE_WIDTH";var _e="UPDATE_TEXT_COLOR";var Ge="UPDATE_TEXT_SIZE";n(301);var Ve,Ue=function(){var e=De(),t=Object(r.c)(),n=Object(r.d)((function(e){return e.objectState})),o=Object(r.d)((function(e){return e.currentTool}));return Object(a.jsxs)("div",{className:"ObjectParams",children:[Object(a.jsxs)("div",{className:"ParamsList",children:[Object(a.jsx)(Ne,{id:"TextField-fillColor",title:"\u0426\u0432\u0435\u0442 \u0437\u0430\u043b\u0438\u0432\u043a\u0438",defaultColor:n.fillColor,onChange:function(e){t(function(e){return{type:He,value:e}}(e))}}),Object(a.jsx)(Ne,{id:"TextField-strokeColor",title:"\u0426\u0432\u0435\u0442 \u043a\u043e\u043d\u0442\u0443\u0440\u0430",defaultColor:n.strokeColor,onChange:function(e){t({type:We,value:e})}}),Object(a.jsx)(L,{className:e.root,label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043a\u043e\u043d\u0442\u0443\u0440\u0430",text:"".concat(n.strokeWidth),min:"0",type:"number",onChange:function(e){var n=parseInt(e.target.value);t({type:Be,value:n})}})]}),Object(a.jsxs)("div",{className:"ParamsList",children:[o===Te.Text&&Object(a.jsx)(L,{className:e.root,label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u043a\u0441\u0442\u0430",text:"".concat(n.textSize),min:"1",type:"number",onChange:function(e){var n;t((n=parseInt(e.target.value),{type:Ge,value:n}))}}),o===Te.Text&&Object(a.jsx)(Ne,{id:"TextField-textColor",title:"\u0426\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430",defaultColor:n.textColor,onChange:function(e){t({type:_e,value:e})}})]})]})},Xe=(n(302),n(365)),Ye=n(362),Ke=n(363),Je=n(361),qe=n(164),Ze=n(353),Qe=n(350),$e=n(354),et=n(351),tt=n(355);!function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Brightness=4]="Brightness",e[e.Blur=5]="Blur"}(Ve||(Ve={}));n(303);function nt(){return Object(a.jsxs)(Fe.a,{viewBox:"0 0 512 512",style:{width:"100%",height:"100%"},children:[Object(a.jsx)("path",{style:{fill:"#FFE17D"},d:"M214.71,306.106v197.626c0,6.139,6.46,10.132,11.951,7.386l61.5-30.75  c5.595-2.798,9.13-8.517,9.13-14.772v-159.49c0-5.702,1.967-11.229,5.568-15.649L473.4,81.157c3.602-4.42,5.568-9.947,5.568-15.649  V16.516C478.968,7.395,471.573,0,462.452,0H49.548c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649  l170.541,209.3C212.743,294.877,214.71,300.404,214.71,306.106z"}),Object(a.jsx)("path",{style:{fill:"#FFD164"},d:"M404.355,66.065H198.194c-4.561,0-8.258-3.697-8.258-8.258V0H49.548  c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649l170.541,209.3c3.602,4.42,5.569,9.948,5.569,15.65  v197.625c0,6.139,6.46,10.132,11.951,7.386l17.105-8.552V305.548c0-4.561,3.697-8.258,8.258-8.258h11.74  c5.474,0,10.593-2.712,13.667-7.242L415.346,86.804C421.33,77.985,415.013,66.065,404.355,66.065z"}),Object(a.jsx)("path",{style:{fill:"#FFC350"},d:"M123.502,66.065H33.08c0.126,5.502,2.037,10.817,5.52,15.091l170.541,209.3  c1.681,2.064,2.968,4.383,3.903,6.835h6.065c5.821,0,9.814-5.86,7.686-11.278L146.561,81.78  C142.836,72.299,133.688,66.065,123.502,66.065z"})]})}var at=Object(z.a)((function(e){return Object(v.a)({button:{backgroundColor:"#9d46ff",color:"#FFFFFF",fontWeight:600,fontFamily:"monospace",fontSize:"16px",margin:"8px",padding:"16px",width:"56px",height:"56px","&:hover":{backgroundColor:"#7200ca"}},paper:{marginTop:"4px",backgroundColor:"#8eacbbbe",color:"white"}})}));function rt(e){var t=at(),n=c.a.useState(!1),r=Object(o.a)(n,2),i=r[0],l=r[1],s=c.a.useRef(null),d=function(e){s.current&&s.current.contains(e.target)||l(!1)};function p(e){"Tab"===e.key&&(e.preventDefault(),l(!1))}var f=c.a.useRef(i);return c.a.useEffect((function(){!0===f.current&&!1===i&&s.current.focus(),f.current=i}),[i]),Object(a.jsxs)("div",{className:"FiltersContainer",children:[Object(a.jsx)(u.a,{edge:"end",className:t.button,ref:s,onClick:function(){l((function(e){return!e}))},color:"primary",children:Object(a.jsx)(nt,{})}),Object(a.jsx)("div",{children:Object(a.jsx)(Ze.a,{open:i,anchorEl:s.current,role:void 0,transition:!0,disablePortal:!0,children:function(n){var r=n.TransitionProps,o=n.placement;return Object(a.jsx)(Qe.a,Object(x.a)(Object(x.a)({},r),{},{style:{transformOrigin:"bottom"===o?"center top":"center bottom"},children:Object(a.jsx)(me.a,{className:t.paper,children:Object(a.jsx)($e.a,{onClickAway:d,children:Object(a.jsxs)(et.a,{autoFocusItem:i,id:"menu-list-grow",onKeyDown:p,children:[Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Grey),d(t)},children:"\u0421\u0435\u0440\u044b\u0439"}),Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Red),d(t)},children:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439"}),Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Green),d(t)},children:"\u0417\u0435\u043b\u0451\u043d\u044b\u0439"}),Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Blue),d(t)},children:"\u0421\u0438\u043d\u0438\u0439"}),Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Brightness),d(t)},children:"\u042f\u0440\u043a\u043e\u0441\u0442\u044c"}),Object(a.jsx)(tt.a,{onClick:function(t){e.onSelect(Ve.Blur),d(t)},children:"\u0420\u0430\u0437\u043c\u044b\u0442\u0438\u0435"})]})})})}))}})})]})}function ot(e,t,n){for(var a=0;a<t.height;a++)for(var r=0;r<t.width;r++)for(var o=4*(a*t.width+r),i=0;i<4;i++)t.data[o+i]=e.data[o+i]*n[i]}var it=n(372),ct=n(356),lt=(n(304),Object(z.a)((function(e){return Object(v.a)({fab:{marginLeft:"24px"},slider:{width:"350px"}})})));function st(e){var t=e.onApply,n=e.onChange,r=lt(),c=Object(i.useState)(1),l=Object(o.a)(c,2),s=l[0],u=l[1];return Object(a.jsx)("div",{className:"BrightnessSlider-container",children:Object(a.jsxs)("div",{className:"BrightnessSlider-center",children:[Object(a.jsx)(it.a,{className:r.slider,defaultValue:1,"aria-labelledby":"discrete-slider-custom",step:.01,min:0,max:4,valueLabelDisplay:"auto",onChange:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var a=t;u(a),n(a)}))}),Object(a.jsx)(ct.a,{color:"primary","aria-label":"add",size:"small",className:r.fab,onClick:function(e){return t(s)},children:Object(a.jsx)(Fe.a,{children:Object(a.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})]})})}function ut(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];return function(e,t){n||(a(!0),setTimeout((function(){t(),a(!1)}),e))}}var dt=Object(f.a)((function(e){return Object(v.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},title:{fontFamily:"cursive"}})}))((function(e){var t=e.children,n=e.classes,r=e.onClose,o=Object(y.a)(e,["children","classes","onClose"]);return Object(a.jsxs)(g.a,Object(x.a)(Object(x.a)({disableTypography:!0,className:n.root},o),{},{children:[Object(a.jsx)(O.a,{className:n.title,variant:"h6",children:t}),r?Object(a.jsx)(u.a,{"aria-label":"close",className:n.closeButton,onClick:r,children:Object(a.jsx)(C.a,{})}):null]}))})),xt=c.a.forwardRef((function(e,t){return Object(a.jsx)(p.a,Object(x.a)({direction:"up",ref:t},e))})),pt=Object(f.a)((function(e){return{root:{padding:e.spacing(2)}}}))(j.a);function ft(e){return Object(a.jsx)("div",{children:Object(a.jsxs)(h.a,{TransitionComponent:xt,onClose:function(){return e.onClose()},"aria-labelledby":"customized-dialog-title",open:e.isOpen,children:[Object(a.jsx)(dt,{id:"customized-dialog-title",onClose:function(){return e.onClose()},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"}),Object(a.jsxs)(pt,{dividers:!0,children:[Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){e.onSaveSize(),e.onClose()},color:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u043e\u043b\u043e\u0442\u043d\u0430"}),Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){e.onChangeSize(),e.onClose()},color:"primary",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u043e\u043b\u043e\u0442\u043d\u0430"}),Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){return e.onClose()},color:"primary",children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]})})}var ht="UNDO_HISTORY";var bt=function(){return{type:ht}},jt="REDO_HISTORY";var yt=function(){return{type:jt}},vt="EDIT_CANVAS_SIZE";var Ot=function(e){return{type:vt,value:e}},gt="APPLY_FILTER";var mt=function(e){return{type:gt,value:e}},Ct="CREATE_NEW_CANVAS";var wt=function(e){return{type:Ct,value:e}},Ft=n(360),kt=n(86),Tt=n(348),St=n(349),Et=n(370),Mt=n(357),At=n(366),zt=Object(z.a)((function(){return Object(v.a)({slider:{width:"272px",margin:"8px 8px 0 8px"},quality_label:{color:"#FFFFFFa5",marginTop:"16px","&.Mui-focused":{color:"#FFFFFFa5"}},label:{color:"#FFFFFFa5","&.Mui-focused":{color:"#FFFFFFa5"}},radioGroup:{marginTop:"8px",flexDirection:"row"},radio:{color:"#FFFFFF8a"}})}));function Pt(e){var t=zt(),n=c.a.useState(!1),r=Object(o.a)(n,2),i=r[0],l=r[1],s=function(){l(!1)},x=c.a.useState(ce.JPEG),p=Object(o.a)(x,2),f=p[0],h=p[1],b=c.a.useState(90),j=Object(o.a)(b,2),y=j[0],v=j[1],O=function(){s(),e.onApply(f,y)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){l(!0)},children:Object(a.jsxs)(Fe.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"})]})}),Object(a.jsx)(M,{isOpen:i,onClose:function(){return s()},title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",actions:function(){return Object(a.jsx)(d.a,{autoFocus:!0,onClick:O,color:"secondary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})},children:Object(a.jsxs)(Tt.a,{component:"fieldset",children:[Object(a.jsx)(St.a,{component:"legend",classes:{root:t.label},children:"\u0424\u043e\u0440\u043c\u0430\u0442"}),Object(a.jsxs)(Et.a,{className:t.radioGroup,"aria-orientation":"horizontal","aria-label":"format",name:"format1",value:se(f),onChange:function(e){switch(e.target.value){case"jpeg":h(ce.JPEG);break;case"png":h(ce.PNG);break;default:throw new Error}},children:[Object(a.jsx)(Mt.a,{value:"jpeg",control:Object(a.jsx)(At.a,{className:t.radio}),label:"JPEG"}),Object(a.jsx)(Mt.a,{value:"png",control:Object(a.jsx)(At.a,{className:t.radio}),label:"PNG"})]}),Object(a.jsx)(St.a,{component:"legend",classes:{root:t.quality_label},children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(a.jsx)(it.a,{className:t.slider,defaultValue:90,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:100,valueLabelDisplay:"auto",onChange:function(e,t){v(t)}})]})})]})}var Lt,Rt=n(358),It=n(359);function Dt(e){var t=c.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],l=function(){i(!1)},s=function(t){e.onApply(t),l()};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){i(!0)},children:Object(a.jsx)(Fe.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{d:"M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z"})})}),Object(a.jsx)(M,{isOpen:r,title:"\u0412\u0441\u0442\u0430\u0432\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",onClose:l,paperStyle:{width:"320px"},children:Object(a.jsxs)(Ce.a,{style:{color:"#FFFFFFa5"},component:"nav","aria-label":"",children:[Object(a.jsxs)(we.a,{button:!0,onClick:function(){return s(Lt.STORAGE)},children:[Object(a.jsx)(Rt.a,{children:Object(a.jsx)(Fe.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{fill:"#F5F5F58a",d:"M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12z"})})}),Object(a.jsx)(It.a,{primary:"\u041a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440"})]}),Object(a.jsxs)(we.a,{button:!0,onClick:function(){return s(Lt.PEXELS)},children:[Object(a.jsx)(Rt.a,{children:Object(a.jsxs)(Fe.a,{viewBox:"0 0 32 32",children:[Object(a.jsx)("path",{d:"M2 0h28a2 2 0 0 1 2 2v28a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2z",fill:"#05A081"}),Object(a.jsx)("path",{d:"M13 21h3.863v-3.752h1.167a3.124 3.124 0 1 0 0-6.248H13v10zm5.863 2H11V9h7.03a5.124 5.124 0 0 1 .833 10.18V23z",fill:"#fff"})]})}),Object(a.jsx)(It.a,{primary:"\u0421\u0435\u0440\u0432\u0438\u0441 Pexels"})]}),Object(a.jsxs)(we.a,{button:!0,onClick:function(){return s(Lt.WEB_CAMERA)},children:[Object(a.jsx)(Rt.a,{children:Object(a.jsx)(Fe.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{fill:"#F5F5F58a",d:"M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 \r 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35.06-.1zM21.54 \r 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9h9.66zm.26 1h-7.49l.29.5 \r 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2zM8.54 \r 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 \r 2h7.49l-1.15-2zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 \r 15H2.46zm11.27 0l-3.9 6.76c.7.15 1.42.24 2.17.24 \r 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35-.93 1.6z"})})}),Object(a.jsx)(It.a,{primary:"\u0412\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0430"})]})]})})]})}!function(e){e[e.STORAGE=0]="STORAGE",e[e.PEXELS=1]="PEXELS",e[e.WEB_CAMERA=2]="WEB_CAMERA"}(Lt||(Lt={}));var Nt=n(160),Ht=n.n(Nt),Wt=Object(z.a)((function(){return Object(v.a)({searchContainer:{width:"100%",display:"inline-flex",textAlign:"center"},searchField:{width:"40%",marginLeft:"auto",borderRadius:"24px"},searchButtonWrapper:{display:"flex",width:"fit-content",height:"fit-content",margin:"auto auto auto 8px",borderRadius:"50%",backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21"},photoLineContainer:{display:"inline-block",position:"relative",verticalAlign:"top",width:"24%"},searchResultsWrapper:{textAlign:"start",margin:"auto",width:"69%",color:"#FFFFFFd0",font:"24px cursive"},error:{margin:"16px auto 0 auto",width:"fit-content"},photo:{cursor:"pointer"}})})),Bt=n(159),_t=Object(Bt.a)("563492ad6f917000010000011d7c21ba52c34f0abbefd675f9034e42");function Gt(e,t,n){"Rate limit exceeded"!==e.error?t(e.photos):n()}var Vt=n(367);function Ut(e){var t=Wt(),n=Object(i.useState)(!1),r=Object(o.a)(n,2),c=r[0],l=r[1],s=Object(i.useState)(!1),d=Object(o.a)(s,2),x=d[0],p=d[1],f=Object(i.useState)(0),h=Object(o.a)(f,2),b=h[0],j=h[1],y=Object(i.useState)(""),v=Object(o.a)(y,2),O=v[0],g=v[1],m=Object(i.useState)([]),C=Object(o.a)(m,2),w=C[0],F=C[1],k=ut(),T=function(){!function(e,t,n,a,r){""===e?_t.photos.curated({query:e,per_page:9,page:t,locale:"ru-RU"}).then((function(e){Gt(e,n,a)})):_t.photos.search({query:e,per_page:9,page:t,locale:"ru-RU"}).then((function(e){Gt(e,n,a)}))}(O,b,(function(e){c&&l(!1),j(b+1),F(b>1?w.concat(e):e)}),(function(){console.log("\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d \u043b\u0438\u043c\u0438\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432"),c||l(!0),p(!0),k(3e3,(function(){p(!1)}))}))},S=function(){j(0),T()},E=function(t){pe(t.src.original,(function(t){e.onApply(t)}))};return Object(i.useEffect)((function(){var e=function(e){"Enter"===e.key&&S()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}})),Object(a.jsxs)(M,{title:"\u041f\u043e\u0438\u0441\u043a \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u0432 Pexels",paperStyle:{width:"72%",maxWidth:"72%"},contentStyle:{textAlign:"center"},isOpen:e.isOpen,onScroll:function(e){var t=e.currentTarget;t.offsetHeight+t.scrollTop>=t.scrollHeight&&T()},onClose:function(){e.onClose()},children:[Object(a.jsxs)("div",{className:t.searchContainer,children:[Object(a.jsx)(L,{className:t.searchField,text:O,type:"text",label:"\u041f\u043e\u0438\u0441\u043a",autocomplete:"off",onChange:function(e){g(e.target.value)}}),Object(a.jsx)("div",{className:t.searchButtonWrapper,children:Object(a.jsx)(u.a,{type:"submit","aria-label":"search",onClick:function(){return S()},children:Object(a.jsx)(Ht.a,{htmlColor:"#FFFFFF8a"})})})]}),w.length>0&&!c&&Object(a.jsx)("div",{className:t.searchResultsWrapper,children:Object(a.jsx)("h5",{children:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u0430"})}),x&&Object(a.jsx)(Vt.a,{className:t.error,variant:"filled",severity:"error",children:"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043b\u0438\u043c\u0438\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432. \u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0432\u0440\u0435\u043c\u044f"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 0===Xt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return E(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e.id)}))}),Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 1===Xt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return E(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e.id)}))}),Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 2===Xt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return E(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e.id)}))})]})]})}function Xt(e,t){var n=t-t%3,a=e[n].height/e[n].width,r=e[n+1].height/e[n+1].width,o=e[n+2].height/e[n+2].width,i=[3];a<=r?r<=o?(i[0]=0,i[1]=1,i[2]=2):(o<a?(i[0]=2,i[1]=0):(i[0]=0,i[1]=2),i[2]=1):a<=o?(i[0]=1,i[1]=0,i[2]=2):(o<r?(i[0]=2,i[1]=1):(i[0]=1,i[1]=2),i[2]=0);var c=(t- -Math.floor(t/3+1)%3+3)%3;return console.log(n+"- "+t+": "+c+" & "+Math.round(t/3+1)),i[c]}var Yt=Object(qe.a)({palette:{primary:{main:Ft.a.A700},secondary:{main:Ft.a.A700,light:kt.a.A400}}}),Kt=Object(z.a)((function(e){return Object(v.a)({root:{flexGrow:1,width:"100%"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,textAlign:"start",fontFamily:"cursive"}})}));var Jt=function(){var e=Kt(),t=ut(),n=Object(r.c)(),c=Object(r.d)((function(e){return e.editor}),r.b),l=Object(r.d)((function(e){return e.currentTool})),u=Object(i.useState)(!1),d=Object(o.a)(u,2),x=d[0],p=d[1],f=Object(i.useState)(null),h=Object(o.a)(f,2),b=h[0],j=h[1],y=Object(i.useState)(!1),v=Object(o.a)(y,2),g=v[0],m=v[1],C=Object(i.useState)(!1),w=Object(o.a)(C,2),F=w[0],k=w[1],T=Object(i.useState)(null),S=Object(o.a)(T,2),E=S[0],M=S[1];return Object(i.useEffect)((function(){var e=function(e){e.ctrlKey&&("KeyZ"===e.code?n(bt()):"KeyY"===e.code&&n(yt()))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}})),Object(a.jsx)("div",{className:s.a.App,id:"App",children:Object(a.jsxs)(Je.a,{theme:Yt,children:[Object(a.jsx)(Pe,{}),Object(a.jsxs)(Xe.a,{position:"fixed",className:e.root,children:[Object(a.jsx)(Ye.a,{position:"static",style:{background:"#6200ea"},children:Object(a.jsxs)(Ke.a,{children:[Object(a.jsx)(O.a,{variant:"h6",color:"inherit",className:e.title,children:"Reactive Photo Editor"}),Object(a.jsx)(I,{applyText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",action:wt({x:0,y:0}),children:Object(a.jsxs)(Fe.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})]})}),Object(a.jsx)(I,{applyText:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",action:Ot({x:0,y:0}),children:Object(a.jsxs)(Fe.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})]})}),Object(a.jsx)(Dt,{onApply:function(e){switch(e){case Lt.STORAGE:!function(e){if(null!==document){var t=document.createElement("input");t.type="file",t.click(),null!==t&&(t.onchange=function(t){var n=t.target;if(null!=n.files){var a=n.files[0];pe(URL.createObjectURL(a),e)}})}}((function(e){M(e),m(!0)}));break;case Lt.PEXELS:k(!0)}}}),Object(a.jsx)(Pt,{onApply:function(e,t){!function(e,t,n){var a=se(t),r=document.createElement("canvas");if(r.width=e.width,r.height=e.height,null!=r){var o=r.getContext("2d");null!=o&&(o.putImageData(e,0,0),r.toBlob((function(e){if(null!=e){var t=window.URL.createObjectURL(new Blob([e])),n=document.createElement("a");n.href=t,n.setAttribute("download","image.".concat(a)),document.body.appendChild(n),n.click(),n.remove(),r.remove()}}),"image/".concat(a),n/100))}}(he(c,null).canvas,e,t)}}),Object(a.jsx)(ft,{isOpen:g,onSaveSize:function(){var e=null!==c.selectedObject,t=c.canvas;n(oe(E)),e&&n(ae(t))},onChangeSize:function(){var e=null!==c.selectedObject,t=c.canvas;if(null===E)throw new Error;n(Ot(E.size)),n(oe(E)),e&&n(ae(t))},onClose:function(){m(!1),M(null)}}),Object(a.jsx)(Ut,{isOpen:F,onClose:function(){k(!1)},onApply:function(e){M(e),m(!1)}})]})}),Object(a.jsx)(Ee,{onSelected:function(){if(x){if(null===b)throw new Error;n(le(b)),p(!1)}}}),Object(a.jsx)(rt,{onSelect:function(e){var t=c;if(null!=c.selectedObject){var a=he(c,null);n(ae(a.canvas)),n(le(a)),t=a}e!==Ve.Brightness&&e!==Ve.Blur?n(mt(e)):(j(t),p(!0))}})]}),l!==Te.Area&&Object(a.jsx)(Ue,{}),x&&Object(a.jsx)(st,{onChange:function(e){null!==b&&t(16,(function(){var t=function(e,t){for(var n=new ImageData(e.canvas.width,e.canvas.height),a=e.canvas,r=0;r<n.height;r++)for(var o=0;o<n.width;o++){for(var i=4*(r*n.width+o),c=0;c<3;c++)n.data[i+c]=a.data[i+c]*t;n.data[i+3]=a.data[i+3]}return{selectedObject:null,canvas:n}}(b,e);n(le(t))}))},onApply:function(e){if(p(!1),1!==e){var t=he(c,null);n(ae(t.canvas)),n(le(t))}}})]})})},qt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,374)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))},Zt=n(161),Qt=function(e,t){var n=new ImageData(t.x,t.y);return n.data.fill(255),Object(x.a)(Object(x.a)({},e),{},{selectedObject:null,canvas:n})}({selectedObject:null,canvas:new ImageData(1,1)},{x:800,y:600}),$t={editor:Qt,imageHistory:{history:[Qt.canvas],currentHistoryPosition:0},currentTool:Te.Rectangle,objectState:{fillColor:D("#00CCCCFF"),strokeColor:D("#CC0000FF"),strokeWidth:4,text:"",textSize:24,textColor:D("#424242FF")},canvasModel:{isCanvasDown:!1,start:{x:0,y:0},tempObject:null,isMiddleMouseDown:!1,middleMouseStart:{x:0,y:0},tempPoint:null,scale:1,canvasPosition:{x:(window.innerWidth-Qt.canvas.width)/2,y:(window.innerHeight-Qt.canvas.height)/2}}};function en(e,t){for(var n={history:e.history.flatMap((function(e){return ue(e)})),currentHistoryPosition:e.currentHistoryPosition};n.currentHistoryPosition<n.history.length-1;)n.history.pop();return n.currentHistoryPosition===n.history.length-1&&n.currentHistoryPosition++,n.history.push(ue(t)),n}var tn=function(e,t){var n=t.value;switch(t.type){case Ct:var a=new ImageData(t.value.x,t.value.y);return a.data.fill(255),a;case vt:var r=new ImageData(n.x,n.y);r.data.fill(255);for(var o=Math.min(n.x,e.width),i=Math.min(n.y,e.height),c=0;c<i;c++)for(var l=0;l<o;l++)for(var s=4*(c*n.x+l),u=4*(c*e.width+l),d=0;d<4;d++)r.data[s+d]=e.data[u+d];return r;default:return ue(e)}},nn=function(e,t){return void 0===e?e:(t.type,{canvas:tn(e.canvas,t),selectedObject:e.selectedObject})},an=function(e,t){if(void 0===e)throw new Error;switch(t.type){case He:return Object(x.a)(Object(x.a)({},e),{},{fillColor:t.value});case We:return Object(x.a)(Object(x.a)({},e),{},{strokeColor:t.value});case Be:return Object(x.a)(Object(x.a)({},e),{},{strokeWidth:t.value});case Oe:return Object(x.a)(Object(x.a)({},e),{},{text:t.value});case Ge:return Object(x.a)(Object(x.a)({},e),{},{textSize:t.value});case _e:return Object(x.a)(Object(x.a)({},e),{},{textColor:t.value});default:return e}},rn=function(e,t){if(void 0===e)throw new Error;var n=e.editor,a={canvas:n.canvas,selectedObject:n.selectedObject},r=e.imageHistory;switch(t.type){case ie:return Object(x.a)(Object(x.a)({},e),{},{editor:t.value});case ht:return function(e){var t={selectedObject:e.editor.selectedObject,canvas:e.editor.canvas},n=e.imageHistory;if(n.history.length>0&&(n.currentHistoryPosition>0||null!=t.selectedObject)){if(null==t.selectedObject)n.currentHistoryPosition--;else{if(n=en(n,ue((t=he(t,null)).canvas)),void 0===e)throw new Error;n.currentHistoryPosition--}t.canvas=ue(n.history[n.currentHistoryPosition])}return Object(x.a)(Object(x.a)({},e),{},{imageHistory:n,editor:t})}(e);case jt:return function(e){var t={selectedObject:e.editor.selectedObject,canvas:e.editor.canvas},n=e.imageHistory;return n.history.length>0&&n.currentHistoryPosition<n.history.length-1&&(n.currentHistoryPosition++,t.canvas=ue(n.history[n.currentHistoryPosition])),Object(x.a)(Object(x.a)({},e),{},{editor:t,imageHistory:n})}(e);case ne:return Object(x.a)(Object(x.a)({},e),{},{imageHistory:en(r,t.value)});case ke:return Object(x.a)(Object(x.a)({},e),{},{currentTool:t.value});case gt:var o;return en(r,a.canvas),o=en(r,(a=function(e,t){var n=new ImageData(e.canvas.width,e.canvas.height);switch(t){case Ve.Red:ot(e.canvas,n,[1,0,0,1]);break;case Ve.Green:ot(e.canvas,n,[0,1,0,1]);break;case Ve.Blue:ot(e.canvas,n,[0,0,1,1]);break;case Ve.Grey:!function(e,t){for(var n=0;n<t.height;n++)for(var a=0;a<t.width;a++){for(var r=4*(n*t.width+a),o=(e.data[r]+e.data[r+1]+e.data[r+2])/3,i=0;i<3;i++)t.data[r+i]=o;t.data[r+3]=e.data[r+3]}}(e.canvas,n)}return Object(x.a)(Object(x.a)({},e),{},{canvas:n})}(a,t.value)).canvas),Object(x.a)(Object(x.a)({},e),{},{imageHistory:o,editor:a});case Q:return Object(x.a)(Object(x.a)({},e),{},{editor:xe(n,t.value)});case ee:return Object(x.a)(Object(x.a)({},e),{},{editor:de(n)});case re:return a=he(n,t.value),Object(x.a)(Object(x.a)({},e),{},{editor:a});case q:return Object(x.a)(Object(x.a)({},e),{},{editor:be(n)});case ye:return Object(x.a)(Object(x.a)({},e),{},{canvasModel:t.value});default:var i=nn(e.editor,t);if(void 0===i)throw new Error;var c=an(e.objectState,t);if(void 0===c)throw new Error;return{editor:i,imageHistory:e.imageHistory,currentTool:e.currentTool,objectState:c,canvasModel:e.canvasModel}}},on=Object(Zt.a)(rn,$t),cn=n(12),ln=n.n(cn);function sn(){ln.a.render(Object(a.jsx)(r.a,{store:on,children:Object(a.jsx)(Jt,{})}),document.getElementById("root"))}sn(),qt()},59:function(e,t,n){}},[[308,1,2]]]);
//# sourceMappingURL=main.195604bd.chunk.js.map