{"version":3,"sources":["components/canvas/Canvas.module.css","components/tool/Tools.module.css","components/brightslider/BrightnessSlider.module.css","components/webcameradialog/WebCameraDialog.module.css","App.module.css","components/reactivedialog/DialogTitle.tsx","components/reactivedialog/ReactiveDialog.tsx","structures/Type.tsx","components/reactivetextfield/ReactiveTextFieldStyle.tsx","components/reactivetextfield/ReactiveTextField.tsx","components/selectsizepopup/SelectSizeDialogStyle.tsx","components/selectsizepopup/SelectSizeDialog.tsx","helper/ColorHelper.tsx","helper/DrawHelper.tsx","helper/ObjectCreateHelper.tsx","store/actions/removeSelectedObject.tsx","store/actionCreators/removeSelectedObject.tsx","store/actions/selectArea.tsx","store/actionCreators/selectArea.tsx","store/actions/cutSelectedArea.tsx","store/actionCreators/cutSelectedArea.tsx","store/actions/pushToHistory.tsx","store/actionCreators/pushToHistory.tsx","store/actions/actionReplaceSelectedObject.tsx","store/actionCreators/actionReplaceSelectedObject.tsx","store/actions/setEditor.tsx","store/actionCreators/setEditor.tsx","structures/ExportFormat.tsx","helper/CanvasHelper.tsx","helper/EditorHelper.tsx","helper/VectorHelper.tsx","store/actions/updateCanvasViewModel.tsx","store/actionCreators/updateCanvasViewModel.tsx","store/actions/updateText.tsx","store/actionCreators/updateText.tsx","store/actions/updateTool.tsx","components/tool/Tools.tsx","store/actionCreators/updateTool.tsx","components/canvas/CanvasHandler.tsx","components/canvas/Canvas.tsx","objectparams/ObjectParamsStyle.tsx","components/colopicker/TextColorPicker.tsx","store/actions/updateFillColor.tsx","store/actions/updateStrokeColor.tsx","store/actions/updateStrokeWidth.tsx","store/actions/updateTextColor.tsx","store/actions/updateTextSize.tsx","store/actions/updateFontName.tsx","store/actions/updateTextPadding.tsx","objectparams/ObjectParams.tsx","structures/Filter.tsx","store/actionCreators/updateFillColor.tsx","store/actionCreators/updateStrokeColor.tsx","store/actionCreators/updateStrokeWidth.tsx","store/actionCreators/updateTextSize.tsx","store/actionCreators/updateTextColor.tsx","store/actionCreators/updateFontName.tsx","store/actionCreators/updateTextPadding.tsx","components/filtermenu/FIltersIcon.tsx","components/filtermenu/FilterMenu.tsx","helper/FilterHelper.tsx","components/brightslider/BrightnessSlider.tsx","components/timeout/Timeout.tsx","components/pasteartdialog/PasteArtDialog.tsx","store/actions/undoHistory.tsx","store/actionCreators/undoHistory.tsx","store/actions/redoHistory.tsx","store/actionCreators/redoHistory.tsx","store/actions/editCanvasSize.tsx","store/actionCreators/editCanvasSize.tsx","store/actions/applyFilter.tsx","store/actionCreators/applyFilter.tsx","store/actions/createNewCanvas.tsx","store/actionCreators/createNewCanvas.tsx","components/exportdialog/ExportDialog.tsx","structures/ImportType.tsx","components/importdialog/ImportDialog.tsx","components/pexelsartdialog/PexelsSearchDialogStyle.tsx","components/pexelsartdialog/PexelsManager.tsx","components/pexelsartdialog/PexelsSearchDialog.tsx","components/pexelsartdialog/size/PexelsSelectSizeDialogStyle.tsx","components/pexelsartdialog/size/PexelsSelectSizeDialog.tsx","components/pexelsartdialog/progress/ProgressDialog.tsx","components/webcameradialog/WebCameraDialog.tsx","components/webcameradialog/WebCameraHelper.tsx","App.tsx","reportWebVitals.ts","store/initialState.tsx","helper/HistoryHelper.tsx","store/reducers/updateObjectState.tsx","store/reducers/rootReducer.tsx","store/store.tsx","index.tsx","objectparams/ObjectParams.module.css"],"names":["module","exports","DialogTitle","withStyles","theme","createStyles","root","margin","padding","spacing","closeButton","position","right","top","color","borderRadius","backgroundColor","boxShadow","title","userSelect","msUserSelect","fontFamily","marginLeft","props","children","classes","onClose","other","disableTypography","className","Typography","variant","IconButton","type","aria-label","onClick","Transition","React","forwardRef","ref","Slide","direction","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Dialog","background","backdropFilter","WebkitBackdropFilter","borderTop","borderLeft","borderColor","MuiDialog","ReactiveDialog","Types","close","PaperProps","style","paperStyle","TransitionComponent","aria-labelledby","open","isOpen","id","dividers","onScroll","contentStyle","undefined","actions","useStyles","makeStyles","ReactiveTextField","TextField","label","autoComplete","autocomplete","InputProps","inputProps","min","value","text","defaultValue","defaultText","onFocus","onChange","e","searchField","SelectSizeDialog","dispatch","useDispatch","useState","setOpen","canApply","setCanApply","x","y","size","handleClose","handleCloseAndCreate","action","Button","autoFocus","applyText","target","Math","abs","parseInt","toRGBAColor","hex","r","substr","g","b","a","toHexColor","getRGB","to2dHex","floor","num","getAnalog","drawImageData","context","imageData","canvas","document","createElement","width","height","ctx","getContext","Error","putImageData","drawImage","remove","drawObject","selectedObject","newImageData","canvasSize","Rectangle","drawRectangle","Triangle","triangle","beginPath","moveTo","p0","lineTo","p1","p2","closePath","globalAlpha","fillColor","fillStyle","fill","strokeWidth","lineWidth","strokeColor","strokeStyle","stroke","getImageData","drawTriangle","Circle","circle","arc","radius","PI","drawCircle","Art","art","canvasCtx","image","imageCtx","canvasScaled","max","imageScaled","scale","drawArt","TextObject","rectangle","textColor","canvasTxt","fontSize","textSize","font","fontName","align","vAlign","lineHeight","drawText","createRectangle","downStart","moveEnd","objectState","start","end","round","rotation","createArea","Area","REMOVE_SELECTED_OBJECT","removeSelectedObject","SELECT_AREA","selectArea","CUT_SELECTED_AREA","cutSelectedArea","PUSH_TO_HISTORY","pushToHistory","REPLACE_SELECTED_OBJECT","actionReplaceSelectedObject","obj","SET_EDITOR","setEditor","ExportFormat","formatToString","format","JPEG","PNG","copyImageData","ImageData","data","set","Uint8ClampedArray","editor","importImageUrl","url","onResult","onProgress","request","XMLHttpRequest","onprogress","loaded","total","onload","img","Image","blob","Blob","this","response","URL","revokeObjectURL","src","clientWidth","clientHeight","window","createObjectURL","body","appendChild","responseType","overrideMimeType","send","replaceSelectedObjectWithHistory","newSelectedObject","historyImage","newEditor","replaceSelectedObject","length","vector","sqrt","pow","UPDATE_CANVAS_VIEW_MODEL","updateCanvasViewModel","model","UPDATE_TEXT","updateText","UPDATE_TOOL","ToolType","item","minWidth","alignContent","selectedItem","palette","secondary","light","Tools","onSelected","currentTool","useSelector","state","tool","Paper","styles","ToolsRoot","List","ToolsList","component","ListItem","button","SvgIcon","viewBox","points","cx","cy","Text","d","onMouseMove","viewModel","canvasViewModel","canvasModel","newCanvasViewModel","isMiddleMouseDown","first","second","clientX","offsetLeft","clientY","offsetTop","tempObject","isCanvasDown","tempPoint","deltaX","deltaY","cursor","objRA","shiftKey","delta","distance","sizeLength","dir","sign","console","log","objRCA","newObject","createTriangle","len","createCircle","createText","onCreateObject","setTempPoint","point","setupCursor","pointIndex","map","p","findIndex","scaledPoints","pointInTriangle","dX","dY","dX21","dY12","D","s","t","Canvas","focused","shallowEqual","canvasPosition","drawProps","textObject","canvasContainer","useRef","canvasElement","useEffect","current","tempCanvasObject","drawBorder","objRTCTA","renderCanvas","wheelListener","newScale","scroll","exp","newX","newY","addEventListener","mouseDownListener","middleMouseStart","mouseMoveListener","marginTop","mouseUpListener","removeEventListener","listener","ctrlKey","code","historyCanvas","area","handleUnfocus","firstTextFocus","setFirstTextFocus","textArea","focus","CanvasContainer","resize","border","outline","onMouseDown","onMouseUp","createGradient","grad","createLinearGradient","addColorStop","setLineDash","normY","positions","forEach","TextColorPicker","defaultColor","setColor","displayColorPicker","setDisplayColorPicker","handleChange","result","alpha","rgb","newColor","zIndex","bottom","left","transform","disableAlpha","onChangeComplete","oninput","UPDATE_FILL_COLOR","UPDATE_STROKE_COLOR","UPDATE_STROKE_WIDTH","UPDATE_TEXT_COLOR","UPDATE_TEXT_SIZE","UPDATE_FONT_NAME","UPDATE_TEXT_PADDING","ObjectParams","Filter","ParamsList","updateFillColor","FilterIcon","filtersContainer","minHeight","display","textAlign","verticalAlign","fontWeight","paper","menuList","marginRight","FilterMenu","anchorRef","event","contains","prevOpen","edge","ClickAwayListener","onClickAway","MenuList","autoFocusItem","onKeyDown","key","preventDefault","onSelect","Grey","Red","Green","Blue","Brightness","Blur","applyFilter","filter","applyColorLevelFilter","dst","i","j","dataIndex","mean","k","applyGreyFilter","px","tmpPx","applyBlurFilter","colorLevels","fab","slider","BrightnessSlider","onApply","setValue","BrightnessSliderContainer","BrightnessSliderCenter","Slider","step","valueLabelDisplay","newValue","Fab","useTimeout","isTimerStarted","setTimerStarted","ms","setTimeout","PasteArtDialog","onSaveSize","onChangeSize","UNDO_HISTORY","undoHistory","REDO_HISTORY","redoHistory","EDIT_CANVAS_SIZE","editCanvasSize","APPLY_FILTER","CREATE_NEW_CANVAS","createNewCanvas","quality_label","radioGroup","flexDirection","radio","ExportDialog","setFormat","quality","setQuality","FormControl","FormLabel","RadioGroup","aria-orientation","name","FormControlLabel","control","Radio","ImportType","ImportDialog","handleClickOpenWithAction","STORAGE","ListItemIcon","ListItemText","primary","PEXELS","WEB_CAMERA","searchContainer","searchButtonWrapper","photoLineContainer","searchResultsWrapper","error","photo","progressBar","client","createClient","handleQuery","onQueryResult","onError","photos","PexelsSearchDialog","isRateLimitExceeded","setRateLimitExceeded","isErrorShown","setErrorShown","page","setPage","queryText","setQueryText","loadedPhotos","setLoadedPhotos","isLoading","setLoading","timeout","handleSearch","curated","query","per_page","locale","then","search","concat","handleNewSearch","handleImageClick","alreadyScrolled","setArleadyScrolled","maxWidth","div","currentTarget","offsetHeight","scrollTop","scrollHeight","htmlColor","Alert","severity","index","getHorizontalPosition","medium","alt","photographer","CircularProgress","visibility","startBlockIndex","photo1","photo2","photo3","sortedIndices","newIndex","PexelsSelectSizeDialog","setSize","original","handleClick","toString","newSize","disabled","LinearProgressWithLabel","Box","alignItems","mr","LinearProgress","ProgressDialog","progress","WebCameraDialog","video","setVideo","streaming","setStreaming","setPhoto","handleSnapshot","videoWidth","videoHeight","htmlCanvas","takeSnapshot","handleVideoLoaded","navigator","mediaDevices","getUserMedia","audio","stream","srcObject","play","catch","err","openWebCamera","handleResult","mediaContainer","autoPlay","createMuiTheme","main","purple","cyan","red","flexGrow","menuButton","App","isBrightSliderShown","setBrightSliderShown","tempEditor","setTempEditor","isPasteArtDialogOpen","setPasteArtDialogOpen","isPexelsArtDialogOpen","setPexelsArtDialogOpen","pasteArt","setPasteArt","pexelsPhoto","setPexelsPhoto","pexelsPhotoProgress","setPexelsPhotoProgress","isWebCameraDialogOpen","setWebCameraDialogOpen","ThemeProvider","AppBar","Toolbar","input","click","onchange","inputElement","files","file","importObject","formatString","toBlob","link","href","setAttribute","exportObject","isPushToHistory","dstCanvas","dstCtx","scaleImageData","percentage","temp","brightEditor","brightnessFactor","applyBrightnessFilter","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","defaultEditor","newCanvas","initialViewModel","imageHistory","history","currentHistoryPosition","innerWidth","innerHeight","newHistory","flatMap","pop","push","updateObjectState","reducers","newImageHistory","selectedArea","dstY","srcY","dstIndex","srcIndex","sizeCreate","sizeEdit","canvasDataIndex","store","createStore","render","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.6ba85898.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"CanvasContainer\":\"Canvas_CanvasContainer__3wJou\",\"Canvas\":\"Canvas_Canvas__2Yiih\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ToolsRoot\":\"Tools_ToolsRoot__lQFre\",\"ToolsList\":\"Tools_ToolsList__1jkVW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"BrightnessSliderContainer\":\"BrightnessSlider_BrightnessSliderContainer__22-BP\",\"BrightnessSliderCenter\":\"BrightnessSlider_BrightnessSliderCenter__15i_G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mediaContainer\":\"WebCameraDialog_mediaContainer__ns1fy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"App\":\"App_App__3B_72\",\"AppBar\":\"App_AppBar__2yUSo\"};","\r\nimport React from \"react\";\r\nimport { createStyles, IconButton, Theme, Typography, WithStyles, withStyles } from \"@material-ui/core\";\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nconst titleStyles = (theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            margin: 0,\r\n            padding: theme.spacing(2)\r\n        },\r\n        closeButton: {\r\n            position: 'absolute',\r\n            right: theme.spacing(1),\r\n            top: theme.spacing(1),\r\n            color: \"#FFFFFF8a\",\r\n            borderRadius: \"50%\",\r\n            backgroundColor: \"#cfcfcf21\",\r\n            boxShadow: \"4px 4px 16px #55555521, -4px -4px 16px #ffffff21\"\r\n        },\r\n        title: {\r\n            userSelect: \"none\",\r\n            msUserSelect: \"none\",\r\n            fontFamily: \"cursive\",\r\n            color: \"#FFFFFFd0\",\r\n            marginLeft: theme.spacing(2)\r\n        }\r\n    });\r\n\r\nexport interface DialogTitleProps extends WithStyles<typeof titleStyles> {\r\n    id: string;\r\n    children: React.ReactNode;\r\n    onClose: () => void;\r\n}\r\n\r\nconst DialogTitle = withStyles(titleStyles)((props: DialogTitleProps) => {\r\n    const { children, classes, onClose, ...other } = props;\r\n    return (\r\n        <MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n            <Typography className={classes.title} variant=\"h6\">{children}</Typography>\r\n            {onClose ? (\r\n                <IconButton type=\"submit\" aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n                    <CloseIcon />\r\n                </IconButton>\r\n            ) : null}\r\n        </MuiDialogTitle>\r\n    );\r\n});\r\n\r\nexport default DialogTitle;\r\n","import React from \"react\";\r\nimport { Slide, Theme, withStyles } from \"@material-ui/core\";\r\nimport MuiDialog from '@material-ui/core/Dialog';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport { TransitionProps } from \"@material-ui/core/transitions/transition\";\r\nimport { CSSProperties } from \"@material-ui/core/styles/withStyles\";\r\nimport DialogTitle from \"./DialogTitle\";\r\n\r\nconst Transition = React.forwardRef(function Transition(\r\n    props: TransitionProps & { children?: React.ReactElement<any, any> },\r\n    ref: React.Ref<unknown>,\r\n) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nconst DialogContent = withStyles((theme: Theme) => ({\r\n    root: {\r\n        padding: theme.spacing(2),\r\n    },\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles((theme: Theme) => ({\r\n    root: {\r\n        margin: 0,\r\n        padding: theme.spacing(1),\r\n    },\r\n}))(MuiDialogActions);\r\n\r\nconst Dialog = withStyles((theme: Theme) => ({\r\n    root: {\r\n        \"& .MuiDialog-paper\": {\r\n            background: \"#cfcfcf33\",\r\n            boxShadow: \"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )\",\r\n            backdropFilter: \"blur(10.0px)\",\r\n            WebkitBackdropFilter: \"blur( 10.0px )\",\r\n            borderRadius: \"32px\",\r\n            borderTop: \"1px solid rgba( 255, 255, 255, 0.18 )\",\r\n            borderLeft: \"1px solid rgba( 255, 255, 255, 0.18 )\"\r\n        },\r\n        '& label': {\r\n            color: \"#FFFFFF8a\"\r\n        },\r\n        '& label.Mui-focused': {\r\n            color: \"#62ebff\"\r\n        },\r\n        '& .MuiInputBase-root': {\r\n            color: \"white\"\r\n        },\r\n        '& .MuiOutlinedInput-root': {\r\n            backgroundColor: \"#cfcfcf21\",\r\n            boxShadow: \"4px 4px 16px #55555521, -4px -4px 16px #ffffff21\",\r\n            '& fieldset': {\r\n                borderColor: \"transparent\"\r\n            },\r\n            '&:hover fieldset': {\r\n                borderColor: \"transparent\",\r\n            },\r\n            '&.Mui-focused fieldset': {\r\n                borderColor: \"#62ebff42\"\r\n            }\r\n        }\r\n    },\r\n}))(MuiDialog);\r\n\r\ninterface ReactiveDialogProps {\r\n    isOpen: boolean,\r\n    children: React.ReactNode,\r\n    actions?: () => JSX.Element,\r\n    paperStyle?: CSSProperties,\r\n    contentStyle?: CSSProperties,\r\n    title: string,\r\n    onScroll?: (e: React.UIEvent<HTMLDivElement, UIEvent>) => void,\r\n    onClose: () => void\r\n}\r\n\r\nfunction ReactiveDialog(props: ReactiveDialogProps) {\r\n    const close = () => {\r\n        props.onClose();\r\n    }\r\n    return (\r\n        <Dialog\r\n            PaperProps={{\r\n                style: {\r\n                    ...props.paperStyle,\r\n                }\r\n            }}\r\n            TransitionComponent={Transition}\r\n            onClose={() => close()}\r\n            aria-labelledby=\"customized-dialog-title\"\r\n            open={props.isOpen}>\r\n            <DialogTitle id=\"customized-dialog-title\"\r\n                onClose={() => close()}>\r\n                {props.title}\r\n            </DialogTitle>\r\n            <DialogContent dividers\r\n                onScroll={props.onScroll}\r\n                style={props.contentStyle}>\r\n                {props.children}\r\n            </DialogContent>\r\n            {props.actions !== undefined && <DialogActions>\r\n                {props.actions !== undefined && props.actions()}\r\n            </DialogActions>}\r\n        </Dialog>\r\n    );\r\n}\r\n\r\nexport default ReactiveDialog;\r\n","export enum Types {\n    Art, Rectangle, Triangle, Circle, TextObject, Area\n}\n","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        root: {\r\n            userSelect: \"none\",\r\n            '& .MuiOutlinedInput-root': {\r\n                borderRadius: \"24px\",\r\n            }\r\n        }\r\n    }));\r\n\r\nexport default useStyles;","import React, { ChangeEvent } from \"react\";\r\nimport { TextField } from \"@material-ui/core\";\r\nimport useStyles from \"./ReactiveTextFieldStyle\";\r\n\r\nexport interface ReactiveTextFieldProps {\r\n    id?: string;\r\n    className?: string;\r\n    label: string;\r\n    text?: string;\r\n    defaultText?: string;\r\n    min?: string;\r\n    autocomplete?: string;\r\n    type: string,\r\n    onChange(e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>): void;\r\n    onClick?: Function;\r\n}\r\n\r\nconst ReactiveTextField = (props: ReactiveTextFieldProps) => {\r\n    const classes = useStyles();\r\n    return (\r\n        <TextField\r\n            classes={{ root: `${classes.root} ${props.className}` }}\r\n            label={props.label}\r\n            id={props.id === undefined ? \"outlined-textfield\" : props.id}\r\n            variant=\"outlined\"\r\n            autoComplete={props.autocomplete}\r\n            InputProps={{\r\n                inputProps: { min: props.min }\r\n            }}\r\n            type={props.type}\r\n            value={props.text}\r\n            defaultValue={props.defaultText}\r\n            onFocus={() => {\r\n                if (props.onClick !== undefined) {\r\n                    props.onClick();\r\n                }\r\n            }}\r\n            onClick={() => {\r\n                if (props.onClick !== undefined) {\r\n                    props.onClick();\r\n                }\r\n            }}\r\n            onChange={(e) => props.onChange(e)} />\r\n    );\r\n};\r\n\r\n\r\nexport default ReactiveTextField;\r\n","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        searchField: {\r\n            margin: \"0 8px\"\r\n        },\r\n    }));\r\n\r\nexport default useStyles;","import React, { useState } from 'react';\nimport { Vector2 } from '../../structures/Vector2';\nimport { Button, IconButton } from '@material-ui/core';\nimport { useDispatch } from 'react-redux';\nimport Vector2Action from '../../store/actions/types/Vector2Action';\nimport ReactiveDialog from '../reactivedialog/ReactiveDialog';\nimport ReactiveTextField from '../reactivetextfield/ReactiveTextField';\nimport useStyles from './SelectSizeDialogStyle';\n\ninterface SelectSizeDialogProps {\n    applyText: string,\n    action: Vector2Action,\n    children: JSX.Element\n}\n\nexport default function SelectSizeDialog(props: SelectSizeDialogProps) {\n    const classes = useStyles();\n    const dispatch = useDispatch();\n    const [open, setOpen] = useState(false);\n    const [canApply, setCanApply] = useState(true);\n    const [size] = useState<Vector2>({ x: 800, y: 600 });\n\n    const handleClickOpen = () => {\n        setOpen(true);\n    };\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    const handleCloseAndCreate = () => {\n        if (!canApply) {\n            return;\n        }\n        handleClose();\n        props.action.value = size;\n        dispatch(props.action);\n    };\n\n    return (\n        <div>\n            <IconButton\n                color=\"inherit\"\n                onClick={handleClickOpen}>\n                {props.children}\n            </IconButton>\n            <ReactiveDialog\n                isOpen={open}\n                title=\"Выберите размер\"\n                onClose={() => handleClose()}\n                actions={() => {\n                    return (\n                        <Button autoFocus onClick={handleCloseAndCreate} color=\"secondary\">\n                            {props.applyText}\n                        </Button>\n                    )\n                }}>\n\n                <ReactiveTextField\n                    className={classes.searchField}\n                    defaultText={size.x + \"\"}\n                    type=\"number\"\n                    label=\"Ширина\"\n                    min=\"0\"\n                    onChange={(e) => {\n                        setCanApply(e.target.value !== \"\");\n                        size.x = Math.abs(parseInt(e.target.value))\n                    }} />\n\n                <ReactiveTextField\n                    defaultText={size.y + \"\"}\n                    type=\"number\"\n                    label=\"Высота\"\n                    min=\"0\"\n                    onChange={(e) => {\n                        setCanApply(e.target.value !== \"\");\n                        size.y = Math.abs(parseInt(e.target.value))\n                    }} />\n            </ReactiveDialog>\n        </div >\n    );\n}\n","import { RGBAColor } from \"../structures/RGBAColor\"\r\n\r\nexport function toRGBAColor(hex: string): RGBAColor {\r\n    const color = {\r\n        r: parseInt(hex.substr(1, 2), 16),\r\n        g: parseInt(hex.substr(3, 2), 16),\r\n        b: parseInt(hex.substr(5, 2), 16),\r\n        a: parseInt(hex.substr(7, 2), 16) / 255,\r\n    };\r\n    return color;\r\n}\r\n\r\nexport function toHexColor(color: RGBAColor): string {\r\n    return getRGB(color)\r\n        + to2dHex(Math.floor(color.a * 255))\r\n}\r\n\r\nfunction to2dHex(num: number): string {\r\n    return getAnalog(Math.floor(num / 16)) + getAnalog(num % 16);\r\n}\r\n\r\nconst hex = [\r\n    '0', '1', '2', '3',\r\n    '4', '5', '6', '7',\r\n    '8', '9', 'A', 'B',\r\n    'C', 'D', 'E', 'F']\r\nfunction getAnalog(num: number) {\r\n    return hex[num];\r\n}\r\n\r\nexport function getRGB(color: RGBAColor): string {\r\n    return '#' + to2dHex(color.r)\r\n        + to2dHex(color.g)\r\n        + to2dHex(color.b)\r\n}\r\n","import { Art } from \"../structures/Art\";\r\nimport { Circle } from \"../structures/Circle\";\r\nimport { Rectangle } from \"../structures/Rectangle\";\r\nimport { TextObject } from \"../structures/TextObject\";\r\nimport { Triangle } from \"../structures/Triangle\";\r\nimport { Types } from \"../structures/Type\";\r\nimport { Vector2 } from \"../structures/Vector2\";\r\nimport { getRGB } from \"./ColorHelper\";\r\nimport canvasTxt from 'canvas-txt';\r\n\r\nexport function drawImageData(\r\n    context: CanvasRenderingContext2D,\r\n    imageData: ImageData) {\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = imageData.width;\r\n    canvas.height = imageData.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (ctx === null) {\r\n        throw new Error();\r\n    }\r\n    ctx.putImageData(imageData, 0, 0);\r\n    context.drawImage(canvas, 0, 0);\r\n    canvas.remove();\r\n}\r\n\r\nexport function drawObject(\r\n    context: CanvasRenderingContext2D,\r\n    size: Vector2,\r\n    selectedObject: TextObject | Rectangle | Triangle | Circle | Art\r\n) {\r\n    let newImageData: ImageData | undefined;\r\n    const canvasSize = {\r\n        x: size.x,\r\n        y: size.y\r\n    }\r\n    switch (selectedObject.type) {\r\n        case Types.Rectangle:\r\n            newImageData = drawRectangle(context, canvasSize, selectedObject as Rectangle);\r\n            break;\r\n        case Types.Triangle:\r\n            newImageData = drawTriangle(context, canvasSize, selectedObject as Triangle);\r\n            break;\r\n        case Types.Circle:\r\n            newImageData = drawCircle(context, canvasSize, selectedObject as Circle);\r\n            break;\r\n        case Types.Art:\r\n            newImageData = drawArt(context, canvasSize, selectedObject as Art);\r\n            break;\r\n        case Types.TextObject:\r\n            newImageData = drawText(context, canvasSize, selectedObject as TextObject);\r\n            break;\r\n    };\r\n    context.globalAlpha = 1;\r\n    if (newImageData === undefined) {\r\n        throw new Error();\r\n    }\r\n    return newImageData;\r\n}\r\n\r\nfunction drawRectangle(ctx: CanvasRenderingContext2D,\r\n    canvasSize: Vector2,\r\n    rectangle: Rectangle\r\n): ImageData | undefined {\r\n    ctx.beginPath();\r\n    ctx.moveTo(rectangle.position.x, rectangle.position.y);\r\n    ctx.lineTo(rectangle.position.x + rectangle.size.x, rectangle.position.y);\r\n    ctx.lineTo(rectangle.position.x + rectangle.size.x, rectangle.position.y + rectangle.size.y);\r\n    ctx.lineTo(rectangle.position.x, rectangle.position.y + rectangle.size.y);\r\n    ctx.closePath();\r\n\r\n    ctx.globalAlpha = rectangle.props.fillColor.a;\r\n    ctx.fillStyle = getRGB(rectangle.props.fillColor);\r\n    ctx.fill();\r\n\r\n    if (rectangle.props.strokeWidth > 0) {\r\n        const strokeWidth = rectangle.props.strokeWidth / 2;\r\n        ctx.lineWidth = rectangle.props.strokeWidth;\r\n        ctx.globalAlpha = rectangle.props.strokeColor.a;\r\n        ctx.strokeStyle = getRGB(rectangle.props.strokeColor);\r\n        ctx.beginPath();\r\n        ctx.moveTo(rectangle.position.x - strokeWidth, rectangle.position.y - strokeWidth);\r\n        ctx.lineTo(rectangle.position.x + rectangle.size.x + strokeWidth, rectangle.position.y - strokeWidth);\r\n        ctx.lineTo(rectangle.position.x + rectangle.size.x + strokeWidth, rectangle.position.y + rectangle.size.y + strokeWidth);\r\n        ctx.lineTo(rectangle.position.x - strokeWidth, rectangle.position.y + rectangle.size.y + strokeWidth);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n    return ctx.getImageData(0, 0, canvasSize.x, canvasSize.y);\r\n}\r\n\r\nfunction drawTriangle(ctx: CanvasRenderingContext2D,\r\n    size: Vector2,\r\n    triangle: Triangle\r\n): ImageData | undefined {\r\n    ctx.beginPath();\r\n    ctx.moveTo(triangle.p0.x, triangle.p0.y);\r\n    ctx.lineTo(triangle.p1.x, triangle.p1.y);\r\n    ctx.lineTo(triangle.p2.x, triangle.p2.y);\r\n    ctx.closePath();\r\n\r\n    ctx.globalAlpha = triangle.props.fillColor.a;\r\n    ctx.fillStyle = getRGB(triangle.props.fillColor);\r\n    ctx.fill();\r\n\r\n    if (triangle.props.strokeWidth > 0) {\r\n        ctx.lineWidth = triangle.props.strokeWidth;\r\n        ctx.globalAlpha = triangle.props.strokeColor.a;\r\n        ctx.strokeStyle = getRGB(triangle.props.strokeColor);\r\n        ctx.stroke();\r\n    }\r\n    return ctx.getImageData(0, 0, size.x, size.y);\r\n}\r\n\r\nfunction drawCircle(ctx: CanvasRenderingContext2D,\r\n    size: Vector2,\r\n    circle: Circle\r\n): ImageData | undefined {\r\n    ctx.beginPath();\r\n    ctx.arc(circle.position.x, circle.position.y, circle.radius, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n\r\n    ctx.globalAlpha = circle.props.fillColor.a;\r\n    ctx.fillStyle = getRGB(circle.props.fillColor);\r\n    ctx.fill();\r\n\r\n    if (circle.props.strokeWidth > 0) {\r\n        const strokeWidth = circle.props.strokeWidth;\r\n        ctx.lineWidth = strokeWidth;\r\n        ctx.globalAlpha = circle.props.strokeColor.a;\r\n        ctx.strokeStyle = getRGB(circle.props.strokeColor);\r\n\r\n        ctx.beginPath();\r\n        ctx.arc(circle.position.x, circle.position.y, circle.radius + strokeWidth / 2, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n\r\n        ctx.stroke();\r\n    }\r\n    return ctx.getImageData(0, 0, size.x, size.y);\r\n}\r\n\r\nfunction drawArt(ctx: CanvasRenderingContext2D,\r\n    size: Vector2, art: Art) {\r\n    const canvasCtx = document.createElement(\"canvas\");\r\n    canvasCtx.width = art.image.width;\r\n    canvasCtx.height = art.image.height;\r\n    const imageCtx = canvasCtx.getContext(\"2d\");\r\n    if (imageCtx === null) {\r\n        throw new Error();\r\n    }\r\n    imageCtx.putImageData(art.image, 0, 0);\r\n    const canvasScaled = document.createElement(\"canvas\");\r\n    canvasScaled.width = Math.max(1, art.size.x);\r\n    canvasScaled.height = Math.max(1, art.size.y);\r\n    const imageScaled = canvasScaled.getContext(\"2d\");\r\n    if (imageScaled === null) {\r\n        throw new Error();\r\n    }\r\n    imageScaled.scale(art.size.x / art.image.width, art.size.y / art.image.height);\r\n    imageScaled.drawImage(canvasCtx, 0, 0);\r\n    ctx.drawImage(canvasScaled, art.position.x, art.position.y);\r\n    return ctx.getImageData(0, 0, size.x, size.y);\r\n}\r\n\r\nfunction drawText(ctx: CanvasRenderingContext2D,\r\n    size: Vector2,\r\n    text: TextObject) {\r\n    drawRectangle(ctx, size, text.rectangle);\r\n    ctx.globalAlpha = text.textColor.a;\r\n    ctx.fillStyle = getRGB(text.textColor);\r\n\r\n    const padding = text.padding;\r\n    canvasTxt.fontSize = text.textSize;\r\n    canvasTxt.font = text.fontName;\r\n    canvasTxt.align = \"left\";\r\n    canvasTxt.vAlign = \"top\";\r\n    canvasTxt.lineHeight = text.textSize * 1.25;\r\n    canvasTxt.drawText(ctx, text.text,\r\n        text.rectangle.position.x + padding,\r\n        text.rectangle.position.y + padding,\r\n        text.rectangle.size.x - padding * 2,\r\n        text.rectangle.size.y - padding * 2);\r\n\r\n    return ctx.getImageData(0, 0, size.x, size.y);\r\n}\r\n","import { Vector2 } from '../structures/Vector2';\r\nimport { Rectangle } from '../structures/Rectangle';\r\nimport { Triangle } from '../structures/Triangle';\r\nimport { Circle } from '../structures/Circle';\r\nimport { SelectedArea } from '../structures/SelectedArea';\r\nimport { Types } from '../structures/Type';\r\nimport { TextObject } from '../structures/TextObject';\r\nimport { ObjectState } from '../viewmodel/ObjectState';\r\n\r\nexport function createRectangle(downStart: Vector2, moveEnd: Vector2, objectState: ObjectState): Rectangle {\r\n    const start: Vector2 = {\r\n        x: Math.min(downStart.x, moveEnd.x),\r\n        y: Math.min(downStart.y, moveEnd.y)\r\n    };\r\n    const end = {\r\n        x: Math.max(downStart.x, moveEnd.x),\r\n        y: Math.max(downStart.y, moveEnd.y)\r\n    };\r\n    return {\r\n        type: Types.Rectangle,\r\n        position: {\r\n            x: Math.round(start.x),\r\n            y: Math.round(start.y)\r\n        },\r\n        size: {\r\n            x: Math.round(end.x - start.x),\r\n            y: Math.round(end.y - start.y)\r\n        },\r\n        rotation: 0,\r\n        props: {\r\n            fillColor: objectState.fillColor,\r\n            strokeColor: objectState.strokeColor,\r\n            strokeWidth: objectState.strokeWidth\r\n        }\r\n    }\r\n}\r\n\r\nexport function createTriangle(downStart: Vector2, moveEnd: Vector2, objectState: ObjectState): Triangle {\r\n    const start: Vector2 = {\r\n        x: Math.min(downStart.x, moveEnd.x),\r\n        y: downStart.y\r\n    };\r\n    const end = {\r\n        x: Math.max(downStart.x, moveEnd.x),\r\n        y: moveEnd.y\r\n    };\r\n    return {\r\n        type: Types.Triangle,\r\n        p0: {\r\n            x: start.x,\r\n            y: start.y,\r\n        },\r\n        p1: {\r\n            x: end.x,\r\n            y: start.y,\r\n        },\r\n        p2: {\r\n            x: start.x / 2 + end.x / 2,\r\n            y: end.y,\r\n        },\r\n        props: {\r\n            fillColor: objectState.fillColor,\r\n            strokeColor: objectState.strokeColor,\r\n            strokeWidth: objectState.strokeWidth\r\n        }\r\n    }\r\n}\r\n\r\nexport function createCircle(downStart: Vector2, moveEnd: Vector2, objectState: ObjectState): Circle {\r\n    const len = Math.sqrt(Math.pow(moveEnd.x - downStart.x, 2) + Math.pow(moveEnd.y - downStart.y, 2));\r\n    return {\r\n        type: Types.Circle,\r\n        position: {\r\n            x: downStart.x,\r\n            y: downStart.y\r\n        },\r\n        radius: len,\r\n        props: {\r\n            fillColor: objectState.fillColor,\r\n            strokeColor: objectState.strokeColor,\r\n            strokeWidth: objectState.strokeWidth\r\n        }\r\n    }\r\n}\r\n\r\nexport function createText(downStart: Vector2, moveEnd: Vector2, objectState: ObjectState): TextObject {\r\n    return {\r\n        type: Types.TextObject,\r\n        rectangle: createRectangle(downStart, moveEnd, objectState),\r\n        text: objectState.text,\r\n        textSize: objectState.textSize,\r\n        textColor: objectState.textColor,\r\n        fontName: objectState.fontName,\r\n        padding: objectState.padding\r\n    }\r\n}\r\n\r\nexport function createArea(downStart: Vector2, moveEnd: Vector2, objectState: ObjectState): SelectedArea {\r\n    const start: Vector2 = {\r\n        x: Math.min(downStart.x, moveEnd.x),\r\n        y: Math.min(downStart.y, moveEnd.y)\r\n    };\r\n    const end = {\r\n        x: Math.max(downStart.x, moveEnd.x),\r\n        y: Math.max(downStart.y, moveEnd.y)\r\n    };\r\n    return {\r\n        type: Types.Area,\r\n        position: {\r\n            x: Math.round(start.x),\r\n            y: Math.round(start.y),\r\n        },\r\n        size: {\r\n            x: Math.round(end.x - start.x),\r\n            y: Math.round(end.y - start.y)\r\n        },\r\n    }\r\n}","const REMOVE_SELECTED_OBJECT = \"REMOVE_SELECTED_OBJECT\";\r\nexport default REMOVE_SELECTED_OBJECT;\r\n","import { Action } from \"redux\";\r\nimport REMOVE_SELECTED_OBJECT from \"../actions/removeSelectedObject\";\r\n\r\nexport default function removeSelectedObject(): Action {\r\n    return {\r\n        type: REMOVE_SELECTED_OBJECT\r\n    };\r\n}","const SELECT_AREA = \"SELECT_AREA\";\r\nexport default SELECT_AREA;\r\n","import { SelectedArea } from \"../../structures/SelectedArea\";\r\nimport SELECT_AREA from \"../actions/selectArea\";\r\nimport SelectedAreaAction from \"../actions/types/SelectedAreaAction\";\r\n\r\nfunction selectArea(value: SelectedArea): SelectedAreaAction {\r\n    return {\r\n        type: SELECT_AREA,\r\n        value: value\r\n    };\r\n}\r\n\r\nexport default selectArea;","const CUT_SELECTED_AREA = \"CUT_SELECTED_AREA\";\r\nexport default CUT_SELECTED_AREA;\r\n","import { Action } from \"redux\";\r\nimport CUT_SELECTED_AREA from \"../actions/cutSelectedArea\";\r\n\r\nfunction cutSelectedArea(): Action {\r\n    return {\r\n        type: CUT_SELECTED_AREA,\r\n    };\r\n}\r\n\r\nexport default cutSelectedArea;","const PUSH_TO_HISTORY = \"PUSH_TO_HISTORY\";\r\nexport default PUSH_TO_HISTORY;","import PUSH_TO_HISTORY from \"../actions/pushToHistory\";\r\nimport ImageDataAction from \"../actions/types/ImageDataAction\";\r\n\r\nfunction pushToHistory(imageData: ImageData): ImageDataAction {\r\n    return {\r\n        type: PUSH_TO_HISTORY,\r\n        value: imageData\r\n    };\r\n}\r\n\r\nexport default pushToHistory;","const REPLACE_SELECTED_OBJECT = \"REPLACE_SELECTED_OBJECT\";\r\nexport default REPLACE_SELECTED_OBJECT;\r\n","import { Art } from \"../../structures/Art\";\r\nimport { Circle } from \"../../structures/Circle\";\r\nimport { Rectangle } from \"../../structures/Rectangle\";\r\nimport { TextObject } from \"../../structures/TextObject\";\r\nimport { Triangle } from \"../../structures/Triangle\";\r\nimport REPLACE_SELECTED_OBJECT from \"../actions/actionReplaceSelectedObject\";\r\nimport SelectedObjectAction from \"../actions/types/SelectedObjectAction\";\r\n\r\nfunction actionReplaceSelectedObject(obj: TextObject | Rectangle | Triangle | Circle | Art | null): SelectedObjectAction {\r\n    return {\r\n        type: REPLACE_SELECTED_OBJECT,\r\n        value: obj\r\n    };\r\n}\r\n\r\nexport default actionReplaceSelectedObject;\r\n","const SET_EDITOR = \"SET_EDITOR\";\r\nexport default SET_EDITOR;\r\n","import { Editor } from \"../../structures/Editor\";\r\nimport SET_EDITOR from \"../actions/setEditor\";\r\nimport EditorAction from \"../actions/types/EditorAction\";\r\n\r\nfunction setEditor(value: Editor): EditorAction {\r\n    return {\r\n        type: SET_EDITOR,\r\n        value: value\r\n    };\r\n}\r\n\r\nexport default setEditor;","export enum ExportFormat {\r\n    JPEG, PNG\r\n}\r\n\r\nexport function formatToString(format: ExportFormat): string {\r\n    switch (format) {\r\n        case ExportFormat.JPEG:\r\n            return \"jpeg\";\r\n        case ExportFormat.PNG:\r\n            return \"png\";\r\n        default:\r\n            return \"unknown\";\r\n    }\r\n}\r\n","import { Art } from '../structures/Art';\nimport { Editor } from '../structures/Editor'\nimport { ExportFormat, formatToString } from '../structures/ExportFormat';\nimport { SelectedArea } from '../structures/SelectedArea';\nimport { Types } from '../structures/Type';\nimport { Vector2 } from '../structures/Vector2'\n\nexport function scaleImageData(imageData: ImageData, newSize: Vector2) {\n\tconst canvas = document.createElement(\"canvas\");\n\tcanvas.width = imageData.width;\n\tcanvas.height = imageData.height;\n\tconst ctx = canvas.getContext(\"2d\");\n\tif (ctx === null) {\n\t\tthrow new Error();\n\t}\n\tctx.putImageData(imageData, 0, 0);\n\tconst dstCanvas = document.createElement(\"canvas\");\n\tdstCanvas.width = newSize.x;\n\tdstCanvas.height = newSize.y;\n\tconst dstCtx = canvas.getContext(\"2d\");\n\tif (dstCtx === null) {\n\t\tthrow new Error();\n\t}\n\tdstCtx.scale(newSize.x / imageData.width, newSize.y / imageData.height)\n\tdstCtx.drawImage(canvas, 0, 0);\n\treturn dstCtx.getImageData(0, 0, newSize.x, newSize.y);\n}\n\nexport function copyImageData(imageData: ImageData) {\n\tconst newImageData: ImageData = new ImageData(\n\t\timageData.width,\n\t\timageData.height\n\t);\n\tnewImageData.data.set(new Uint8ClampedArray(imageData.data));\n\treturn newImageData;\n}\n\nexport function createNewCanvas(editor: Editor, size: Vector2): Editor {\n\tconst newCanvas = new ImageData(size.x, size.y);\n\tnewCanvas.data.fill(255);\n\tconst newEditor: Editor = {\n\t\t...editor,\n\t\tselectedObject: null,\n\t\tcanvas: newCanvas,\n\t};\n\treturn newEditor;\n}\n\nexport function editCanvasSize(editor: Editor, size: Vector2): Editor {\n\tconsole.log(size);\n\tlet imageData = new ImageData(size.x, size.y);\n\timageData.data.fill(255);\n\tlet minWidth = Math.min(size.x, editor.canvas.width);\n\tlet minHeight = Math.min(size.y, editor.canvas.height);\n\n\tfor (let i = 0; i < minHeight; i++) {\n\t\tfor (let j = 0; j < minWidth; j++) {\n\t\t\tlet dataIndex = (i * size.x + j) * 4;\n\t\t\tlet canvasDataIndex = (i * editor.canvas.width + j) * 4;\n\t\t\tfor (let k = 0; k < 4; k++) {\n\t\t\t\timageData.data[dataIndex + k] = editor.canvas.data[canvasDataIndex + k];\n\t\t\t}\n\t\t}\n\t}\n\tconst newEditor: Editor = {\n\t\t...editor,\n\t\tcanvas: imageData,\n\t};\n\treturn newEditor;\n}\n\nexport function cutSelectedArea(editor: Editor) {\n\tvar newCanvas = copyImageData((editor.selectedObject as Art).image);\n\tconst newEditor: Editor = {\n\t\tcanvas: newCanvas,\n\t\tselectedObject: null,\n\t};\n\treturn newEditor;\n}\n\nexport function selectArea(editor: Editor, selectedArea: SelectedArea): Editor {\n\tconsole.log(selectedArea)\n\tlet art: Art = {\n\t\ttype: Types.Art,\n\t\timage: new ImageData(selectedArea.size.x, selectedArea.size.y),\n\t\tposition: {\n\t\t\tx: Math.round(selectedArea.position.x),\n\t\t\ty: Math.round(selectedArea.position.y)\n\t\t},\n\t\tsize: {\n\t\t\tx: Math.round(selectedArea.size.x),\n\t\t\ty: Math.round(selectedArea.size.y)\n\t\t},\n\t\trotation: 0\n\t};\n\tconst newCanvas = copyImageData(editor.canvas);\n\tfor (let i = 0; i < art.size.y; i++) {\n\t\tconst dstY = i * art.size.x;\n\t\tconst srcY = (i + art.position.y) * newCanvas.width;\n\t\tfor (let j = 0; j < art.size.x; j++) {\n\t\t\tlet dstIndex = (dstY + j) * 4;\n\t\t\tlet srcIndex =\n\t\t\t\t(srcY + j + art.position.x) * 4;\n\t\t\tfor (let k = 0; k < 4; k++) {\n\t\t\t\tart.image.data[dstIndex + k] = newCanvas.data[srcIndex + k];\n\t\t\t}\n\t\t\tnewCanvas.data[srcIndex + 3] = 0;\n\t\t}\n\t}\n\tconst newEditor: Editor = {\n\t\t...editor,\n\t\tselectedObject: art,\n\t\tcanvas: newCanvas,\n\t};\n\treturn newEditor;\n}\n\nexport function importImageUrl(url: string, onResult: (art: Art) => void, onProgress?: (percentage: number) => void) {\n\tconst request = new XMLHttpRequest();\n\tif (onProgress !== undefined) {\n\t\trequest.onprogress = function (e) {\n\t\t\tonProgress((e.loaded / e.total) * 100);\n\t\t};\n\t}\n\trequest.onload = function () {\n\t\tconst img = new Image();\n\t\tvar blob = new Blob([this.response]);\n\t\timg.onload = () => {\n\t\t\tURL.revokeObjectURL(img.src);\n\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\tcanvas.width = img.clientWidth;\n\t\t\tcanvas.height = img.clientHeight;\n\t\t\tconst ctx = canvas.getContext(\"2d\");\n\t\t\tif (ctx !== null) {\n\t\t\t\tctx.drawImage(img, 0, 0);\n\t\t\t\tconst art: Art = {\n\t\t\t\t\ttype: Types.Art,\n\t\t\t\t\timage: ctx.getImageData(0, 0, img.width, img.height),\n\t\t\t\t\tposition: {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t},\n\t\t\t\t\tsize: {\n\t\t\t\t\t\tx: img.width,\n\t\t\t\t\t\ty: img.height\n\t\t\t\t\t},\n\t\t\t\t\trotation: 0,\n\t\t\t\t}\n\t\t\t\tonResult(art);\n\t\t\t}\n\t\t\tcanvas.remove();\n\t\t\timg.remove();\n\t\t}\n\t\timg.src = window.URL.createObjectURL(blob);\n\t\tdocument.body.appendChild(img);\n\t};\n\trequest.responseType = 'arraybuffer';\n\trequest.overrideMimeType('text/plain; charset=x-user-defined');\n\trequest.open('GET', url, true);\n\trequest.send();\n}\n\nexport function importObject(onResult: (art: Art) => void, onProgress?: (percentage: number) => void): void {\n\tif (document !== null) {\n\t\tconst input = document.createElement(\"input\") as HTMLInputElement;\n\t\tinput.type = \"file\";\n\t\tinput.click();\n\t\tif (input !== null) {\n\t\t\tinput.onchange = function (e: Event) {\n\t\t\t\tconst inputElement = e.target as HTMLInputElement;\n\t\t\t\tif (inputElement.files != null) {\n\t\t\t\t\tvar file = inputElement.files[0];\n\t\t\t\t\tconst url = URL.createObjectURL(file);\n\t\t\t\t\timportImageUrl(url, onResult, onProgress);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport function exportObject(imageData: ImageData, format: ExportFormat, quality: number) {\n\tconst formatString = formatToString(format);\n\tvar canvas = document.createElement(\"canvas\");\n\tcanvas.width = imageData.width;\n\tcanvas.height = imageData.height;\n\tif (canvas == null) {\n\t\treturn;\n\t}\n\tconst ctx = canvas.getContext(\"2d\");\n\tif (ctx == null) {\n\t\treturn;\n\t}\n\tctx.putImageData(imageData, 0, 0);\n\tcanvas.toBlob(\n\t\tfunction (blob) {\n\t\t\tif (blob == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst url = window.URL.createObjectURL(new Blob([blob]));\n\t\t\tconst link = document.createElement(\"a\");\n\t\t\tlink.href = url;\n\t\t\tlink.setAttribute(\"download\", `image.${formatString}`);\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\tlink.remove();\n\t\t\tcanvas.remove();\n\t\t},\n\t\t`image/${formatString}`,\n\t\tquality / 100\n\t);\n}\n","import pushToHistory from \"../store/actionCreators/pushToHistory\";\r\nimport setEditor from \"../store/actionCreators/setEditor\";\r\nimport { Art } from \"../structures/Art\";\r\nimport { Circle } from \"../structures/Circle\";\r\nimport { Editor } from \"../structures/Editor\";\r\nimport { Rectangle } from \"../structures/Rectangle\";\r\nimport { TextObject } from \"../structures/TextObject\";\r\nimport { Triangle } from \"../structures/Triangle\";\r\nimport { copyImageData } from \"./CanvasHelper\";\r\nimport { drawObject } from \"./DrawHelper\";\r\n\r\nexport function replaceSelectedObjectWithHistory(\r\n    dispatch: Function,\r\n    editor: Editor,\r\n    newSelectedObject: Rectangle | Triangle | Circle | TextObject | Art | null,\r\n    historyImage: ImageData | null = null) {\r\n        const newEditor = replaceSelectedObject(editor, newSelectedObject);\r\n        if (historyImage == null) {\r\n            dispatch(pushToHistory(newEditor.canvas));\r\n        } else {\r\n            dispatch(pushToHistory(historyImage));\r\n        }\r\n        dispatch(setEditor(newEditor));\r\n}\r\n\r\nexport function replaceSelectedObject(\r\n    editor: Editor,\r\n    newSelectedObject: Rectangle | Triangle | Circle | TextObject | Art | null\r\n) {\r\n    let newEditor: Editor = {\r\n        ...editor,\r\n        selectedObject: newSelectedObject,\r\n    };\r\n    if (editor.selectedObject != null) {\r\n        const canvas = document.createElement(\"canvas\");\r\n        canvas.width = editor.canvas.width;\r\n        canvas.height = editor.canvas.height;\r\n        if (canvas != null) {\r\n            const ctx = canvas.getContext(\"2d\");\r\n            if (ctx != null) {\r\n                ctx.putImageData(editor.canvas, 0, 0);\r\n                newEditor.canvas = drawObject(ctx, { x: editor.canvas.width, y: editor.canvas.height },\r\n                    editor.selectedObject);\r\n            }\r\n        }\r\n    }\r\n    return newEditor;\r\n}\r\n\r\nexport function removeSelectedObject(\r\n    editor: Editor) {\r\n    let newEditor: Editor = {\r\n        canvas: copyImageData(editor.canvas),\r\n        selectedObject: null\r\n    };\r\n    return newEditor;\r\n}\r\n","import { Vector2 } from \"../structures/Vector2\";\r\n\r\nexport function length(vector: Vector2) {\r\n    return Math.floor(Math.sqrt(Math.pow(vector.x, 2) + Math.pow(vector.y, 2)));\r\n}\r\n\r\nexport function cosinus(first: Vector2, second: Vector2) {\r\n    return (first.x * second.x + first.y * second.y) / (length(first) * length(second));\r\n}","const UPDATE_CANVAS_VIEW_MODEL = \"UPDATE_CANVAS_VIEW_MODEL\";\r\nexport default UPDATE_CANVAS_VIEW_MODEL;","import { CanvasViewModel } from \"../../viewmodel/CanvasViewModel\";\r\nimport CanvasViewModelAction from \"../actions/types/CanvasViewModelAction\";\r\nimport UPDATE_CANVAS_VIEW_MODEL from \"../actions/updateCanvasViewModel\";\r\n\r\nfunction updateCanvasViewModel(model: CanvasViewModel): CanvasViewModelAction {\r\n    return {\r\n        type: UPDATE_CANVAS_VIEW_MODEL,\r\n        value: model\r\n    };\r\n}\r\n\r\nexport default updateCanvasViewModel;","const UPDATE_TEXT = \"UPDATE_TEXT\";\r\nexport default UPDATE_TEXT;","import StringAction from \"../actions/types/StringAction\";\r\nimport UPDATE_TEXT from \"../actions/updateText\";\r\n\r\nexport default function updateText(value: string): StringAction {\r\n    return { \r\n        type: UPDATE_TEXT,\r\n        value: value\r\n    };\r\n}","const UPDATE_TOOL = \"UPDATE_TOOL\";\r\nexport default UPDATE_TOOL;","import { createStyles, List, ListItem, makeStyles, Paper, SvgIcon, Theme } from '@material-ui/core';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport updateTool from '../../store/actionCreators/updateTool';\nimport { ViewModel } from '../../viewmodel/ViewModel';\nimport styles from'./Tools.module.css';\n\nexport enum ToolType {\n    Rectangle = 0, Triangle = 1, Circle = 2, Text = 3, Area = 4\n}\n\ninterface ToolsProps {\n    onSelected(): void\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        root: {\n            position: \"fixed\",\n            margin: \"8px 0 0 8px\",\n            background: \"rgba(255, 255, 255, 0.20)\",\n            boxShadow: \"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )\",\n            backdropFilter: \"blur(10.0px)\",\n            WebkitBackdropFilter: \"blur( 10.0px )\",\n            borderRadius: \"32px\",\n            borderTop: \"1px solid rgba( 255, 255, 255, 0.18 )\",\n            borderLeft: \"1px solid rgba( 255, 255, 255, 0.18 )\"\n        },\n        item: {\n            minWidth: \"0\",\n            width: \"48px\",\n            height: \"48px\",\n            borderRadius: \"24px\",\n            alignContent: \"center\",\n            margin: \"0 4px\",\n            padding: \"0\",\n            '&:hover': {\n                background: \"#42424242\",\n            },\n        },\n        selectedItem: {\n            background: theme.palette.secondary.light + \"CC\",\n            '&:hover': {\n                background: theme.palette.secondary.light,\n            },\n        }\n    }),\n);\n\nexport default function Tools({ onSelected }: ToolsProps) {\n    const dispatch = useDispatch();\n    const currentTool: ToolType = useSelector(\n        (state: ViewModel) => state.currentTool\n    )\n    const onClick = (tool: ToolType) => {\n        if (tool !== currentTool) {\n            dispatch(updateTool(tool));\n            onSelected();\n        }\n    };\n    const classes = useStyles();\n    return (\n        <Paper className={styles.ToolsRoot + \" \" + classes.root}>\n            <List className={styles.ToolsList} component=\"nav\" aria-label=\"Инструменты\">\n                <ListItem button\n                    onClick={() => onClick(ToolType.Rectangle)}\n                    className={classes.item + \" \" + (currentTool === ToolType.Rectangle ? classes.selectedItem : \"\")}>\n                    <SvgIcon viewBox=\"0 0 32 32\" style={{ margin: \"auto\" }}>\n                        <rect x=\"0\" y=\"0\" width=\"32\" height=\"32\"\n                            fill={currentTool === ToolType.Rectangle ? \"#FFFFFF\" : \"#424242\"} />\n                    </SvgIcon>\n                </ListItem>\n                <ListItem button\n                    onClick={() => onClick(ToolType.Triangle)}\n                    className={classes.item + \" \" + (currentTool === ToolType.Triangle ? classes.selectedItem : \"\")}>\n                    <SvgIcon viewBox=\"0 0 32 32\" style={{ margin: \"auto\" }}>\n                        <polygon points=\"0,32 32,32 16,0\"\n                            fill={currentTool === ToolType.Triangle ? \"#FFFFFF\" : \"#424242\"} />\n                    </SvgIcon>\n                </ListItem>\n                <ListItem button\n                    onClick={() => onClick(ToolType.Circle)}\n                    className={classes.item + \" \" + (currentTool === ToolType.Circle ? classes.selectedItem : \"\")}>\n                    <SvgIcon viewBox=\"0 0 32 32\" style={{ margin: \"auto\" }}>\n                        <circle r=\"16\" cx=\"16\" cy=\"16\"\n                            fill={currentTool === ToolType.Circle ? \"#FFFFFF\" : \"#424242\"}\n                        />\n                    </SvgIcon>\n                </ListItem>\n                <ListItem button\n                    onClick={() => onClick(ToolType.Text)}\n                    className={classes.item + \" \" + (currentTool === ToolType.Text ? classes.selectedItem : \"\")}>\n                    <SvgIcon viewBox=\"0 0 24 24\" style={{ margin: \"auto\" }}>\n                        <path d=\"M5 4v3h5.5v12h3V7H19V4z\"\n                            fill={currentTool === ToolType.Text ? \"#FFFFFF\" : \"#424242\"} />\n                    </SvgIcon>\n                </ListItem>\n                <ListItem button\n                    onClick={() => onClick(ToolType.Area)}\n                    className={classes.item + \" \" + (currentTool === ToolType.Area ? classes.selectedItem : \"\")}>\n                    <SvgIcon viewBox=\"0 0 24 24\" style={{ margin: \"auto\" }}>\n                        <path d=\"M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z\"\n                            fill={currentTool === ToolType.Area ? \"#FFFFFF\" : \"#424242\"} />\n                    </SvgIcon>\n                </ListItem>\n            </List>\n        </Paper>\n    );\n}\n","import { ToolType } from \"../../components/tool/Tools\";\r\nimport ToolTypeAction from \"../actions/types/ToolTypeAction\";\r\nimport UPDATE_TOOL from \"../actions/updateTool\";\r\n\r\nexport default function updateTool(value: ToolType): ToolTypeAction {\r\n    return { \r\n        type: UPDATE_TOOL,\r\n        value: value\r\n    };\r\n}","import { replaceSelectedObjectWithHistory } from \"../../helper/EditorHelper\";\r\nimport { createArea, createCircle, createRectangle, createText, createTriangle } from \"../../helper/ObjectCreateHelper\";\r\nimport { cosinus, length } from \"../../helper/VectorHelper\";\r\nimport actionReplaceSelectedObject from \"../../store/actionCreators/actionReplaceSelectedObject\";\r\nimport pushToHistory from \"../../store/actionCreators/pushToHistory\";\r\nimport removeSelectedObject from \"../../store/actionCreators/removeSelectedObject\";\r\nimport selectArea from \"../../store/actionCreators/selectArea\";\r\nimport updateCanvasViewModel from \"../../store/actionCreators/updateCanvasViewModel\";\r\nimport updateText from \"../../store/actionCreators/updateText\";\r\nimport { Art } from \"../../structures/Art\";\r\nimport { Circle } from \"../../structures/Circle\";\r\nimport { Rectangle } from \"../../structures/Rectangle\";\r\nimport { SelectedArea } from \"../../structures/SelectedArea\";\r\nimport { TextObject } from \"../../structures/TextObject\";\r\nimport { Triangle } from \"../../structures/Triangle\";\r\nimport { Types } from \"../../structures/Type\";\r\nimport { Vector2 } from \"../../structures/Vector2\";\r\nimport { ViewModel } from \"../../viewmodel/ViewModel\";\r\nimport { ToolType } from \"../tool/Tools\";\r\n\r\nexport function onMouseDown(\r\n    e: React.MouseEvent<HTMLCanvasElement, MouseEvent>,\r\n    dispatch: Function,\r\n    canvas: HTMLCanvasElement,\r\n    viewModel: ViewModel): void {\r\n    if (e.button !== 0) {\r\n        return;\r\n    }\r\n    const editor = viewModel.editor;\r\n    const canvasViewModel = viewModel.canvasModel;\r\n    const newCanvasViewModel = {\r\n        ...canvasViewModel\r\n    }\r\n    if (canvasViewModel.isMiddleMouseDown) {\r\n        return;\r\n    }\r\n    const selectedObject = editor.selectedObject;\r\n    const tempObject = canvasViewModel.tempObject;\r\n    if (canvas.style.cursor === \"pointer\") {\r\n        if (selectedObject != null) {\r\n            newCanvasViewModel.tempObject = selectedObject;\r\n            const ctx = canvas.getContext(\"2d\");\r\n            if (ctx == null) {\r\n                throw new Error(\"CanvasHandler: context is null\");\r\n            }\r\n            if (selectedObject != null) {\r\n                dispatch(removeSelectedObject());\r\n            }\r\n            newCanvasViewModel.start = {\r\n                x: e.clientX - canvas.offsetLeft,\r\n                y: e.clientY - canvas.offsetTop\r\n            };\r\n        }\r\n    } else if (canvas.style.cursor === \"grab\") {\r\n        if (selectedObject != null || (tempObject !== null && tempObject.type === Types.Area)) {\r\n            canvas.style.cursor = \"grabbing\";\r\n\r\n            if (selectedObject !== null || tempObject === null || tempObject.type !== Types.Area) {\r\n                newCanvasViewModel.tempObject = selectedObject;\r\n            }\r\n            dispatch(removeSelectedObject());\r\n            newCanvasViewModel.start = {\r\n                x: e.clientX - canvas.offsetLeft,\r\n                y: e.clientY - canvas.offsetTop\r\n            };\r\n        }\r\n    } else {\r\n        if (selectedObject != null) {\r\n            if (selectedObject.type === Types.TextObject) {\r\n                const textObject = editor.selectedObject as TextObject;\r\n                textObject.fontName = viewModel.objectState.fontName;\r\n                textObject.padding = viewModel.objectState.padding;\r\n            }\r\n            replaceSelectedObjectWithHistory(dispatch, editor, null);\r\n        }\r\n        newCanvasViewModel.start = {\r\n            x: e.clientX - canvas.offsetLeft,\r\n            y: e.clientY - canvas.offsetTop\r\n        };\r\n    }\r\n    newCanvasViewModel.isCanvasDown = true;\r\n\r\n    dispatch(updateCanvasViewModel(newCanvasViewModel));\r\n}\r\n\r\nexport function onMouseMove(e: React.MouseEvent<HTMLCanvasElement, MouseEvent>,\r\n    dispatch: Function,\r\n    canvas: HTMLCanvasElement,\r\n    viewModel: ViewModel): void {\r\n\r\n    const canvasViewModel = viewModel.canvasModel;\r\n    const newCanvasViewModel = {\r\n        ...canvasViewModel\r\n    }\r\n\r\n    if (canvasViewModel.isMiddleMouseDown) {\r\n        return;\r\n    }\r\n    const moveEnd: Vector2 = {\r\n        x: e.clientX - canvas.offsetLeft,\r\n        y: e.clientY - canvas.offsetTop\r\n    };\r\n\r\n    const editor = viewModel.editor;\r\n    const selectedObject = editor.selectedObject;\r\n    const tempObject = canvasViewModel.tempObject;\r\n    const scale = canvasViewModel.scale;\r\n    if (canvasViewModel.isCanvasDown) {\r\n        const tempPoint = canvasViewModel.tempPoint;\r\n        const start = canvasViewModel.start;\r\n\r\n        const onCreateObject = (start: Vector2, moveEnd: Vector2) => {\r\n            if (canvasViewModel.isCanvasDown) {\r\n                let newObject = null;\r\n                const tool = viewModel.currentTool;\r\n                const objectState = viewModel.objectState;\r\n                switch (tool) {\r\n                    case ToolType.Rectangle:\r\n                        newObject = createRectangle(start, moveEnd, objectState);\r\n                        break;\r\n                    case ToolType.Triangle:\r\n                        newObject = createTriangle(start, moveEnd, objectState);\r\n                        break;\r\n                    case ToolType.Circle:\r\n                        newObject = createCircle(start, moveEnd, objectState);\r\n                        break;\r\n                    case ToolType.Text:\r\n                        newObject = createText(start, moveEnd, objectState);\r\n                        break;\r\n                    case ToolType.Area:\r\n                        newObject = createArea(start, moveEnd, objectState);\r\n                        break;\r\n                }\r\n                newCanvasViewModel.tempObject = newObject;\r\n                dispatch(updateCanvasViewModel(canvasViewModel));\r\n            }\r\n        }\r\n\r\n        if (selectedObject != null) {\r\n            replaceSelectedObjectWithHistory(dispatch, editor, null);\r\n        }\r\n        let deltaX = (moveEnd.x - start.x) / scale;\r\n        let deltaY = (moveEnd.y - start.y) / scale;\r\n        if (canvas.style.cursor === \"pointer\") {\r\n            if (tempObject !== null) {\r\n                if (tempPoint !== null) {\r\n                    if (tempObject.type === Types.Rectangle\r\n                        || tempObject.type === Types.TextObject\r\n                        || tempObject.type === Types.Art\r\n                        || tempObject.type === Types.Area) {\r\n                        let objRA: Rectangle | Art | SelectedArea;\r\n                        if (tempObject.type === Types.TextObject) {\r\n                            objRA = (tempObject as TextObject).rectangle;\r\n                        } else {\r\n                            objRA = tempObject as Rectangle | Art | SelectedArea;\r\n                        }\r\n                        if (e.shiftKey && objRA.type === Types.Art) {\r\n                            const delta: Vector2 = { x: deltaX, y: deltaY };\r\n\r\n                            const distance = length(delta);\r\n                            const sizeLength = length(objRA.size);\r\n                            const cos = objRA.size.x / sizeLength;\r\n                            const sin = objRA.size.y / sizeLength;\r\n                            deltaX = distance * cos;\r\n                            deltaY = distance * sin;\r\n                            const dir = Math.sign(cosinus(delta, tempPoint));\r\n                            objRA.position.x += deltaX * Math.min(tempPoint.x, 0) * dir;\r\n                            objRA.position.y += deltaY * Math.min(tempPoint.y, 0) * dir;\r\n                            objRA.size.x += deltaX * dir;\r\n                            objRA.size.y += deltaY * dir;\r\n                        } else {\r\n                            if (tempPoint.x > 0) {\r\n                                objRA.size.x += deltaX;\r\n                            } else if (tempPoint.x < 0) {\r\n                                objRA.position.x += deltaX;\r\n                                objRA.size.x += -deltaX;\r\n                            }\r\n                            if (tempPoint.y > 0) {\r\n                                objRA.size.y += deltaY;\r\n                            } else if (tempPoint.y < 0) {\r\n                                objRA.position.y += deltaY;\r\n                                objRA.size.y += -deltaY;\r\n                            }\r\n                        }\r\n                        if (objRA.size.x === 0) {\r\n                            objRA.size.x = -1;\r\n                        }\r\n                        if (objRA.size.y === 0) {\r\n                            objRA.size.y = -1;\r\n                        }\r\n                        if (objRA.size.x < 0) {\r\n                            tempPoint.x *= -1;\r\n                            objRA.size.x = Math.abs(objRA.size.x);\r\n                            objRA.position.x -= objRA.size.x;\r\n                        }\r\n                        if (objRA.size.y < 0) {\r\n                            tempPoint.y *= -1;\r\n                            objRA.size.y = Math.abs(objRA.size.y);\r\n                            objRA.position.y -= objRA.size.y;\r\n                        }\r\n                    } else if (tempObject.type === Types.Triangle) {\r\n                        tempPoint.x += deltaX;\r\n                        tempPoint.y += deltaY;\r\n                    } else if (tempObject.type === Types.Circle) {\r\n                        const circle = tempObject as Circle;\r\n                        console.log(circle);\r\n                        circle.radius = Math.round(length({\r\n                            x: moveEnd.x - circle.position.x,\r\n                            y: moveEnd.y - circle.position.y\r\n                        }));\r\n                    }\r\n                }\r\n            }\r\n            newCanvasViewModel.start = moveEnd;\r\n        } else if (canvas.style.cursor === \"grabbing\") {\r\n            if (tempObject != null) {\r\n                if (tempObject.type === Types.Rectangle\r\n                    || tempObject.type === Types.Circle\r\n                    || tempObject.type === Types.TextObject\r\n                    || tempObject.type === Types.Art\r\n                    || tempObject.type === Types.Area) {\r\n                    let objRCA: Rectangle | Circle | Art | SelectedArea;\r\n                    if (tempObject.type === Types.TextObject) {\r\n                        objRCA = (tempObject as TextObject).rectangle;\r\n                    } else {\r\n                        objRCA = tempObject as Rectangle | Circle | Art | SelectedArea;\r\n                    }\r\n                    objRCA.position.x += deltaX;\r\n                    objRCA.position.y += deltaY;\r\n                } else if (tempObject.type === Types.Triangle) {\r\n                    const triangle = tempObject as Triangle;\r\n                    triangle.p0.x += deltaX;\r\n                    triangle.p0.y += deltaY;\r\n                    triangle.p1.x += deltaX;\r\n                    triangle.p1.y += deltaY;\r\n                    triangle.p2.x += deltaX;\r\n                    triangle.p2.y += deltaY;\r\n                }\r\n            }\r\n            newCanvasViewModel.start = moveEnd;\r\n        } else {\r\n            if (canvas.style.cursor === \"default\") {\r\n                if (viewModel.objectState.text !== \"\") {\r\n                    dispatch(updateText(\"\"));\r\n                }\r\n            }\r\n            onCreateObject({ x: start.x / scale, y: start.y / scale },\r\n                { x: moveEnd.x / scale, y: moveEnd.y / scale });\r\n        }\r\n    } else {\r\n        const setTempPoint = (point: Vector2) => {\r\n            newCanvasViewModel.tempPoint = point;\r\n        }\r\n        if (selectedObject === null && tempObject !== null && tempObject.type === Types.Area) {\r\n            setupCursor(canvas, scale, moveEnd, tempObject, setTempPoint);\r\n        } else {\r\n            setupCursor(canvas, scale, moveEnd, selectedObject, setTempPoint);\r\n        }\r\n        newCanvasViewModel.start = moveEnd;\r\n    }\r\n    dispatch(updateCanvasViewModel(newCanvasViewModel));\r\n}\r\n\r\nexport function onMouseUp(e: React.MouseEvent<HTMLCanvasElement, MouseEvent>,\r\n    dispatch: Function,\r\n    canvas: HTMLCanvasElement,\r\n    viewModel: ViewModel) {\r\n    const moveEnd: Vector2 = {\r\n        x: e.clientX - canvas.offsetLeft,\r\n        y: e.clientY - canvas.offsetTop\r\n    };\r\n    const canvasViewModel = viewModel.canvasModel;\r\n    const newCanvasViewModel = {\r\n        ...canvasViewModel\r\n    }\r\n    const editor = viewModel.editor;\r\n    const selectedObject = editor.selectedObject;\r\n    const tempObject = canvasViewModel.tempObject;\r\n    const scale = canvasViewModel.scale;\r\n\r\n    const setTempPoint = (point: Vector2) => {\r\n        newCanvasViewModel.tempPoint = point;\r\n    }\r\n\r\n    if (tempObject != null) {\r\n        setupCursor(canvas, scale, moveEnd, tempObject, setTempPoint);\r\n        if (tempObject.type !== Types.Area) {\r\n            dispatch(actionReplaceSelectedObject(tempObject as TextObject | Rectangle | Triangle | Circle | Art));\r\n            newCanvasViewModel.tempObject = null;\r\n        } else {\r\n            const area = tempObject as SelectedArea;\r\n            dispatch(selectArea(area));\r\n\r\n            const historyCanvas = editor.canvas;\r\n            dispatch(pushToHistory(historyCanvas));\r\n\r\n            newCanvasViewModel.tempObject = null;\r\n            dispatch(updateCanvasViewModel(newCanvasViewModel));\r\n        }\r\n    } else if (canvas.style.cursor === \"default\") {\r\n        if (selectedObject != null) {\r\n            replaceSelectedObjectWithHistory(dispatch, editor, null, editor.canvas);\r\n        } else {\r\n            dispatch(updateText(\"\"));\r\n        }\r\n    }\r\n    newCanvasViewModel.isCanvasDown = false;\r\n    dispatch(updateCanvasViewModel(newCanvasViewModel));\r\n}\r\n\r\n\r\nfunction setupCursor(canvas: HTMLCanvasElement,\r\n    scale: number,\r\n    moveEnd: Vector2,\r\n    selectedObject: Rectangle | Triangle | Circle | TextObject | Art | SelectedArea | null = null,\r\n    setTempPoint: Function) {\r\n    if (selectedObject != null) {\r\n        if (selectedObject.type === Types.Rectangle\r\n            || selectedObject.type === Types.TextObject\r\n            || selectedObject.type === Types.Art\r\n            || selectedObject.type === Types.Area) {\r\n            let objRA: Rectangle | Art | SelectedArea;\r\n            if (selectedObject.type === Types.TextObject) {\r\n                objRA = (selectedObject as TextObject).rectangle;\r\n            } else {\r\n                objRA = selectedObject as Rectangle | Art | SelectedArea;\r\n            }\r\n            const position = {\r\n                x: objRA.position.x * scale,\r\n                y: objRA.position.y * scale,\r\n            };\r\n            let size: Vector2 = {\r\n                x: objRA.size.x * scale,\r\n                y: objRA.size.y * scale,\r\n            };\r\n\r\n            const points = [\r\n                { x: position.x, y: position.y }, // Left Top\r\n                { x: position.x + size.x / 2, y: position.y }, // Top\r\n                { x: position.x + size.x, y: position.y }, // Top Right\r\n                { x: position.x + size.x, y: position.y + size.y / 2 }, // Right\r\n                { x: position.x + size.x, y: position.y + size.y }, // Bottom Right\r\n                { x: position.x + size.x / 2, y: position.y + size.y }, // Bottom\r\n                { x: position.x, y: position.y + size.y }, // Bottom Left\r\n                { x: position.x, y: position.y + size.y / 2 } // Left\r\n            ];\r\n            const pointIndex = points\r\n                .map((p) => length({ x: p.x - moveEnd.x, y: p.y - moveEnd.y }) <= 12)\r\n                .findIndex((value) => value);\r\n            if (pointIndex > -1) {\r\n                setTempPoint({\r\n                    x: Math.sign(points[pointIndex].x - (position.x + size.x / 2)),\r\n                    y: Math.sign(points[pointIndex].y - (position.y + size.y / 2))\r\n                });\r\n                canvas.style.cursor = \"pointer\";\r\n            } else if (moveEnd.x >= position.x\r\n                && moveEnd.x <= position.x + size.x\r\n                && moveEnd.y >= position.y\r\n                && moveEnd.y <= position.y + size.y) {\r\n                canvas.style.cursor = \"grab\";\r\n            } else {\r\n                canvas.style.cursor = \"default\";\r\n            }\r\n        } else if (selectedObject.type === Types.Triangle) {\r\n            const triangle = selectedObject as Triangle;\r\n            const points = [triangle.p0, triangle.p1, triangle.p2];\r\n            const scaledPoints = [\r\n                { x: triangle.p0.x * scale, y: triangle.p0.y * scale },\r\n                { x: triangle.p1.x * scale, y: triangle.p1.y * scale },\r\n                { x: triangle.p2.x * scale, y: triangle.p2.y * scale }];\r\n            const pointIndex = scaledPoints\r\n                .map((p) => length({ x: p.x - moveEnd.x, y: p.y - moveEnd.y }) <= 12)\r\n                .findIndex((value) => value);\r\n            if (pointIndex > -1) {\r\n                setTempPoint(points[pointIndex]);\r\n                canvas.style.cursor = \"pointer\";\r\n            } else if (pointInTriangle(moveEnd, scaledPoints[0], scaledPoints[1], scaledPoints[2])) {\r\n                canvas.style.cursor = \"grab\";\r\n            } else {\r\n                canvas.style.cursor = \"default\";\r\n            }\r\n        } else if (selectedObject.type === Types.Circle) {\r\n            const circle = selectedObject as Circle;\r\n            const position = {\r\n                x: circle.position.x * scale,\r\n                y: circle.position.y * scale,\r\n            };\r\n            const radius = circle.radius * scale;\r\n            const distance = length({ x: moveEnd.x - position.x, y: moveEnd.y - position.y });\r\n            if (distance >= radius - 12 && distance <= radius + 12) {\r\n                setTempPoint(position);\r\n                canvas.style.cursor = \"pointer\";\r\n            } else if (length({ x: moveEnd.x - position.x, y: moveEnd.y - position.y }) < Math.max(radius - 12, 0)) {\r\n                canvas.style.cursor = \"grab\";\r\n            } else {\r\n                canvas.style.cursor = \"default\";\r\n            }\r\n        }\r\n    } else {\r\n        canvas.style.cursor = \"default\";\r\n    }\r\n}\r\n\r\nfunction pointInTriangle(p: Vector2, p0: Vector2, p1: Vector2, p2: Vector2) {\r\n    var dX = p.x - p2.x;\r\n    var dY = p.y - p2.y;\r\n    var dX21 = p2.x - p1.x;\r\n    var dY12 = p1.y - p2.y;\r\n    var D = dY12 * (p0.x - p2.x) + dX21 * (p0.y - p2.y);\r\n    var s = dY12 * dX + dX21 * dY;\r\n    var t = (p2.y - p0.y) * dX + (p0.x - p2.x) * dY;\r\n    if (D < 0) return s <= 0 && t <= 0 && s + t >= D;\r\n    return s >= 0 && t >= 0 && s + t <= D;\r\n}\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { drawImageData, drawObject } from '../../helper/DrawHelper';\r\nimport styles from './Canvas.module.css';\r\nimport { Types } from '../../structures/Type';\r\nimport { Vector2 } from '../../structures/Vector2';\r\nimport { Art } from '../../structures/Art';\r\nimport { TextObject } from '../../structures/TextObject';\r\nimport { Rectangle } from '../../structures/Rectangle';\r\nimport { Triangle } from '../../structures/Triangle';\r\nimport { Circle } from '../../structures/Circle';\r\nimport { SelectedArea } from '../../structures/SelectedArea';\r\nimport { createArea } from '../../helper/ObjectCreateHelper';\r\nimport removeSelectedObject from '../../store/actionCreators/removeSelectedObject';\r\nimport selectArea from '../../store/actionCreators/selectArea';\r\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\r\nimport { Editor } from '../../structures/Editor';\r\nimport { ViewModel } from '../../viewmodel/ViewModel';\r\nimport cutSelectedArea from '../../store/actionCreators/cutSelectedArea';\r\nimport pushToHistory from '../../store/actionCreators/pushToHistory';\r\nimport actionReplaceSelectedObject from '../../store/actionCreators/actionReplaceSelectedObject';\r\nimport { DrawProps } from '../../structures/DrawProps';\r\nimport { onMouseDown, onMouseMove, onMouseUp } from './CanvasHandler';\r\nimport { CanvasViewModel } from '../../viewmodel/CanvasViewModel';\r\nimport updateCanvasViewModel from '../../store/actionCreators/updateCanvasViewModel';\r\nimport updateText from '../../store/actionCreators/updateText';\r\nimport { toHexColor } from '../../helper/ColorHelper';\r\nimport { ToolType } from '../tool/Tools';\r\nimport { replaceSelectedObjectWithHistory } from '../../helper/EditorHelper';\r\n\r\ninterface CanvasProps {\r\n    focused: boolean;\r\n}\r\n\r\nexport default function Canvas({ focused }: CanvasProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const state: ViewModel = useSelector(\r\n        (state: ViewModel) => state\r\n    )\r\n    const selectedObject = state.editor.selectedObject;\r\n    const objectState = state.objectState;\r\n\r\n    const canvasViewModel: CanvasViewModel = state.canvasModel;\r\n    const tempObject = canvasViewModel.tempObject;\r\n\r\n    const editor: Editor = useSelector(\r\n        (state: ViewModel) => state.editor,\r\n        shallowEqual\r\n    )\r\n    const imageData = editor.canvas;\r\n\r\n    const position = canvasViewModel.canvasPosition;\r\n\r\n    if (selectedObject != null) {\r\n        if (selectedObject.type === Types.Rectangle ||\r\n            selectedObject.type === Types.Triangle ||\r\n            selectedObject.type === Types.Circle ||\r\n            selectedObject.type === Types.TextObject) {\r\n            let drawProps: DrawProps;\r\n            if (selectedObject.type === Types.TextObject) {\r\n                const textObject = selectedObject as TextObject;\r\n                textObject.text = objectState.text;\r\n                textObject.textSize = objectState.textSize;\r\n                textObject.textColor = objectState.textColor;\r\n                drawProps = textObject.rectangle.props;\r\n            } else {\r\n                drawProps = selectedObject.props;\r\n            }\r\n            drawProps.fillColor = objectState.fillColor;\r\n            drawProps.strokeColor = objectState.strokeColor;\r\n            drawProps.strokeWidth = objectState.strokeWidth;\r\n        }\r\n    }\r\n\r\n    const canvasContainer = useRef<HTMLDivElement>(null);\r\n    const canvasElement = useRef<HTMLCanvasElement>(null);\r\n    useEffect(() => {\r\n        const scale = canvasViewModel.scale;\r\n        if (canvasElement.current !== null && canvasContainer.current !== null) {\r\n            canvasElement.current.width = imageData.width * scale;\r\n            canvasElement.current.height = imageData.height * scale;\r\n            if (canvasElement.current != null) {\r\n                renderCanvas(canvasElement.current, scale, imageData, selectedObject, canvasViewModel.tempObject);\r\n            }\r\n        }\r\n    })\r\n    useEffect(() => {\r\n        if (!focused) {\r\n            return;\r\n        }\r\n        const scale = canvasViewModel.scale;\r\n        const zoomIntensity = 0.1;\r\n        const wheelListener = (e: WheelEvent) => {\r\n            let newScale = scale;\r\n\r\n            // Идеальная формула для масштабирования :)\r\n            const scroll = e.deltaY < 0 ? 1 : -2;\r\n            const zoom = Math.exp(scroll * zoomIntensity);\r\n            newScale *= zoom;\r\n            if (newScale > 4) {\r\n                newScale = scale;\r\n            }\r\n\r\n            const newX = canvasViewModel.canvasPosition.x - (e.clientX / scale - canvasViewModel.canvasPosition.x / scale) * (newScale - scale)\r\n            const newY = canvasViewModel.canvasPosition.y - (e.clientY / scale - canvasViewModel.canvasPosition.y / scale) * (newScale - scale)\r\n\r\n            const newCanvasViewModel = {\r\n                ...canvasViewModel,\r\n                canvasPosition: {\r\n                    x: newX,\r\n                    y: newY,\r\n                },\r\n                scale: newScale\r\n            }\r\n            dispatch(updateCanvasViewModel(newCanvasViewModel));\r\n        }\r\n        window.addEventListener(\"wheel\", wheelListener);\r\n\r\n        const mouseDownListener = (e: MouseEvent) => {\r\n            if (e.button === 1) {\r\n                document.body.style.cursor = \"move\"\r\n                if (canvasElement.current !== null) {\r\n                    canvasElement.current.style.cursor = \"move\"\r\n                }\r\n                canvasViewModel.isMiddleMouseDown = true;\r\n                canvasViewModel.middleMouseStart = { x: e.clientX, y: e.clientY }\r\n                dispatch(updateCanvasViewModel(canvasViewModel));\r\n            }\r\n        };\r\n        window.addEventListener(\"mousedown\", mouseDownListener)\r\n\r\n        const mouseMoveListener = (e: MouseEvent) => {\r\n            if (canvasViewModel.isMiddleMouseDown && canvasElement.current !== null) {\r\n                canvasViewModel.canvasPosition = ({\r\n                    x: canvasViewModel.canvasPosition.x + (e.clientX - canvasViewModel.middleMouseStart.x),\r\n                    y: canvasViewModel.canvasPosition.y + (e.clientY - canvasViewModel.middleMouseStart.y)\r\n                });\r\n                canvasElement.current.style.marginLeft = `${canvasViewModel.canvasPosition.x}px`;\r\n                canvasElement.current.style.marginTop = `${canvasViewModel.canvasPosition.y}px`;\r\n\r\n                canvasViewModel.middleMouseStart = { x: e.clientX, y: e.clientY };\r\n                dispatch(updateCanvasViewModel(canvasViewModel));\r\n            }\r\n        };\r\n        window.addEventListener(\"mousemove\", mouseMoveListener);\r\n\r\n        const mouseUpListener = (e: MouseEvent) => {\r\n            if (e.button === 1) {\r\n                document.body.style.cursor = \"default\";\r\n                if (canvasElement.current !== null) {\r\n                    canvasElement.current.style.cursor = \"default\"\r\n                }\r\n                canvasViewModel.isMiddleMouseDown = false;\r\n                dispatch(updateCanvasViewModel(canvasViewModel));\r\n            }\r\n        };\r\n        window.addEventListener(\"mouseup\", mouseUpListener);\r\n        return () => {\r\n            window.removeEventListener(\"wheel\", wheelListener);\r\n            window.removeEventListener(\"mousedown\", mouseDownListener);\r\n            window.removeEventListener(\"mousemove\", mouseMoveListener);\r\n            window.removeEventListener(\"mouseup\", mouseUpListener);\r\n        }\r\n    }, [canvasViewModel,\r\n        dispatch,\r\n        selectedObject,\r\n        imageData, focused]);\r\n    useEffect(() => {\r\n        if (!focused) {\r\n            return;\r\n        }\r\n        const listener = (e: KeyboardEvent) => {\r\n            if (e.ctrlKey) {\r\n                if (e.code === \"KeyX\") {\r\n                    if (tempObject != null && tempObject.type === Types.Area) {\r\n                        dispatch(selectArea(tempObject as SelectedArea));\r\n\r\n                        let historyCanvas = editor.canvas;\r\n                        dispatch(cutSelectedArea());\r\n                        dispatch(pushToHistory(historyCanvas));\r\n\r\n                        canvasViewModel.tempObject = null;\r\n                        dispatch(updateCanvasViewModel(canvasViewModel));\r\n                        dispatch(removeSelectedObject());\r\n                    }\r\n                } else if (e.code === \"KeyA\") {\r\n                    if (selectedObject?.type !== Types.TextObject) {\r\n                        const area = createArea({ x: 0, y: 0 }, { x: imageData.width, y: imageData.height }, objectState);\r\n                        dispatch(selectArea(area));\r\n\r\n                        const historyCanvas = editor.canvas;\r\n                        dispatch(pushToHistory(historyCanvas));\r\n                    }\r\n                }\r\n            } else {\r\n                const handleUnfocus = () => {\r\n                    replaceSelectedObjectWithHistory(dispatch, editor, null);\r\n                    canvasViewModel.tempObject = null;\r\n                    dispatch(updateCanvasViewModel(canvasViewModel));\r\n                    dispatch(updateText(\"\"));\r\n                }\r\n                switch (e.code) {\r\n                    case \"Escape\":\r\n                        if (!(tempObject != null && tempObject.type === Types.Area)) {\r\n                            const historyCanvas = editor.canvas;\r\n                            dispatch(actionReplaceSelectedObject(null));\r\n                            dispatch(pushToHistory(historyCanvas));\r\n                        }\r\n                        handleUnfocus();\r\n                        break;\r\n                    case \"Delete\":\r\n                        if (!(tempObject != null && tempObject.type === Types.Area)) {\r\n                            dispatch(removeSelectedObject());\r\n                        }\r\n                        canvasViewModel.tempObject = null;\r\n                        dispatch(updateCanvasViewModel(canvasViewModel));\r\n                        dispatch(updateText(\"\"));\r\n                        break;\r\n                    case \"Enter\":\r\n                        if (e.shiftKey) {\r\n                            break;\r\n                        }\r\n                        handleUnfocus();\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        window.addEventListener(\"keydown\", listener)\r\n        return () => {\r\n            window.removeEventListener(\"keydown\", listener)\r\n        }\r\n    })\r\n    const [firstTextFocus, setFirstTextFocus] = useState<boolean>(true);\r\n    const textArea = useRef<HTMLTextAreaElement>(null);\r\n    useEffect(() => {\r\n        if (selectedObject?.type === Types.TextObject && firstTextFocus) {\r\n            setFirstTextFocus(false);\r\n            textArea.current?.focus();\r\n        } else if (state.currentTool !== ToolType.Text) {\r\n            setFirstTextFocus(true);\r\n        }\r\n    }, [firstTextFocus, setFirstTextFocus, state, selectedObject])\r\n    return (\r\n        <div\r\n            ref={canvasContainer}\r\n            className={styles.CanvasContainer}>\r\n            {selectedObject !== null && selectedObject.type === Types.TextObject &&\r\n                <textarea\r\n                    ref={textArea}\r\n                    style={{\r\n                        marginLeft: position.x +\r\n                            ((selectedObject as TextObject).rectangle.position.x +\r\n                                objectState.padding) * canvasViewModel.scale,\r\n                        marginTop: position.y +\r\n                            ((selectedObject as TextObject).rectangle.position.y +\r\n                                objectState.padding) * canvasViewModel.scale,\r\n                        position: \"fixed\",\r\n                        width: ((selectedObject as TextObject).rectangle.size.x -\r\n                            objectState.padding * 2) * canvasViewModel.scale,\r\n                        height: ((selectedObject as TextObject).rectangle.size.y -\r\n                            objectState.padding * 2) * canvasViewModel.scale,\r\n                        resize: \"none\",\r\n                        fontFamily: objectState.fontName,\r\n                        fontSize: `${(selectedObject as TextObject).textSize * canvasViewModel.scale}px`,\r\n                        lineHeight: `${(selectedObject as TextObject).textSize * canvasViewModel.scale * 1.25}px`,\r\n                        backgroundColor: \"#FFFFFF00\",\r\n                        border: \"none\",\r\n                        outline: \"none\",\r\n                        color: `${toHexColor(objectState.textColor)}`\r\n                    }}\r\n                    value={objectState.text}\r\n                    onChange={(e) => {\r\n                        dispatch(updateText(e.target.value))\r\n                    }}\r\n                >\r\n                </textarea>\r\n            }\r\n\r\n            <canvas id=\"canvas\"\r\n                ref={canvasElement}\r\n                className={styles.Canvas}\r\n                style={{ marginLeft: position.x, marginTop: position.y }}\r\n                onMouseDown={(e) => {\r\n                    if (canvasElement.current) {\r\n                        onMouseDown(e, dispatch, canvasElement.current, state);\r\n                    }\r\n                }}\r\n                onMouseMove={(e) => {\r\n                    if (canvasElement.current) {\r\n                        onMouseMove(e, dispatch, canvasElement.current, state);\r\n                    }\r\n                }}\r\n                onMouseUp={(e) => {\r\n                    if (canvasElement.current) {\r\n                        onMouseUp(e, dispatch, canvasElement.current, state);\r\n                    }\r\n                }}>\r\n            </canvas>\r\n        </div >\r\n    );\r\n}\r\n\r\nfunction renderCanvas(canvas: HTMLCanvasElement, scale: number, imageData: ImageData,\r\n    selectedObject: Rectangle | Triangle | Circle | TextObject | Art | null = null,\r\n    tempCanvasObject: Rectangle | Triangle | Circle | TextObject | Art | SelectedArea | null = null) {\r\n    if (canvas == null) {\r\n        return;\r\n    }\r\n    const context = canvas.getContext(\"2d\");\r\n    if (context != null) {\r\n        context.scale(scale, scale);\r\n        drawImageData(context, imageData);\r\n\r\n        if (selectedObject != null) {\r\n            if (selectedObject.type === Types.TextObject) {\r\n                context.putImageData(drawObject(context, { x: imageData.width, y: imageData.height }, (selectedObject as TextObject).rectangle), 0, 0);\r\n            } else {\r\n                context.putImageData(drawObject(context, { x: imageData.width, y: imageData.height }, selectedObject), 0, 0);\r\n            }\r\n            drawBorder(scale, selectedObject, context);\r\n        }\r\n        if (tempCanvasObject != null) {\r\n            if (tempCanvasObject.type !== Types.Area) {\r\n                let objRTCTA = tempCanvasObject as Rectangle | Triangle | Circle | TextObject | Art;\r\n                if (objRTCTA.type === Types.TextObject) {\r\n                    context.putImageData(drawObject(context, { x: imageData.width, y: imageData.height }, (objRTCTA as TextObject).rectangle), 0, 0);\r\n                } else {\r\n                    context.putImageData(drawObject(context, { x: imageData.width, y: imageData.height }, objRTCTA), 0, 0);\r\n                }\r\n            } else {\r\n                drawBorder(scale, tempCanvasObject as SelectedArea, context);\r\n            }\r\n        }\r\n        context.scale(1 / scale, 1 / scale);\r\n    }\r\n}\r\n\r\nfunction createGradient(ctx: CanvasRenderingContext2D, position: Vector2, size: Vector2) {\r\n    const grad = ctx.createLinearGradient(position.x, position.y, position.x + size.x, position.y + size.y);\r\n    grad.addColorStop(0, \"#F00\");\r\n    grad.addColorStop(0.2, \"#FF0\");\r\n    grad.addColorStop(0.4, \"#0F0\");\r\n    grad.addColorStop(0.6, \"#0FF\");\r\n    grad.addColorStop(0.8, \"#00F\");\r\n    grad.addColorStop(1, \"#F0F\");\r\n    return grad;\r\n}\r\n\r\nfunction drawBorder(scale: number, obj: Rectangle | Triangle | Circle | TextObject | Art | SelectedArea, ctx: CanvasRenderingContext2D) {\r\n    ctx.lineWidth = 2 / scale;\r\n\r\n    if (obj.type === Types.Rectangle\r\n        || obj.type === Types.TextObject\r\n        || obj.type === Types.Art\r\n        || obj.type === Types.Area) {\r\n        let objRA: Rectangle | Art | SelectedArea;\r\n        if (obj.type === Types.TextObject) {\r\n            objRA = (obj as TextObject).rectangle;\r\n        } else {\r\n            objRA = obj as Rectangle | Art | SelectedArea;\r\n        }\r\n        if (obj.type === Types.Area) {\r\n            ctx.setLineDash([3, 4]);\r\n        }\r\n        let position = {\r\n            x: objRA.position.x,\r\n            y: objRA.position.y\r\n        };\r\n        let size = {\r\n            x: objRA.size.x,\r\n            y: objRA.size.y\r\n        };\r\n        ctx.beginPath();\r\n        const normY = Math.min(position.y + size.y, position.y);\r\n        ctx.moveTo(\r\n            position.x - ctx.lineWidth,\r\n            normY - ctx.lineWidth);\r\n        ctx.lineTo(\r\n            position.x + size.x + ctx.lineWidth,\r\n            normY - ctx.lineWidth);\r\n        ctx.lineTo(\r\n            position.x + size.x + ctx.lineWidth,\r\n            normY + Math.abs(size.y) + ctx.lineWidth);\r\n        ctx.lineTo(\r\n            position.x - ctx.lineWidth,\r\n            normY + Math.abs(size.y) + ctx.lineWidth);\r\n        ctx.lineTo(\r\n            position.x - ctx.lineWidth,\r\n            normY - ctx.lineWidth);\r\n        ctx.closePath();\r\n        ctx.strokeStyle = createGradient(ctx, position, size);\r\n        ctx.fillStyle = ctx.strokeStyle;\r\n        ctx.stroke();\r\n\r\n        const radius = 8;\r\n\r\n        const positions = [\r\n            { x: position.x, y: position.y }, //Left Top\r\n            { x: position.x + size.x / 2, y: position.y }, // Top\r\n            { x: position.x + size.x, y: position.y }, // Right Top\r\n            { x: position.x + size.x, y: position.y + size.y / 2 }, // Right\r\n            { x: position.x + size.x, y: position.y + size.y }, // Right Bottom\r\n            { x: position.x + size.x / 2, y: position.y + size.y }, // Bottom\r\n            { x: position.x, y: position.y + size.y }, // Left Bottom\r\n            { x: position.x, y: position.y + size.y / 2 }, // Left\r\n        ];\r\n\r\n        if (obj.type === Types.Area) {\r\n            ctx.setLineDash([]);\r\n        }\r\n\r\n        positions.forEach((item) => {\r\n            ctx.beginPath();\r\n            ctx.arc(\r\n                item.x,\r\n                item.y,\r\n                radius / scale,\r\n                0,\r\n                2 * Math.PI,\r\n                false\r\n            );\r\n            ctx.closePath();\r\n            ctx.fill();\r\n            ctx.strokeStyle = \"#424242\"\r\n            ctx.stroke();\r\n        });\r\n    } else if (obj.type === Types.Triangle) {\r\n        const triangle = obj as Triangle;\r\n        ctx.beginPath();\r\n        ctx.moveTo(triangle.p0.x, triangle.p0.y);\r\n        ctx.lineTo(triangle.p1.x, triangle.p1.y);\r\n        ctx.lineTo(triangle.p2.x, triangle.p2.y);\r\n        ctx.closePath();\r\n\r\n\r\n        const positions = [triangle.p0, triangle.p1, triangle.p2];\r\n\r\n        const min = {\r\n            x: Math.min(triangle.p0.x, triangle.p1.x, triangle.p2.x),\r\n            y: Math.min(triangle.p0.y, triangle.p1.y, triangle.p2.y),\r\n        }\r\n\r\n        const max = {\r\n            x: Math.max(triangle.p0.x, triangle.p1.x, triangle.p2.x),\r\n            y: Math.max(triangle.p0.y, triangle.p1.y, triangle.p2.y),\r\n        }\r\n        ctx.strokeStyle = createGradient(ctx, min, {\r\n            x: max.x - min.x,\r\n            y: max.y - min.y\r\n        });\r\n        ctx.fillStyle = ctx.strokeStyle;\r\n        ctx.stroke();\r\n\r\n        const radius = 8;\r\n\r\n        positions.forEach((item) => {\r\n            ctx.beginPath();\r\n            ctx.arc(\r\n                item.x,\r\n                item.y,\r\n                radius / scale,\r\n                0,\r\n                2 * Math.PI,\r\n                false\r\n            );\r\n            ctx.fill();\r\n            ctx.strokeStyle = \"#424242\"\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        });\r\n    } else if (obj.type === Types.Circle) {\r\n        const circle = obj as Circle;\r\n        const position = circle.position;\r\n        ctx.beginPath();\r\n        ctx.moveTo(\r\n            position.x + circle.radius + ctx.lineWidth,\r\n            position.y);\r\n        ctx.arc(position.x, position.y, circle.radius + ctx.lineWidth, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.strokeStyle = createGradient(ctx, {\r\n            x: position.x - circle.radius,\r\n            y: position.y - circle.radius\r\n        }, {\r\n            x: circle.radius * 2,\r\n            y: circle.radius * 2\r\n        });\r\n        ctx.fillStyle = ctx.strokeStyle;\r\n        ctx.stroke();\r\n    }\r\n}\r\n","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        root: {\r\n            margin: \"8px 0\",\r\n            color: \"#000000\",\r\n            '& label': {\r\n                color: \"#aa00ff\"\r\n            },\r\n            '& .MuiOutlinedInput-root': {\r\n                backgroundColor: \"#FFFFFFa5\",\r\n                boxShadow: \"4px 4px 16px #646464a5, -4px -4px 16px #ffffffa5\",\r\n\r\n                '& fieldset': {\r\n                    borderColor: \"#aa00ff\"\r\n                },\r\n                '&:hover fieldset': {\r\n                    borderColor: \"#aa00ff\",\r\n                },\r\n                '&.Mui-focused fieldset': {\r\n                    borderColor: \"#aa00ff\"\r\n                }\r\n            }\r\n        }\r\n    }));\r\n\r\nexport default useStyles;","import React, { CSSProperties, useState } from 'react';\r\nimport { ChromePicker, ColorResult } from 'react-color';\r\nimport { toHexColor, toRGBAColor } from '../../helper/ColorHelper';\r\nimport useStyles from '../../objectparams/ObjectParamsStyle';\r\nimport { RGBAColor } from '../../structures/RGBAColor';\r\nimport ReactiveTextField from '../reactivetextfield/ReactiveTextField';\r\n\r\ninterface ColorPickerProps {\r\n    id: string,\r\n    title: string,\r\n    defaultColor: RGBAColor,\r\n    onChange(color: RGBAColor): void\r\n}\r\n\r\nexport default function TextColorPicker(props: ColorPickerProps) {\r\n    const classes = useStyles();\r\n    const [color, setColor] = useState(props.defaultColor)\r\n    const [displayColorPicker, setDisplayColorPicker] = useState(false)\r\n    const handleChange = (result: ColorResult) => {\r\n        if (result !== undefined) {\r\n            let alpha = result.rgb.a;\r\n            if (alpha === undefined) {\r\n                alpha = 1;\r\n            }\r\n            const newColor = { r: result.rgb.r, g: result.rgb.g, b: result.rgb.b, a: alpha };\r\n            setColor(newColor);\r\n            props.onChange(newColor);\r\n        }\r\n    };\r\n\r\n    const handleClick = () => {\r\n        setDisplayColorPicker(!displayColorPicker)\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setDisplayColorPicker(false)\r\n    };\r\n    const popover: CSSProperties = {\r\n        position: 'fixed',\r\n        zIndex: 4\r\n    }\r\n\r\n    const cover: CSSProperties = {\r\n        position: 'fixed',\r\n        top: '0px',\r\n        right: '0px',\r\n        bottom: '0px',\r\n        left: '0px',\r\n    }\r\n    return (\r\n        <div>\r\n            <div>\r\n                {displayColorPicker ? <div style={popover}>\r\n                    <div style={cover} onClick={handleClose} />\r\n                    <div ref={\r\n                        (e) => {\r\n                            if (e !== null) {\r\n                                e.style.transform = `translateY(${-e.clientHeight - 8}px)`;\r\n                            }\r\n                        }}>\r\n                        <ChromePicker\r\n                            color={{ r: color.r, g: color.g, b: color.b, a: color.a }}\r\n                            disableAlpha={false}\r\n                            onChangeComplete={handleChange}\r\n                            onChange={handleChange}>\r\n                        </ChromePicker>\r\n                    </div>\r\n                </div> : null}\r\n                <ReactiveTextField\r\n                    className={classes.root}\r\n                    id={props.id}\r\n                    label={props.title}\r\n                    text={toHexColor(color)}\r\n                    type=\"text\"\r\n                    onClick={handleClick}\r\n                    onChange={(e) => {\r\n                        (e.target as HTMLInputElement).oninput = null;\r\n                        const newColor = toRGBAColor(e.target.value);\r\n                        setColor(newColor);\r\n                        props.onChange(newColor);\r\n                    }}></ReactiveTextField>\r\n            </div>\r\n        </div >\r\n    );\r\n}","const UPDATE_FILL_COLOR = \"UPDATE_FILL_COLOR\";\r\nexport default UPDATE_FILL_COLOR;","const UPDATE_STROKE_COLOR = \"UPDATE_STROKE_COLOR\";\r\nexport default UPDATE_STROKE_COLOR;","const UPDATE_STROKE_WIDTH = \"UPDATE_STROKE_WIDTH\";\r\nexport default UPDATE_STROKE_WIDTH;","const UPDATE_TEXT_COLOR = \"UPDATE_TEXT_COLOR\";\r\nexport default UPDATE_TEXT_COLOR;","const UPDATE_TEXT_SIZE = \"UPDATE_TEXT_SIZE\";\r\nexport default UPDATE_TEXT_SIZE;","const UPDATE_FONT_NAME = \"UPDATE_FONT_NAME\";\r\nexport default UPDATE_FONT_NAME;","const UPDATE_TEXT_PADDING = \"UPDATE_TEXT_PADDING\";\r\nexport default UPDATE_TEXT_PADDING;","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport TextColorPicker from '../components/colopicker/TextColorPicker';\r\nimport ReactiveTextField from '../components/reactivetextfield/ReactiveTextField';\r\nimport { ToolType } from '../components/tool/Tools';\r\nimport updateFillColor from '../store/actionCreators/updateFillColor';\r\nimport updateStrokeColor from '../store/actionCreators/updateStrokeColor';\r\nimport updateStrokeWidth from '../store/actionCreators/updateStrokeWidth';\r\nimport updateTextColor from '../store/actionCreators/updateTextColor';\r\nimport updateTextSize from '../store/actionCreators/updateTextSize';\r\nimport updateFontName from '../store/actionCreators/updateFontName';\r\nimport { ObjectState } from '../viewmodel/ObjectState';\r\nimport { ViewModel } from '../viewmodel/ViewModel';\r\nimport styles from './ObjectParams.module.css';\r\nimport useStyles from './ObjectParamsStyle';\r\nimport updateTextPadding from '../store/actionCreators/updateTextPadding';\r\n\r\nfunction ObjectParams() {\r\n    const classes = useStyles();\r\n    const dispatch = useDispatch();\r\n    const objectState: ObjectState = useSelector(\r\n        (state: ViewModel) => state.objectState\r\n    )\r\n    const tool: ToolType = useSelector(\r\n        (state: ViewModel) => state.currentTool\r\n    )\r\n    return (\r\n        <div className={styles.ObjectParams}>\r\n            <div className={styles.ParamsList}>\r\n                <TextColorPicker\r\n                    id=\"TextField-fillColor\"\r\n                    title=\"Цвет заливки\"\r\n                    defaultColor={objectState.fillColor}\r\n                    onChange={(color) => {\r\n                        dispatch(updateFillColor(color));\r\n                    }}></TextColorPicker>\r\n                <TextColorPicker\r\n                    id=\"TextField-strokeColor\"\r\n                    title=\"Цвет контура\"\r\n                    defaultColor={objectState.strokeColor}\r\n                    onChange={(color) => {\r\n                        dispatch(updateStrokeColor(color))\r\n                    }}></TextColorPicker>\r\n                <ReactiveTextField\r\n                    className={classes.root}\r\n                    label=\"Толщина контура\"\r\n                    defaultText={`${objectState.strokeWidth}`}\r\n                    min=\"0\"\r\n                    type=\"number\"\r\n                    onChange={(e) => {\r\n                        const strokeWidth = parseInt(e.target.value);\r\n                        dispatch(updateStrokeWidth(strokeWidth))\r\n                    }}></ReactiveTextField>\r\n            </div>\r\n            <div className={styles.ParamsList}>\r\n                {tool === ToolType.Text\r\n                    && <ReactiveTextField\r\n                        className={classes.root}\r\n                        label=\"Размер текста\"\r\n                        defaultText={`${objectState.textSize}`}\r\n                        min=\"1\"\r\n                        type=\"number\"\r\n                        onChange={(e) => {\r\n                            dispatch(updateTextSize(parseInt(e.target.value)))\r\n                        }}></ReactiveTextField>\r\n                }\r\n                {tool === ToolType.Text\r\n                    && <TextColorPicker\r\n                        id=\"TextField-textColor\"\r\n                        title=\"Цвет текста\"\r\n                        defaultColor={objectState.textColor}\r\n                        onChange={(color) => {\r\n                            dispatch(updateTextColor(color));\r\n                        }}></TextColorPicker>\r\n                }\r\n                {tool === ToolType.Text\r\n                    && <ReactiveTextField\r\n                        className={classes.root}\r\n                        label=\"Шрифт\"\r\n                        defaultText={`${objectState.fontName}`}\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                            dispatch(updateFontName(e.target.value))\r\n                        }}></ReactiveTextField>\r\n                }\r\n            </div>\r\n            <div className={styles.ParamsList}>\r\n                {tool === ToolType.Text\r\n                    && <ReactiveTextField\r\n                        className={classes.root}\r\n                        label=\"Внутренний отступ\"\r\n                        defaultText={`${objectState.padding}`}\r\n                        min=\"0\"\r\n                        type=\"number\"\r\n                        onChange={(e) => {\r\n                            dispatch(updateTextPadding(parseInt(e.target.value)))\r\n                        }}></ReactiveTextField>\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ObjectParams;\r\n","export enum Filter {\r\n    Grey, Red, Green, Blue, Brightness, Blur\r\n}","import { RGBAColor } from \"../../structures/RGBAColor\";\r\nimport RGBAColorAction from \"../actions/types/RGBAColorAction\";\r\nimport UPDATE_FILL_COLOR from \"../actions/updateFillColor\";\r\n\r\nexport default function updateFillColor(color: RGBAColor): RGBAColorAction {\r\n    return { \r\n        type: UPDATE_FILL_COLOR,\r\n        value: color\r\n    };\r\n}","import { RGBAColor } from \"../../structures/RGBAColor\";\r\nimport RGBAColorAction from \"../actions/types/RGBAColorAction\";\r\nimport UPDATE_STROKE_COLOR from \"../actions/updateStrokeColor\";\r\n\r\nexport default function updateStrokeColor(value: RGBAColor): RGBAColorAction {\r\n    return { \r\n        type: UPDATE_STROKE_COLOR,\r\n        value: value\r\n    };\r\n}","import NumberAction from \"../actions/types/NumberAction\";\r\nimport UPDATE_STROKE_WIDTH from \"../actions/updateStrokeWidth\";\r\n\r\nexport default function updateStrokeWidth(value: number): NumberAction {\r\n    return { \r\n        type: UPDATE_STROKE_WIDTH,\r\n        value: value\r\n    };\r\n}","import NumberAction from \"../actions/types/NumberAction\";\r\nimport UPDATE_TEXT_SIZE from \"../actions/updateTextSize\";\r\n\r\nexport default function updateTextSize(value: number): NumberAction {\r\n    return { \r\n        type: UPDATE_TEXT_SIZE,\r\n        value: value\r\n    };\r\n}","import { RGBAColor } from \"../../structures/RGBAColor\";\r\nimport RGBAColorAction from \"../actions/types/RGBAColorAction\";\r\nimport UPDATE_TEXT_COLOR from \"../actions/updateTextColor\";\r\n\r\nexport default function updateTextColor(value: RGBAColor): RGBAColorAction {\r\n    return { \r\n        type: UPDATE_TEXT_COLOR,\r\n        value: value\r\n    };\r\n}","import StringAction from \"../actions/types/StringAction\";\r\nimport UPDATE_FONT_NAME from \"../actions/updateFontName\";\r\n\r\nexport default function updateFontName(value: string): StringAction {\r\n    return { \r\n        type: UPDATE_FONT_NAME,\r\n        value: value\r\n    };\r\n}","import NumberAction from \"../actions/types/NumberAction\";\r\nimport UPDATE_TEXT_PADDING from \"../actions/updateTextPadding\";\r\n\r\nexport default function updateTextPadding(value: number): NumberAction {\r\n    return { \r\n        type: UPDATE_TEXT_PADDING,\r\n        value: value\r\n    };\r\n}","import { SvgIcon } from \"@material-ui/core\";\r\nimport React from 'react';\r\n\r\nexport default function FilterIcon() {\r\n\treturn (\r\n\t\t<SvgIcon viewBox=\"0 0 512 512\" style={{ width: \"100%\", height: \"100%\" }}>\r\n\t\t\t<path style={{ fill: \"#FFE17D\" }} d=\"M214.71,306.106v197.626c0,6.139,6.46,10.132,11.951,7.386l61.5-30.75  c5.595-2.798,9.13-8.517,9.13-14.772v-159.49c0-5.702,1.967-11.229,5.568-15.649L473.4,81.157c3.602-4.42,5.568-9.947,5.568-15.649  V16.516C478.968,7.395,471.573,0,462.452,0H49.548c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649  l170.541,209.3C212.743,294.877,214.71,300.404,214.71,306.106z\" />\r\n\t\t\t<path style={{ fill: \"#FFD164\" }} d=\"M404.355,66.065H198.194c-4.561,0-8.258-3.697-8.258-8.258V0H49.548  c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649l170.541,209.3c3.602,4.42,5.569,9.948,5.569,15.65  v197.625c0,6.139,6.46,10.132,11.951,7.386l17.105-8.552V305.548c0-4.561,3.697-8.258,8.258-8.258h11.74  c5.474,0,10.593-2.712,13.667-7.242L415.346,86.804C421.33,77.985,415.013,66.065,404.355,66.065z\" />\r\n\t\t\t<path style={{ fill: \"#FFC350\" }} d=\"M123.502,66.065H33.08c0.126,5.502,2.037,10.817,5.52,15.091l170.541,209.3  c1.681,2.064,2.968,4.383,3.903,6.835h6.065c5.821,0,9.814-5.86,7.686-11.278L146.561,81.78  C142.836,72.299,133.688,66.065,123.502,66.065z\" />\r\n\t\t</SvgIcon >\r\n\t);\r\n}\r\n","import {\r\n    ClickAwayListener, createStyles, IconButton, makeStyles,\r\n    MenuList, Paper, SvgIcon\r\n} from '@material-ui/core';\r\nimport React from 'react';\r\nimport { Filter } from '../../structures/Filter';\r\nimport FilterIcon from './FIltersIcon';\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        filtersContainer: {\r\n            minHeight: \"65px\",\r\n            display: \"flex\",\r\n            position: \"fixed\",\r\n            textAlign: \"start\",\r\n            verticalAlign: \"middle\",\r\n            left: \"9px\",\r\n            top: \"332px\",\r\n            '&:hover': {\r\n                '& $paper': {\r\n                    display: \"block\",\r\n                },\r\n            },\r\n        },\r\n        button: {\r\n            color: \"#FFFFFF\",\r\n            fontWeight: 600,\r\n            fontFamily: \"monospace\",\r\n            fontSize: \"16px\",\r\n            padding: \"16px\",\r\n            width: \"56px\",\r\n            height: \"56px\",\r\n            margin: \"auto 0\",\r\n            background: \"rgba(0, 0, 0, 0.20)\",\r\n            boxShadow: \"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )\",\r\n            backdropFilter: \"blur(10.0px)\",\r\n            WebkitBackdropFilter: \"blur( 10.0px )\",\r\n            borderRadius: \"32px\",\r\n            borderTop: \"1px solid rgba( 255, 255, 255, 0.18 )\",\r\n            borderLeft: \"1px solid rgba( 255, 255, 255, 0.18 )\"\r\n        },\r\n        paper: {\r\n            color: \"white\",\r\n            display: \"none\",\r\n            marginLeft: \"8px\",\r\n            background: \"rgba(0, 0, 0, 0.20)\",\r\n            boxShadow: \"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )\",\r\n            backdropFilter: \"blur(10.0px)\",\r\n            WebkitBackdropFilter: \"blur( 10.0px )\",\r\n            borderRadius: \"32px\",\r\n            borderTop: \"1px solid rgba( 255, 255, 255, 0.18 )\",\r\n            borderLeft: \"1px solid rgba( 255, 255, 255, 0.18 )\"\r\n        },\r\n        menuList: {\r\n            display: \"flex\",\r\n            '&:first-child': {\r\n                marginLeft: \"8px\"\r\n            },\r\n            '&:last-child': {\r\n                marginRight: \"8px\"\r\n            }\r\n        }\r\n    }),\r\n);\r\n\r\ninterface FilterMenuProps {\r\n    onSelect(filter: Filter): void\r\n}\r\n\r\nexport default function FilterMenu(props: FilterMenuProps) {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = React.useState(false);\r\n    const anchorRef = React.useRef<HTMLButtonElement>(null);\r\n\r\n    const handleToggle = () => {\r\n        setOpen((prevOpen) => !prevOpen);\r\n    };\r\n\r\n    const handleClose = (event: React.MouseEvent<EventTarget>) => {\r\n        if (anchorRef.current && anchorRef.current.contains(event.target as HTMLElement)) {\r\n            return;\r\n        }\r\n\r\n        setOpen(false);\r\n    };\r\n\r\n    function handleListKeyDown(event: React.KeyboardEvent) {\r\n        if (event.key === 'Tab') {\r\n            event.preventDefault();\r\n            setOpen(false);\r\n        }\r\n    }\r\n\r\n    const prevOpen = React.useRef(open);\r\n    React.useEffect(() => {\r\n        if (prevOpen.current === true && open === false) {\r\n            anchorRef.current!.focus();\r\n        }\r\n        prevOpen.current = open;\r\n    }, [open]);\r\n    return (\r\n        <div className={classes.filtersContainer}>\r\n            <IconButton\r\n                style={{}}\r\n                edge=\"end\"\r\n                className={classes.button}\r\n                ref={anchorRef}\r\n                onClick={handleToggle}\r\n                color=\"primary\">\r\n                <FilterIcon></FilterIcon>\r\n            </IconButton>\r\n            <Paper className={classes.paper}>\r\n                <ClickAwayListener onClickAway={handleClose}>\r\n                    <MenuList\r\n                        className={classes.menuList}\r\n                        autoFocusItem={open}\r\n                        id=\"menu-list-grow\"\r\n                        onKeyDown={handleListKeyDown}>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Grey); handleClose(e) }}>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <circle r=\"12\" cx=\"12\" cy=\"12\"\r\n                                    fill=\"#bebebe\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Red); handleClose(e) }}>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <circle r=\"12\" cx=\"12\" cy=\"12\"\r\n                                    fill=\"#FF0000\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Green); handleClose(e) }}>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <circle r=\"12\" cx=\"12\" cy=\"12\"\r\n                                    fill=\"#00FF00\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Blue); handleClose(e) }}>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <circle r=\"12\" cx=\"12\" cy=\"12\"\r\n                                    fill=\"#0000FF\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Brightness); handleClose(e) }}>\r\n                            <SvgIcon>\r\n                                <path\r\n                                    d=\"M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 \r\n                                                        15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 \r\n                                                        18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6z\"\r\n                                    fill=\"#FFFFFF\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                        <IconButton onClick={(e) => { props.onSelect(Filter.Blur); handleClose(e) }}>\r\n                            <SvgIcon>\r\n                                <path\r\n                                    d=\"M6 13c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 \r\n                                                        4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 \r\n                                                        .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-3 \r\n                                                        .5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 5c-.55 0-1 \r\n                                                        .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm15 5.5c.28 0 \r\n                                                        .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM14 7c.55 0 1-.45 \r\n                                                        1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-3.5c.28 0 \r\n                                                        .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm-11 10c-.28 \r\n                                                        0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 7c-.28 \r\n                                                        0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-17c.28 0 \r\n                                                        .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM10 7c.55 0 1-.45 \r\n                                                        1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 5.5c-.83 0-1.5.67-1.5 \r\n                                                        1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm8 .5c-.55 0-1 \r\n                                                        .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 \r\n                                                        1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 \r\n                                                        1-.45 1-1-.45-1-1-1zm0-4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 \r\n                                                        1-1-.45-1-1-1zm3 8.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM14 \r\n                                                        17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 3.5c-.28 \r\n                                                        0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm-4-12c-.83 \r\n                                                        0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0 \r\n                                                        8.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm4-4.5c-.83 \r\n                                                        0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-4c-.83 \r\n                                                        0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z\"\r\n                                    fill=\"#FFFFFF\" />\r\n                            </SvgIcon>\r\n                        </IconButton>\r\n                    </MenuList>\r\n                </ClickAwayListener>\r\n            </Paper>\r\n        </div >\r\n    );\r\n}","import { Editor } from \"../structures/Editor\";\r\nimport { Filter } from \"../structures/Filter\";\r\n\r\nexport function applyFilter(editor: Editor, filter: Filter) {\r\n\tconst newImageData = new ImageData(editor.canvas.width, editor.canvas.height);\r\n\tswitch (filter) {\r\n\t\tcase Filter.Red:\r\n\t\t\tapplyColorLevelFilter(editor.canvas, newImageData, [1, 0, 0, 1]);\r\n\t\t\tbreak;\r\n\t\tcase Filter.Green:\r\n\t\t\tapplyColorLevelFilter(editor.canvas, newImageData, [0, 1, 0, 1]);\r\n\t\t\tbreak\r\n\t\tcase Filter.Blue:\r\n\t\t\tapplyColorLevelFilter(editor.canvas, newImageData, [0, 0, 1, 1]);\r\n\t\t\tbreak\r\n\t\tcase Filter.Grey:\r\n\t\t\tapplyGreyFilter(editor.canvas, newImageData);\r\n\t\t\tbreak;\r\n\t\tcase Filter.Blur:\r\n\t\t\tapplyBlurFilter(editor, newImageData);\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tconst newEditor: Editor = {\r\n\t\t...editor,\r\n\t\tcanvas: newImageData,\r\n\t};\r\n\treturn newEditor;\r\n}\r\n\r\nfunction applyColorLevelFilter(src: ImageData, dst: ImageData, colorLevels: Array<number>) {\r\n\tfor (var i = 0; i < dst.height; i++) {\r\n\t\tfor (var j = 0; j < dst.width; j++) {\r\n\t\t\tvar dataIndex = (i * dst.width + j) * 4;\r\n\t\t\tfor (var k = 0; k < 4; k++) {\r\n\t\t\t\tdst.data[dataIndex + k] = src.data[dataIndex + k] * colorLevels[k];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction applyGreyFilter(src: ImageData, dst: ImageData) {\r\n\tfor (var i = 0; i < dst.height; i++) {\r\n\t\tfor (var j = 0; j < dst.width; j++) {\r\n\t\t\tvar dataIndex = (i * dst.width + j) * 4;\r\n\t\t\tvar mean = (src.data[dataIndex] + src.data[dataIndex + 1] + src.data[dataIndex + 2]) / 3;\r\n\t\t\tfor (var k = 0; k < 3; k++) {\r\n\t\t\t\tdst.data[dataIndex + k] = mean;\r\n\t\t\t}\r\n\t\t\tdst.data[dataIndex + 3] = src.data[dataIndex + 3];\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nexport function applyBrightnessFilter(editor: Editor, brightnessFactor: number): Editor {\r\n\tconst dst = new ImageData(editor.canvas.width, editor.canvas.height);\r\n\tconst src = editor.canvas;\r\n\tfor (var i = 0; i < dst.height; i++) {\r\n\t\tfor (var j = 0; j < dst.width; j++) {\r\n\t\t\tvar dataIndex = (i * dst.width + j) * 4;\r\n\t\t\tfor (var k = 0; k < 3; k++) {\r\n\t\t\t\tdst.data[dataIndex + k] = src.data[dataIndex + k] * brightnessFactor;\r\n\t\t\t}\r\n\t\t\tdst.data[dataIndex + 3] = src.data[dataIndex + 3];\r\n\t\t}\r\n\t}\r\n\tconst newEditor: Editor = {\r\n\t\tselectedObject: null,\r\n\t\tcanvas: dst,\r\n\t};\r\n\treturn newEditor;\r\n}\r\n\r\nexport function applyBlurFilter(editor: Editor, imageData: ImageData): Editor {\r\n\tconst data = editor.canvas;\r\n\tlet px = data.data;\r\n\tlet tmpPx = new Uint8ClampedArray(px.length);\r\n\ttmpPx.set(px);\r\n\r\n\tfor (var i = 0, len = px.length; i < len; i++) {\r\n\t\tif (i % 4 === 3) { continue; }\r\n\r\n\t\tpx[i] = (tmpPx[i]\r\n\t\t\t+ (tmpPx[i - 4] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i + 4] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i - 4 * data.width] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i + 4 * data.width] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i - 4 * data.width - 4] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i + 4 * data.width + 4] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i + 4 * data.width - 4] || tmpPx[i])\r\n\t\t\t+ (tmpPx[i - 4 * data.width + 4] || tmpPx[i])\r\n\t\t) / 9;\r\n\t};\r\n\timageData.data.set(px);\r\n\tconst newEditor: Editor = {\r\n\t\tselectedObject: null,\r\n\t\tcanvas: imageData,\r\n\t};\r\n\treturn newEditor;\r\n}\r\n","import { createStyles, Fab, makeStyles, Slider, SvgIcon, Theme } from '@material-ui/core';\r\nimport React, { useState } from 'react';\r\nimport styles from './BrightnessSlider.module.css';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        fab: {\r\n            marginLeft: \"24px\",\r\n        },\r\n        slider: {\r\n            width: \"350px\"\r\n        }\r\n    }),\r\n);\r\n\r\ninterface BrightnessSliderProps {\r\n    onChange(value: number): void,\r\n    onApply(value: number): void\r\n}\r\n\r\nexport default function BrightnessSlider({ onApply, onChange }: BrightnessSliderProps) {\r\n    const classes = useStyles();\r\n    const [value, setValue] = useState<number>(1)\r\n    return (\r\n        <div className={styles.BrightnessSliderContainer}>\r\n            <div className={styles.BrightnessSliderCenter}>\r\n                <Slider\r\n                    className={classes.slider}\r\n                    defaultValue={1}\r\n                    aria-labelledby=\"discrete-slider-custom\"\r\n                    step={0.01}\r\n                    min={0}\r\n                    max={4}\r\n                    valueLabelDisplay=\"auto\"\r\n                    onChange={(e, newValue) => {\r\n                        const num = newValue as number;\r\n                        setValue(num);\r\n                        onChange(num)\r\n                    }}\r\n                />\r\n                <Fab color=\"primary\" aria-label=\"add\"\r\n                    size=\"small\"\r\n                    className={classes.fab}\r\n                    onClick={(e) => onApply(value)}>\r\n                    <SvgIcon>\r\n                        <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\" />\r\n                    </SvgIcon>\r\n                </Fab>\r\n            </div>\r\n        </div>\r\n    );\r\n}","import { useState } from \"react\";\r\n\r\nexport function useTimeout() {\r\n    const [isTimerStarted, setTimerStarted] = useState<Boolean>(false);\r\n    return (ms: number, action: Function) => {\r\n        if (!isTimerStarted) {\r\n            setTimerStarted(true);\r\n            setTimeout(() => {\r\n                action();\r\n                setTimerStarted(false);\r\n            }, ms);\r\n        }\r\n    }\r\n}","import { Button } from '@material-ui/core';\r\nimport React from 'react';\r\nimport '../../index.css';\r\nimport ReactiveDialog from '../reactivedialog/ReactiveDialog';\r\n\r\ninterface PasteArtDialogProps {\r\n    isOpen: boolean,\r\n    onSaveSize: Function,\r\n    onChangeSize: Function,\r\n    onClose: Function\r\n}\r\n\r\nexport default function PasteArtDialog(props: PasteArtDialogProps) {\r\n    return (\r\n        <div>\r\n            <ReactiveDialog\r\n                title=\"Выберите действие\"\r\n                isOpen={props.isOpen}\r\n                onClose={() => props.onClose()}>\r\n                <Button autoFocus onClick={() => {\r\n                    props.onSaveSize();\r\n                    props.onClose()\r\n                }} color=\"secondary\">\r\n                    Сохранить размер полотна\r\n                    </Button>\r\n                <Button autoFocus onClick={() => {\r\n                    props.onChangeSize();\r\n                    props.onClose();\r\n                }} color=\"secondary\">\r\n                    Изменить размер полотна\r\n                    </Button>\r\n                <Button autoFocus\r\n                    onClick={() => props.onClose()}\r\n                    color=\"secondary\">\r\n                    Отмена\r\n                    </Button>\r\n            </ReactiveDialog>\r\n        </div >\r\n    );\r\n}\r\n","const UNDO_HISTORY = \"UNDO_HISTORY\";\r\nexport default UNDO_HISTORY;","import { Action } from \"redux\";\r\nimport UNDO_HISTORY from \"../actions/undoHistory\";\r\n\r\nfunction undoHistory(): Action {\r\n    return {\r\n        type: UNDO_HISTORY,\r\n    };\r\n}\r\n\r\nexport default undoHistory;","const REDO_HISTORY = \"REDO_HISTORY\";\r\nexport default REDO_HISTORY;","import { Action } from \"redux\";\r\nimport REDO_HISTORY from \"../actions/redoHistory\";\r\n\r\nfunction redoHistory(): Action {\r\n    return {\r\n        type: REDO_HISTORY,\r\n    };\r\n}\r\n\r\nexport default redoHistory;","const EDIT_CANVAS_SIZE = \"EDIT_CANVAS_SIZE\";\r\nexport default EDIT_CANVAS_SIZE;","import { Vector2 } from \"../../structures/Vector2\";\r\nimport EDIT_CANVAS_SIZE from \"../actions/editCanvasSize\";\r\nimport Vector2Action from \"../actions/types/Vector2Action\";\r\n\r\nfunction editCanvasSize(size: Vector2): Vector2Action {\r\n    return {\r\n        type: EDIT_CANVAS_SIZE,\r\n        value: size\r\n    };\r\n}\r\n\r\nexport default editCanvasSize;","const APPLY_FILTER = \"APPLY_FILTER\";\r\nexport default APPLY_FILTER;\r\n","import { Filter } from \"../../structures/Filter\";\r\nimport APPLY_FILTER from \"../actions/applyFilter\";\r\nimport FilterAction from \"../actions/types/FilterAction\";\r\n\r\nfunction applyFilter(filter: Filter): FilterAction {\r\n    return {\r\n        type: APPLY_FILTER,\r\n        value: filter\r\n    };\r\n}\r\n\r\nexport default applyFilter;","const CREATE_NEW_CANVAS = \"CREATE_NEW_CANVAS\";\r\nexport default CREATE_NEW_CANVAS;\r\n","import { Vector2 } from \"../../structures/Vector2\";\r\nimport CREATE_NEW_CANVAS from \"../actions/createNewCanvas\";\r\nimport Vector2Action from \"../actions/types/Vector2Action\";\r\n\r\nfunction createNewCanvas(size: Vector2): Vector2Action {\r\n    return {\r\n        type: CREATE_NEW_CANVAS,\r\n        value: size\r\n    };\r\n}\r\n\r\nexport default createNewCanvas;\r\n","import React from 'react';\r\nimport '../../index.css';\r\nimport {\r\n    Button, createStyles, FormControl,\r\n    FormControlLabel, FormLabel, IconButton,\r\n    makeStyles, Radio, RadioGroup, Slider, SvgIcon\r\n} from '@material-ui/core';\r\nimport { ExportFormat, formatToString } from '../../structures/ExportFormat';\r\nimport ReactiveDialog from '../reactivedialog/ReactiveDialog';\r\n\r\ninterface ExportDialogProps {\r\n    onApply(format: ExportFormat, quality: number): void\r\n}\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        slider: {\r\n            width: \"272px\",\r\n            margin: \"8px 8px 0 8px\",\r\n        },\r\n        quality_label: {\r\n            color: \"#FFFFFFa5\",\r\n            marginTop: \"16px\",\r\n            \"&.Mui-focused\": {\r\n                color: \"#FFFFFFa5\"\r\n            }\r\n        },\r\n        label: {\r\n            color: \"#FFFFFFa5\",\r\n            \"&.Mui-focused\": {\r\n                color: \"#FFFFFFa5\",\r\n            }\r\n        },\r\n        radioGroup: {\r\n            marginTop: \"8px\",\r\n            flexDirection: \"row\"\r\n        },\r\n        radio: {\r\n            color: \"#FFFFFF8a\"\r\n        }\r\n    }),\r\n);\r\n\r\nexport default function ExportDialog(props: ExportDialogProps) {\r\n    const classes = useStyles();\r\n    const [open, setOpen] = React.useState(false);\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const [format, setFormat] = React.useState<ExportFormat>(ExportFormat.JPEG);\r\n    const [quality, setQuality] = React.useState<number>(90);\r\n    const handleCloseAndCreate = () => {\r\n        handleClose();\r\n        props.onApply(format, quality);\r\n    };\r\n\r\n    const handleFormatChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const newFormat = (event.target as HTMLInputElement).value;\r\n        switch (newFormat) {\r\n            case \"jpeg\":\r\n                setFormat(ExportFormat.JPEG);\r\n                break;\r\n            case \"png\":\r\n                setFormat(ExportFormat.PNG);\r\n                break;\r\n            default:\r\n                throw new Error();\r\n        }\r\n    };\r\n\r\n    const handleQualityChange = (v: number) => {\r\n        setQuality(v);\r\n    };\r\n    return (\r\n        <div>\r\n            <IconButton\r\n                color=\"inherit\"\r\n                onClick={handleClickOpen}>\r\n                <SvgIcon>\r\n                    <path d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n                    <path d=\"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z\" />\r\n                </SvgIcon>\r\n            </IconButton>\r\n            <ReactiveDialog\r\n                isOpen={open}\r\n                onClose={() => handleClose()}\r\n                title=\"Сохранение\"\r\n                actions={() => {\r\n                    return (\r\n                        <Button autoFocus onClick={handleCloseAndCreate} color=\"secondary\">\r\n                            Сохранить\r\n                        </Button>\r\n                    );\r\n                }}>\r\n                <FormControl component=\"fieldset\">\r\n                    <FormLabel\r\n                        component=\"legend\"\r\n                        classes={{ root: classes.label }}>Формат</FormLabel>\r\n                    <RadioGroup\r\n                        className={classes.radioGroup}\r\n                        aria-orientation=\"horizontal\"\r\n                        aria-label=\"format\"\r\n                        name=\"format1\"\r\n                        value={formatToString(format)}\r\n                        onChange={handleFormatChange}>\r\n                        <FormControlLabel\r\n                            value=\"jpeg\"\r\n                            control={<Radio className={classes.radio} />}\r\n                            label=\"JPEG\" />\r\n                        <FormControlLabel\r\n                            value=\"png\"\r\n                            control={<Radio className={classes.radio} />}\r\n                            label=\"PNG\" />\r\n                    </RadioGroup>\r\n                    <FormLabel\r\n                        component=\"legend\"\r\n                        classes={{ root: classes.quality_label }}>Качество</FormLabel>\r\n                    <Slider\r\n                        className={classes.slider}\r\n                        defaultValue={90}\r\n                        aria-labelledby=\"discrete-slider-custom\"\r\n                        step={1}\r\n                        min={1}\r\n                        max={100}\r\n                        valueLabelDisplay=\"auto\"\r\n                        onChange={(e, newValue) => {\r\n                            const num = newValue as number;\r\n                            handleQualityChange(num);\r\n                        }}\r\n                    />\r\n                </FormControl>\r\n            </ReactiveDialog>\r\n        </div>\r\n    );\r\n}\r\n","export enum ImportType {\r\n    STORAGE, PEXELS, WEB_CAMERA\r\n}","import React from 'react';\r\nimport '../../index.css';\r\nimport {\r\n    IconButton, List, ListItem,\r\n    ListItemIcon, ListItemText, SvgIcon\r\n} from '@material-ui/core';\r\nimport { ImportType } from '../../structures/ImportType';\r\nimport ReactiveDialog from '../reactivedialog/ReactiveDialog';\r\n\r\ninterface ImportDialogProps {\r\n    onApply(importType: ImportType): void\r\n}\r\n\r\nexport default function ImportDialog(props: ImportDialogProps) {\r\n    const [open, setOpen] = React.useState(false);\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const handleClickOpenWithAction = (type: ImportType) => {\r\n        props.onApply(type);\r\n        handleClose();\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <IconButton\r\n                color=\"inherit\"\r\n                onClick={handleClickOpen}>\r\n                <SvgIcon viewBox=\"0 0 24 24\">\r\n                    <path d=\"M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z\" />\r\n                </SvgIcon>\r\n            </IconButton>\r\n            <ReactiveDialog\r\n                isOpen={open}\r\n                title=\"Вставка изображения\"\r\n                onClose={handleClose}\r\n                paperStyle={{\r\n                    width: \"320px\",\r\n                }}>\r\n                <List\r\n                    style={{\r\n                        color: \"#FFFFFFa5\"\r\n                    }}\r\n                    component=\"nav\" aria-label=\"\">\r\n                    <ListItem button onClick={() => handleClickOpenWithAction(ImportType.STORAGE)}>\r\n                        <ListItemIcon>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <path\r\n                                    fill=\"#F5F5F58a\"\r\n                                    d=\"M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12z\" />\r\n                            </SvgIcon>\r\n                        </ListItemIcon>\r\n                        <ListItemText primary=\"Компьютер\" />\r\n                    </ListItem>\r\n                    <ListItem button onClick={() => handleClickOpenWithAction(ImportType.PEXELS)}>\r\n                        <ListItemIcon>\r\n                            <SvgIcon viewBox=\"0 0 32 32\">\r\n                                <path d=\"M2 0h28a2 2 0 0 1 2 2v28a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2z\"\r\n                                    fill=\"#05A081\" />\r\n                                <path d=\"M13 21h3.863v-3.752h1.167a3.124 3.124 0 1 0 0-6.248H13v10zm5.863 2H11V9h7.03a5.124 5.124 0 0 1 .833 10.18V23z\"\r\n                                    fill=\"#fff\" />\r\n                            </SvgIcon>\r\n                        </ListItemIcon>\r\n                        <ListItemText primary=\"Сервис Pexels\" />\r\n                    </ListItem>\r\n                    <ListItem button onClick={() => handleClickOpenWithAction(ImportType.WEB_CAMERA)}>\r\n                        <ListItemIcon>\r\n                            <SvgIcon viewBox=\"0 0 24 24\">\r\n                                <path\r\n                                    fill=\"#F5F5F58a\"\r\n                                    d=\"M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 \r\n                                        2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35.06-.1zM21.54 \r\n                                        9c-.92-2.92-3.15-5.26-6-6.34L11.88 9h9.66zm.26 1h-7.49l.29.5 \r\n                                        4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2zM8.54 \r\n                                        12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 \r\n                                        2h7.49l-1.15-2zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 \r\n                                        15H2.46zm11.27 0l-3.9 6.76c.7.15 1.42.24 2.17.24 \r\n                                        2.4 0 4.6-.85 6.32-2.25l-3.66-6.35-.93 1.6z\" />\r\n                            </SvgIcon>\r\n                        </ListItemIcon>\r\n                        <ListItemText primary=\"Веб-камера\" />\r\n                    </ListItem>\r\n                </List>\r\n            </ReactiveDialog>\r\n        </div>\r\n    );\r\n}\r\n","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        searchContainer: {\r\n            width: \"100%\",\r\n            display: \"inline-flex\",\r\n            textAlign: \"center\"\r\n        },\r\n        searchField: {\r\n            width: \"40%\",\r\n            marginLeft: \"auto\",\r\n            borderRadius: \"24px\"\r\n        },\r\n        searchButtonWrapper: {\r\n            display: \"flex\",\r\n            width: \"fit-content\",\r\n            height: \"fit-content\",\r\n            margin: \"auto auto auto 8px\",\r\n            borderRadius: \"50%\",\r\n            backgroundColor: \"#cfcfcf21\",\r\n            boxShadow: \"4px 4px 16px #55555521, -4px -4px 16px #ffffff21\"\r\n        },\r\n        photoLineContainer: {\r\n            display: \"inline-block\",\r\n            position: \"relative\",\r\n            verticalAlign: \"top\",\r\n            width: \"24%\",\r\n        },\r\n        searchResultsWrapper: {\r\n            textAlign: \"start\",\r\n            margin: \"auto\",\r\n            width: \"69%\",\r\n            color: \"#FFFFFFd0\",\r\n            font: \"24px cursive\"\r\n        },\r\n        error: {\r\n            margin: \"16px auto 0 auto\",\r\n            width: \"fit-content\"\r\n        },\r\n        photo: {\r\n            cursor: \"pointer\",\r\n            margin: \"1px 0\"\r\n        },\r\n        progressBar: {\r\n            margin: \"16px 0 4px 0\",\r\n            color: \"#62ebff\"\r\n        }\r\n    }));\r\n\r\nexport default useStyles;","import { createClient, Photo, Photos } from \"pexels\";\r\nimport { PhotosWithTotalResults, ErrorResponse } from \"pexels\";\r\n\r\nconst client = createClient('563492ad6f917000010000011d7c21ba52c34f0abbefd675f9034e42');\r\nconst PHOTOS_AT_TIME = 9;\r\n\r\nfunction handleQuery(\r\n    response: Photos | PhotosWithTotalResults | ErrorResponse,\r\n    onQueryResult: (photos: Photo[]) => void, onError: () => void) {\r\n\r\n    if ((response as ErrorResponse).error === \"Rate limit exceeded\") {\r\n        onError();\r\n        return;\r\n    }\r\n    const res = response as PhotosWithTotalResults;\r\n    onQueryResult(res.photos);\r\n}\r\n\r\nexport function query(queryText: string, page: number,\r\n    onQueryResult: (photos: Photo[]) => void,\r\n    onError: () => void) {\r\n    if (queryText === \"\") {\r\n        client.photos.curated({\r\n            query: queryText,\r\n            per_page: PHOTOS_AT_TIME,\r\n            page: page,\r\n            locale: \"ru-RU\"\r\n        }).then(response => {\r\n            handleQuery(response, onQueryResult, onError);\r\n        })\r\n    } else {\r\n        client.photos.search({\r\n            query: queryText,\r\n            per_page: PHOTOS_AT_TIME,\r\n            page: page,\r\n            locale: \"ru-RU\"\r\n        }).then(response => {\r\n            handleQuery(response, onQueryResult, onError);\r\n        });\r\n    }\r\n}\r\n","import { CircularProgress, IconButton } from \"@material-ui/core\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport ReactiveDialog from \"../reactivedialog/ReactiveDialog\";\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport useStyles from \"./PexelsSearchDialogStyle\";\r\nimport ReactiveTextField from \"../reactivetextfield/ReactiveTextField\";\r\nimport { query } from \"./PexelsManager\";\r\nimport { Photo } from \"pexels\";\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport { useTimeout } from \"../timeout/Timeout\";\r\n\r\ninterface PexelsArtDialogProps {\r\n    isOpen: boolean,\r\n    focused: boolean,\r\n    onClose: Function,\r\n    onApply: (photo: Photo) => void\r\n}\r\n\r\nexport default function PexelsSearchDialog(props: PexelsArtDialogProps) {\r\n    const classes = useStyles();\r\n\r\n    const [isRateLimitExceeded, setRateLimitExceeded] = useState<boolean>(false);\r\n    const [isErrorShown, setErrorShown] = useState<boolean>(false);\r\n\r\n    const [page, setPage] = useState<number>(1);\r\n    const [queryText, setQueryText] = useState<string>(\"\");\r\n    const [loadedPhotos, setLoadedPhotos] = useState<Photo[]>([]);\r\n\r\n    const [isLoading, setLoading] = useState<boolean>(false);\r\n\r\n    const timeout = useTimeout();\r\n\r\n    const handleSearch = (page: number, loadedPhotos: Photo[]) => {\r\n        setLoading(true);\r\n        query(queryText, page, (photos) => {\r\n            setLoading(false);\r\n            if (isRateLimitExceeded) {\r\n                setRateLimitExceeded(false);\r\n            }\r\n            setLoadedPhotos(loadedPhotos.concat(photos));\r\n        }, () => {\r\n            setLoading(false);\r\n            console.log(\"Превышен лимит запросов\");\r\n            if (!isRateLimitExceeded) {\r\n                setRateLimitExceeded(true);\r\n            }\r\n            setErrorShown(true);\r\n            timeout(3000, () => {\r\n                setErrorShown(false)\r\n            });\r\n        });\r\n        setPage(page + 1);\r\n    }\r\n\r\n    const handleNewSearch = () => {\r\n        setPage(1);\r\n        setLoadedPhotos([]);\r\n        handleSearch(1, []);\r\n    }\r\n\r\n    const handleImageClick = (photo: Photo) => {\r\n        props.onApply(photo);\r\n    }\r\n\r\n    const handleClose = () => {\r\n        props.onClose();\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!props.focused || !props.isOpen) {\r\n            return;\r\n        }\r\n        const listener = (e: KeyboardEvent) => {\r\n            if (e.key === \"Enter\") {\r\n                handleNewSearch();\r\n            }\r\n        };\r\n        window.addEventListener(\"keydown\", listener);\r\n        return () => {\r\n            window.removeEventListener(\"keydown\", listener);\r\n        }\r\n    });\r\n\r\n    const [alreadyScrolled, setArleadyScrolled] = useState<boolean>(false);\r\n    return (\r\n        <ReactiveDialog\r\n            title=\"Поиск картинок в Pexels\"\r\n            paperStyle={{\r\n                width: \"72%\",\r\n                maxWidth: \"72%\"\r\n            }}\r\n            contentStyle={{\r\n                textAlign: \"center\"\r\n            }}\r\n            isOpen={props.isOpen}\r\n            onScroll={(e) => {\r\n                const div = e.currentTarget;\r\n                if (!alreadyScrolled && div.offsetHeight + div.scrollTop >= div.scrollHeight) {\r\n                    setArleadyScrolled(true)\r\n                    handleSearch(page, loadedPhotos);\r\n                } else if (alreadyScrolled) {\r\n                    setArleadyScrolled(false)\r\n                }\r\n            }}\r\n            onClose={() => handleClose()}>\r\n            <div className={classes.searchContainer}>\r\n                <ReactiveTextField\r\n                    className={classes.searchField}\r\n                    text={queryText}\r\n                    type=\"text\"\r\n                    label=\"Поиск\"\r\n                    autocomplete=\"off\"\r\n                    onChange={(e) => {\r\n                        setQueryText(e.target.value)\r\n                    }} />\r\n                <div className={classes.searchButtonWrapper}>\r\n                    <IconButton\r\n                        type=\"submit\"\r\n                        aria-label=\"search\"\r\n                        onClick={() => handleNewSearch()}>\r\n                        <SearchIcon\r\n                            htmlColor=\"#FFFFFF8a\" />\r\n                    </IconButton>\r\n                </div>\r\n            </div>\r\n\r\n            {(loadedPhotos.length > 0 && !isRateLimitExceeded) &&\r\n                <div className={classes.searchResultsWrapper}>\r\n                    <h5>Результаты запроса</h5>\r\n                </div>}\r\n            {isErrorShown &&\r\n                <Alert\r\n                    className={classes.error}\r\n                    variant=\"filled\" severity=\"error\">\r\n                    Достигнут лимит запросов. Подождите некоторое время\r\n                </Alert>}\r\n            <div>\r\n                <div className={classes.photoLineContainer}>\r\n                    {loadedPhotos.map((photo, index) => {\r\n                        return getHorizontalPosition(loadedPhotos, index) === 0 &&\r\n                            <img\r\n                                className={classes.photo}\r\n                                onClick={() => handleImageClick(photo)}\r\n                                key={photo + \"\" + index}\r\n                                src={photo.src.medium}\r\n                                alt={\"Автор: \" + photo.photographer}\r\n                                width=\"98%\" />\r\n                    })}\r\n                </div>\r\n\r\n                <div className={classes.photoLineContainer}>\r\n                    {loadedPhotos.map((photo, index) => {\r\n                        return (getHorizontalPosition(loadedPhotos, index) === 1 &&\r\n                            <img\r\n                                className={classes.photo}\r\n                                onClick={() => handleImageClick(photo)}\r\n                                key={photo.id + \"\" + index}\r\n                                src={photo.src.medium}\r\n                                alt={\"Автор: \" + photo.photographer}\r\n                                width=\"98%\" />)\r\n                    })}\r\n                </div>\r\n\r\n                <div className={classes.photoLineContainer}>\r\n                    {loadedPhotos.map((photo, index) => {\r\n                        return (getHorizontalPosition(loadedPhotos, index) === 2 &&\r\n                            <img\r\n                                className={classes.photo}\r\n                                onClick={() => handleImageClick(photo)}\r\n                                key={photo.id + \"\" + index}\r\n                                src={photo.src.medium}\r\n                                alt={\"Автор: \" + photo.photographer}\r\n                                width=\"98%\" />)\r\n                    })}\r\n                </div>\r\n            </div>\r\n            <CircularProgress\r\n                className={classes.progressBar}\r\n                style={{\r\n                    visibility: isLoading ? \"visible\" : \"hidden\"\r\n                }} />\r\n        </ReactiveDialog>\r\n    );\r\n}\r\n\r\nfunction getHorizontalPosition(photos: Photo[], index: number): number {\r\n    const startBlockIndex = index - index % 3;\r\n    const photo1 = photos[startBlockIndex].height / photos[startBlockIndex].width;\r\n    const photo2 = (startBlockIndex + 1) < photos.length ? photos[startBlockIndex + 1].height / photos[startBlockIndex + 1].width : 0;\r\n    const photo3 = (startBlockIndex + 2) < photos.length ? photos[startBlockIndex + 2].height / photos[startBlockIndex + 2].width : 0;\r\n    const sortedIndices = [3];\r\n    if (photo1 <= photo2) {\r\n        if (photo2 <= photo3) {\r\n            sortedIndices[0] = 0;\r\n            sortedIndices[1] = 1;\r\n            sortedIndices[2] = 2;\r\n        } else {\r\n            if (photo3 < photo1) {\r\n                sortedIndices[0] = 2;\r\n                sortedIndices[1] = 0;\r\n            } else {\r\n                sortedIndices[0] = 0;\r\n                sortedIndices[1] = 2;\r\n            }\r\n            sortedIndices[2] = 1;\r\n        }\r\n    } else {\r\n        if (photo1 <= photo3) {\r\n            sortedIndices[0] = 1;\r\n            sortedIndices[1] = 0;\r\n            sortedIndices[2] = 2;\r\n        } else {\r\n            if (photo3 < photo2) {\r\n                sortedIndices[0] = 2;\r\n                sortedIndices[1] = 1;\r\n            } else {\r\n                sortedIndices[0] = 1;\r\n                sortedIndices[1] = 2;\r\n            }\r\n            sortedIndices[2] = 0;\r\n        }\r\n    }\r\n    const newIndex = (index - (-Math.floor(index / 3 + 1) % 3) + 3) % 3;\r\n    switch (sortedIndices[newIndex]) {\r\n        case 1:\r\n            if (photo2 === 0) {\r\n                return -1;\r\n            }\r\n            break;\r\n        case 2:\r\n            if (photo2 === 0) {\r\n                return -1;\r\n            }\r\n            break;\r\n    }\r\n    return sortedIndices[newIndex];\r\n}","import { createStyles, makeStyles } from \"@material-ui/core\";\r\n\r\nconst useStyles = makeStyles(() =>\r\n    createStyles({\r\n        searchField: {\r\n            margin: \"0 8px\"\r\n        },\r\n        searchButtonWrapper: {\r\n            display: \"flex\",\r\n            width: \"fit-content\",\r\n            height: \"fit-content\",\r\n            margin: \"auto\",\r\n            borderRadius: \"50%\",\r\n            backgroundColor: \"#cfcfcf21\",\r\n            boxShadow: \"4px 4px 16px #55555521, -4px -4px 16px #ffffff21\"\r\n        }\r\n    }));\r\n\r\nexport default useStyles;","import { Button, IconButton, SvgIcon } from '@material-ui/core';\r\nimport { Photo } from 'pexels';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Vector2 } from '../../../structures/Vector2';\r\nimport ReactiveDialog from '../../reactivedialog/ReactiveDialog';\r\nimport ReactiveTextField from '../../reactivetextfield/ReactiveTextField';\r\nimport useStyles from './PexelsSelectSizeDialogStyle';\r\n\r\ninterface PexelsSelectSizeDialogProps {\r\n    photo: Photo | null,\r\n    isOpen: boolean,\r\n    onClose: () => void,\r\n    onResult: (size: Vector2, url: string) => void,\r\n}\r\n\r\nexport default function PexelsSelectSizeDialog(props: PexelsSelectSizeDialogProps) {\r\n    const classes = useStyles();\r\n    const [canApply, setCanApply] = useState(true);\r\n    const [size, setSize] = useState<Vector2>({ x: 0, y: 0 });\r\n    const handleClick = () => {\r\n        if (canApply) {\r\n            props.onClose();\r\n            if (props.photo === null) {\r\n                throw new Error(\"Photo is null\");\r\n            }\r\n            props.onResult(size, props.photo.src.original);\r\n        }\r\n    }\r\n\r\n    const handleClose = () =>{\r\n        setCanApply(true);\r\n        props.onClose();\r\n    }\r\n \r\n    useEffect(() => {\r\n        if (!props.isOpen && size.x !== 0) {\r\n            setSize({ x: 0, y: 0 });\r\n        } else if (props.photo !== null && size.x === 0) {\r\n            setSize({\r\n                x: props.photo.width,\r\n                y: props.photo.height\r\n            });\r\n        }\r\n    }, [props, size]);\r\n    return (\r\n        <ReactiveDialog\r\n            title=\"Выберите размер картинки\"\r\n            paperStyle={{\r\n                width: \"fit-content\",\r\n            }}\r\n            contentStyle={{\r\n                display: \"inline-flex\"\r\n            }}\r\n            isOpen={props.isOpen}\r\n            onClose={handleClose}\r\n            actions={() => {\r\n                return (\r\n                    <Button autoFocus onClick={() => handleClick()} color=\"secondary\">\r\n                        Далее\r\n                    </Button>\r\n                );\r\n            }}>\r\n            <ReactiveTextField\r\n                className={classes.searchField}\r\n                text={canApply ? size.x.toString() : \"\"}\r\n                type=\"number\"\r\n                label=\"Ширина\"\r\n                min=\"0\"\r\n                onChange={(e) => {\r\n                    setCanApply(e.target.value !== \"\");\r\n                    if (e.target.value !== \"\") {\r\n                        const newSize = {\r\n                            x: Math.abs(parseInt(e.target.value)),\r\n                            y: 0\r\n                        }\r\n                        if (props.photo !== null) {\r\n                            newSize.y = Math.round(newSize.x * props.photo.height / props.photo.width);\r\n                        }\r\n                        setSize(newSize);\r\n                    }\r\n                }} />\r\n\r\n            <div className={classes.searchButtonWrapper}>\r\n                <IconButton\r\n                    disabled\r\n                    type=\"submit\"\r\n                    aria-label=\"search\">\r\n                    <SvgIcon viewBox=\"0 0 24 24\">\r\n                        <path d=\"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 \r\n                                5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 \r\n                                1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z\"\r\n                            fill=\"#FFFFFF8a\" />\r\n                    </SvgIcon>\r\n                </IconButton>\r\n            </div>\r\n\r\n            <ReactiveTextField\r\n                className={classes.searchField}\r\n                text={canApply ? size.y.toString() : \"\"}\r\n                type=\"number\"\r\n                label=\"Высота\"\r\n                min=\"0\"\r\n                onChange={(e) => {\r\n                    setCanApply(e.target.value !== \"\");\r\n                    if (e.target.value !== \"\") {\r\n                        const newSize = {\r\n                            x: 0,\r\n                            y: Math.abs(parseInt(e.target.value))\r\n                        }\r\n                        if (props.photo !== null) {\r\n                            newSize.x = Math.round(newSize.y * props.photo.width / props.photo.height);\r\n                        }\r\n                        setSize(newSize);\r\n                    }\r\n                }} />\r\n        </ReactiveDialog>\r\n    );\r\n}","import { Box, LinearProgress, LinearProgressProps, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\nimport ReactiveDialog from '../../reactivedialog/ReactiveDialog';\r\n\r\nfunction LinearProgressWithLabel(props: LinearProgressProps & { value: number }) {\r\n    return (\r\n        <Box display=\"flex\" alignItems=\"center\">\r\n            <Box width=\"100%\" mr={1}>\r\n                <LinearProgress variant=\"determinate\" {...props} />\r\n            </Box>\r\n            <Box minWidth={35}>\r\n                <Typography variant=\"body2\" color=\"textSecondary\">{`${Math.round(\r\n                    props.value,\r\n                )}%`}</Typography>\r\n            </Box>\r\n        </Box>\r\n    );\r\n}\r\n\r\ninterface ProgressDialogProps {\r\n    progress: number;\r\n    isOpen: boolean;\r\n}\r\n\r\nexport default function ProgressDialog({ progress, isOpen }: ProgressDialogProps) {\r\n    return (\r\n        <ReactiveDialog\r\n            paperStyle={{ width: \"400px\" }}\r\n            title=\"Загрузка...\"\r\n            isOpen={isOpen}\r\n            onClose={() => { }}>\r\n            <LinearProgressWithLabel value={progress} />\r\n        </ReactiveDialog>\r\n    );\r\n}","import { Button } from '@material-ui/core';\r\nimport React, { useState } from 'react';\r\nimport ReactiveDialog from \"../reactivedialog/ReactiveDialog\";\r\nimport { openWebCamera, takeSnapshot } from './WebCameraHelper';\r\nimport styles from \"./WebCameraDialog.module.css\"\r\nimport { Art } from '../../structures/Art';\r\nimport { Types } from '../../structures/Type';\r\n\r\ninterface WebCameraDialogProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onResult: (art: Art) => void;\r\n}\r\n\r\nexport default function WebCameraDialog(props: WebCameraDialogProps) {\r\n    const [video, setVideo] = useState<HTMLVideoElement | null>(null);\r\n    const [streaming, setStreaming] = useState<boolean>(false);\r\n    const [photo, setPhoto] = useState<ImageData | null>(null);\r\n\r\n    const handleResult = (photo: ImageData) => {\r\n        props.onResult({\r\n            type: Types.Art,\r\n            image: photo,\r\n            position: { x: 0, y: 0 },\r\n            size: { x: photo.width, y: photo.height },\r\n            rotation: 0\r\n        });\r\n        handleClose();\r\n    }\r\n\r\n    const handleSnapshot = () => {\r\n        if (photo !== null) {\r\n            setPhoto(null);\r\n        } else if (video !== null) {\r\n            setStreaming(false);\r\n            setPhoto(takeSnapshot(video));\r\n        }\r\n    }\r\n\r\n    const handleClose = () => {\r\n        props.onClose();\r\n        setStreaming(false);\r\n    }\r\n\r\n    const handleVideoLoaded = (video: HTMLVideoElement) => {\r\n        if (props.isOpen && !streaming) {\r\n            openWebCamera(video);\r\n            setStreaming(true);\r\n            setVideo(video);\r\n        }\r\n    }\r\n    return (\r\n        <ReactiveDialog\r\n            paperStyle={{ width: \"fit-content\", maxWidth: \"fit-content\" }}\r\n            isOpen={props.isOpen}\r\n            title=\"Веб-камера\"\r\n            onClose={handleClose}\r\n            actions={() => {\r\n                return (\r\n                    <div>\r\n                        <Button autoFocus onClick={() => handleSnapshot()} color=\"secondary\">\r\n                            {photo === null ? \"Захват\" : \"Повтор\"}\r\n                        </Button>\r\n                        <Button autoFocus\r\n                            onClick={() => {\r\n                                if (photo !== null) handleResult(photo)\r\n                            }}\r\n                            color=\"secondary\">\r\n                            Далее\r\n                        </Button>\r\n                    </div>\r\n                );\r\n            }}>\r\n            {photo === null &&\r\n                <video\r\n                    className={styles.mediaContainer}\r\n                    autoPlay\r\n                    ref={(video) => {\r\n                        if (video !== null) {\r\n                            handleVideoLoaded(video);\r\n                        }\r\n                    }} />}\r\n            {photo !== null &&\r\n                <canvas\r\n                    className={styles.mediaContainer}\r\n                    ref={(canvas) => {\r\n                        if (canvas !== null) {\r\n                            const ctx = canvas.getContext(\"2d\");\r\n                            if (ctx !== null) {\r\n                                ctx.putImageData(photo, 0, 0)\r\n                            }\r\n                        }\r\n                    }}\r\n                    width={photo.width}\r\n                    height={photo.height} />}\r\n        </ReactiveDialog>\r\n    )\r\n}","\r\nexport function openWebCamera(video: HTMLVideoElement) {\r\n    navigator.mediaDevices.getUserMedia({\r\n        video: true,\r\n        audio: false\r\n    }).then(function (stream) {\r\n        video.srcObject = stream;\r\n        video.play();\r\n    }).catch(function (err) {\r\n        console.log(\"An error occurred: \" + err);\r\n    });;\r\n}\r\n\r\nexport function takeSnapshot(video: HTMLVideoElement): ImageData {\r\n    const width = video.videoWidth;\r\n    const height = video.videoHeight;\r\n    const htmlCanvas = document.createElement(\"canvas\");\r\n    htmlCanvas.width = width;\r\n    htmlCanvas.height = height;\r\n    const ctx = htmlCanvas.getContext(\"2d\");\r\n    if (ctx === null) {\r\n        throw new Error();\r\n    }\r\n    ctx.drawImage(video, 0, 0, width, height);\r\n    return ctx.getImageData(0, 0, width, height);\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport styles from './App.module.css';\r\nimport SelectSizePopup from './components/selectsizepopup/SelectSizeDialog';\r\nimport Canvas from './components/canvas/Canvas';\r\nimport ObjectParams from './objectparams/ObjectParams';\r\nimport { exportObject, importImageUrl, importObject, scaleImageData } from './helper/CanvasHelper';\r\nimport './structures/Vector2';\r\nimport Tools, { ToolType } from './components/tool/Tools';\r\nimport { Editor } from './structures/Editor';\r\nimport { AppBar, Box, SvgIcon, Toolbar, Typography } from '@material-ui/core';\r\nimport { createStyles, makeStyles, Theme, ThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport { createMuiTheme } from '@material-ui/core/styles';\r\nimport { Art } from './structures/Art';\r\nimport FilterMenu from './components/filtermenu/FilterMenu';\r\nimport { applyBrightnessFilter } from './helper/FilterHelper';\r\nimport { Filter } from './structures/Filter';\r\nimport BrightnessSlider from './components/brightslider/BrightnessSlider';\r\nimport { useTimeout } from './components/timeout/Timeout';\r\nimport PasteArtDialog from './components/pasteartdialog/PasteArtDialog';\r\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\r\nimport { ViewModel } from './viewmodel/ViewModel';\r\nimport undoHistory from './store/actionCreators/undoHistory';\r\nimport redoHistory from './store/actionCreators/redoHistory';\r\nimport actionReplaceSelectedObject from './store/actionCreators/actionReplaceSelectedObject';\r\nimport setEditor from './store/actionCreators/setEditor';\r\nimport pushToHistory from './store/actionCreators/pushToHistory';\r\nimport editCanvasSize from './store/actionCreators/editCanvasSize';\r\nimport applyFilter from './store/actionCreators/applyFilter';\r\nimport createNewCanvas from './store/actionCreators/createNewCanvas';\r\nimport { replaceSelectedObject } from './helper/EditorHelper';\r\nimport { cyan, purple, red } from '@material-ui/core/colors';\r\nimport ExportDialog from './components/exportdialog/ExportDialog';\r\nimport ImportDialog from './components/importdialog/ImportDialog';\r\nimport { ImportType } from './structures/ImportType';\r\nimport PexelsSearchDialog from './components/pexelsartdialog/PexelsSearchDialog';\r\nimport { Photo } from 'pexels';\r\nimport PexelsSelectSizeDialog from './components/pexelsartdialog/size/PexelsSelectSizeDialog';\r\nimport ProgressDialog from './components/pexelsartdialog/progress/ProgressDialog';\r\nimport WebCameraDialog from './components/webcameradialog/WebCameraDialog';\r\n\r\nconst theme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            main: purple[\"A700\"],\r\n        },\r\n        secondary: {\r\n            main: cyan[\"A200\"] + \"8a\",\r\n            light: red[\"A400\"],\r\n        },\r\n        text: {\r\n            secondary: \"#FFFFFF\"\r\n        }\r\n    }\r\n});\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            flexGrow: 1,\r\n            width: \"100%\"\r\n        },\r\n        menuButton: {\r\n            marginRight: theme.spacing(2),\r\n        },\r\n        title: {\r\n            flexGrow: 1,\r\n            textAlign: \"start\",\r\n            fontFamily: \"cursive\"\r\n        }\r\n    }),\r\n);\r\n\r\nfunction App() {\r\n    const classes = useStyles();\r\n    const timeout = useTimeout();\r\n    const dispatch = useDispatch();\r\n\r\n    const editor: Editor = useSelector(\r\n        (state: ViewModel) => state.editor,\r\n        shallowEqual\r\n    )\r\n    const currentTool: ToolType = useSelector(\r\n        (state: ViewModel) => state.currentTool\r\n    )\r\n\r\n    const [isBrightSliderShown, setBrightSliderShown] = useState(false);\r\n    const [tempEditor, setTempEditor] = useState<Editor | null>(null);\r\n    const [isPasteArtDialogOpen, setPasteArtDialogOpen] = useState(false);\r\n    const [isPexelsArtDialogOpen, setPexelsArtDialogOpen] = useState(false);\r\n    const [pasteArt, setPasteArt] = useState<Art | null>(null);\r\n\r\n    const [pexelsPhoto, setPexelsPhoto] = useState<Photo | null>(null);\r\n    const [pexelsPhotoProgress, setPexelsPhotoProgress] = useState<number>(0);\r\n\r\n    const [isWebCameraDialogOpen, setWebCameraDialogOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const listener = (e: KeyboardEvent) => {\r\n            if (e.ctrlKey) {\r\n                if (e.code === \"KeyZ\") {\r\n                    dispatch(undoHistory());\r\n                } else if (e.code === \"KeyY\") {\r\n                    dispatch(redoHistory());\r\n                }\r\n            }\r\n        }\r\n        window.addEventListener(\"keydown\", listener)\r\n        return () => {\r\n            window.removeEventListener(\"keydown\", listener);\r\n        }\r\n    })\r\n    return (\r\n        <div className={styles.App}\r\n            id=\"App\">\r\n            <ThemeProvider theme={theme}>\r\n                <Canvas\r\n                    focused={!isPasteArtDialogOpen && !isPexelsArtDialogOpen && pexelsPhoto === null}\r\n                ></Canvas>\r\n                <Box position=\"fixed\" className={classes.root}>\r\n                    <AppBar position=\"static\" style={{ background: \"#6200ea\" }}>\r\n                        <Toolbar>\r\n                            <Typography variant=\"h6\" color=\"inherit\" className={classes.title}>\r\n                                Reactive Photo Editor\r\n                            </Typography>\r\n                            <SelectSizePopup\r\n                                applyText=\"Создать\"\r\n                                action={createNewCanvas({ x: 0, y: 0 })}>\r\n                                <SvgIcon>\r\n                                    <path d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n                                    <path d=\"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\" />\r\n                                </SvgIcon>\r\n                            </SelectSizePopup>\r\n                            <SelectSizePopup\r\n                                applyText=\"Изменить\"\r\n                                action={editCanvasSize({ x: 0, y: 0 })}>\r\n                                <SvgIcon>\r\n                                    <path d=\"M0 0h24v24H0z\" fill=\"none\" />\r\n                                    <path d=\"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\" />\r\n                                </SvgIcon>\r\n                            </SelectSizePopup>\r\n                            <ImportDialog\r\n                                onApply={(type) => {\r\n                                    switch (type) {\r\n                                        case ImportType.STORAGE:\r\n                                            importObject((art: Art) => {\r\n                                                setPasteArt(art);\r\n                                                setPasteArtDialogOpen(true);\r\n                                            })\r\n                                            break;\r\n                                        case ImportType.PEXELS:\r\n                                            setPexelsArtDialogOpen(true);\r\n                                            break;\r\n                                        case ImportType.WEB_CAMERA:\r\n                                            setWebCameraDialogOpen(true);\r\n                                            break;\r\n                                    }\r\n                                }}\r\n                            ></ImportDialog>\r\n                            <ExportDialog\r\n                                onApply={(format, quality) => {\r\n                                    const newEditor = replaceSelectedObject(editor, null);\r\n                                    exportObject(newEditor.canvas, format, quality);\r\n                                }}></ExportDialog>\r\n                            <PasteArtDialog\r\n                                isOpen={isPasteArtDialogOpen}\r\n                                onSaveSize={() => {\r\n                                    const isPushToHistory = editor.selectedObject !== null;\r\n                                    const historyCanvas = editor.canvas;\r\n                                    dispatch(actionReplaceSelectedObject(pasteArt));\r\n                                    if (isPushToHistory) {\r\n                                        dispatch(pushToHistory(historyCanvas));\r\n                                    }\r\n                                }}\r\n                                onChangeSize={() => {\r\n                                    const isPushToHistory = editor.selectedObject !== null;\r\n                                    const historyCanvas = editor.canvas;\r\n                                    if (pasteArt === null) {\r\n                                        throw new Error();\r\n                                    }\r\n                                    dispatch(editCanvasSize(pasteArt.size));\r\n                                    dispatch(actionReplaceSelectedObject(pasteArt));\r\n                                    if (isPushToHistory) {\r\n                                        dispatch(pushToHistory(historyCanvas));\r\n                                    }\r\n                                }}\r\n                                onClose={() => {\r\n                                    setPasteArtDialogOpen(false);\r\n                                    setPasteArt(null);\r\n                                }}></PasteArtDialog>\r\n                            <PexelsSearchDialog\r\n                                focused={pexelsPhoto === null}\r\n                                isOpen={isPexelsArtDialogOpen}\r\n                                onClose={() => {\r\n                                    setPexelsArtDialogOpen(false);\r\n                                }}\r\n                                onApply={(photo) => {\r\n                                    setPexelsPhoto(photo);\r\n                                }}></PexelsSearchDialog>\r\n                            <PexelsSelectSizeDialog\r\n                                photo={pexelsPhoto}\r\n                                isOpen={pexelsPhoto !== null}\r\n                                onResult={(size, url) => {\r\n                                    if (pexelsPhoto !== null) {\r\n                                        importImageUrl(url, (art) => {\r\n                                            art.image = scaleImageData(art.image, size);\r\n                                            art.size = size;\r\n                                            setPexelsArtDialogOpen(false);\r\n                                            setPasteArt(art);\r\n                                            setPasteArtDialogOpen(true);\r\n                                        }, (percentage) => {\r\n                                            setPexelsPhotoProgress(percentage);\r\n                                        });\r\n                                    }\r\n                                    setPexelsPhoto(null);\r\n                                }}\r\n                                onClose={() => { setPexelsPhoto(null) }} />\r\n                            <ProgressDialog\r\n                                isOpen={pexelsPhotoProgress > 0 && pexelsPhotoProgress < 100}\r\n                                progress={pexelsPhotoProgress} />\r\n                            <WebCameraDialog\r\n                                isOpen={isWebCameraDialogOpen}\r\n                                onClose={() => { setWebCameraDialogOpen(false) }}\r\n                                onResult={(art) => {\r\n                                    setPasteArt(art);\r\n                                    setPasteArtDialogOpen(true);\r\n                                }} />\r\n                        </Toolbar>\r\n                    </AppBar>\r\n                    <Tools onSelected={() => {\r\n                        if (isBrightSliderShown) {\r\n                            if (tempEditor === null) {\r\n                                throw new Error();\r\n                            }\r\n                            dispatch(setEditor(tempEditor))\r\n                            setBrightSliderShown(false);\r\n                        }\r\n                    }}></Tools>\r\n                    <FilterMenu\r\n                        onSelect={(filter) => {\r\n                            let temp = editor;\r\n                            if (editor.selectedObject != null) {\r\n                                const newEditor = replaceSelectedObject(editor, null);\r\n                                dispatch(pushToHistory(newEditor.canvas));\r\n                                dispatch(setEditor(newEditor));\r\n                                temp = newEditor;\r\n                            }\r\n                            if (filter !== Filter.Brightness) {\r\n                                dispatch(applyFilter(filter));\r\n                            } else {\r\n                                setTempEditor(temp);\r\n                                setBrightSliderShown(true);\r\n                            }\r\n                        }}></FilterMenu>\r\n                </Box>\r\n                {currentTool !== ToolType.Area && <ObjectParams />}\r\n                {isBrightSliderShown\r\n                    && <BrightnessSlider\r\n                        onChange={(value) => {\r\n                            if (tempEditor === null) {\r\n                                return;\r\n                            }\r\n                            timeout(16, () => {\r\n                                const brightEditor = applyBrightnessFilter(tempEditor, value);\r\n                                dispatch(setEditor(brightEditor))\r\n                            });\r\n                        }}\r\n                        onApply={(value) => {\r\n                            setBrightSliderShown(false);\r\n                            if (value === 1) {\r\n                                return;\r\n                            }\r\n                            const newEditor = replaceSelectedObject(editor, null);\r\n                            dispatch(pushToHistory(newEditor.canvas));\r\n                            dispatch(setEditor(newEditor));\r\n                        }}\r\n                    ></BrightnessSlider>}\r\n            </ThemeProvider>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);  \n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n}\n\nexport default reportWebVitals;\n","import { ToolType } from \"../components/tool/Tools\";\r\nimport { createNewCanvas } from \"../helper/CanvasHelper\";\r\nimport { toRGBAColor } from \"../helper/ColorHelper\";\r\nimport { ViewModel } from \"../viewmodel/ViewModel\";\r\n\r\nconst defaultEditor = createNewCanvas(\r\n    {\r\n        selectedObject: null,\r\n        canvas: new ImageData(1, 1)\r\n    },\r\n    { x: 800, y: 600 });\r\n\r\nconst initialViewModel: ViewModel = {\r\n    editor: defaultEditor,\r\n    imageHistory: {\r\n        history: [defaultEditor.canvas],\r\n        currentHistoryPosition: 0\r\n    },\r\n    currentTool: ToolType.Rectangle,\r\n    objectState: {\r\n        fillColor: toRGBAColor(\"#00CCCCFF\"),\r\n        strokeColor: toRGBAColor(\"#CC0000FF\"),\r\n        strokeWidth: 4,\r\n        text: \"\",\r\n        textSize: 24,\r\n        textColor: toRGBAColor(\"#424242FF\"),\r\n        fontName: \"Arial\",\r\n        padding: 0,\r\n    },\r\n    canvasModel: {\r\n        isCanvasDown: false,\r\n        start: {x: 0, y: 0},\r\n        tempObject: null,\r\n        isMiddleMouseDown: false,\r\n        middleMouseStart: {x: 0, y: 0},\r\n        tempPoint: null,\r\n        scale: 1,\r\n        canvasPosition: {\r\n            x: (window.innerWidth - defaultEditor.canvas.width) / 2,\r\n            y: (window.innerHeight - defaultEditor.canvas.height) / 2\r\n        }\r\n    }\r\n}\r\n\r\nexport default initialViewModel;\r\n","import { Editor } from \"../structures/Editor\";\r\nimport { ImageHistory } from \"../structures/ImageHistory\";\r\nimport { ViewModel } from \"../viewmodel/ViewModel\";\r\nimport { copyImageData } from \"./CanvasHelper\";\r\nimport { replaceSelectedObject } from \"./EditorHelper\";\r\n\r\nexport function pushToHistory(imageHistory: ImageHistory, canvas: ImageData): ImageHistory {\r\n    const newArrayHistory = imageHistory.history.flatMap((imageData) => copyImageData(imageData));\r\n\r\n    const newHistory = {\r\n        history: newArrayHistory,\r\n        currentHistoryPosition: imageHistory.currentHistoryPosition\r\n    }\r\n    while (newHistory.currentHistoryPosition < newHistory.history.length - 1) {\r\n        newHistory.history.pop();\r\n    }\r\n    if (newHistory.currentHistoryPosition === newHistory.history.length - 1) {\r\n        newHistory.currentHistoryPosition++;\r\n    }\r\n    newHistory.history.push(copyImageData(canvas));\r\n    return newHistory;\r\n}\r\n\r\nexport function undoHistory(state: ViewModel): ViewModel {\r\n    let editor: Editor = {\r\n        selectedObject: state.editor.selectedObject,\r\n        canvas: state.editor.canvas\r\n    };\r\n    let imageHistory: ImageHistory = state.imageHistory;\r\n    if (imageHistory.history.length > 0) {\r\n        if (imageHistory.currentHistoryPosition > 0 || editor.selectedObject != null) {\r\n            if (editor.selectedObject == null) {\r\n                imageHistory.currentHistoryPosition--;\r\n            } else {\r\n                editor = replaceSelectedObject(editor, null);\r\n                const historyCanvas = copyImageData(editor.canvas);\r\n                imageHistory = pushToHistory(imageHistory, historyCanvas);\r\n                if (state === undefined) {\r\n                    throw new Error();\r\n                }\r\n                imageHistory.currentHistoryPosition--;\r\n            }\r\n            editor.canvas = copyImageData(\r\n                imageHistory.history[imageHistory.currentHistoryPosition]\r\n            );\r\n        }\r\n    }\r\n    return {\r\n        ...state,\r\n        imageHistory: imageHistory,\r\n        editor: editor\r\n    }\r\n}\r\n\r\nexport function redoHistory(state: ViewModel): ViewModel {\r\n    let editor: Editor = {\r\n        selectedObject: state.editor.selectedObject,\r\n        canvas: state.editor.canvas\r\n    };\r\n    let imageHistory: ImageHistory = state.imageHistory;\r\n    if (imageHistory.history.length > 0) {\r\n        if (imageHistory.currentHistoryPosition < imageHistory.history.length - 1) {\r\n            imageHistory.currentHistoryPosition++;\r\n            editor.canvas = copyImageData(\r\n                imageHistory.history[imageHistory.currentHistoryPosition]\r\n            );\r\n        }\r\n    }\r\n    return {\r\n        ...state,\r\n        editor: editor,\r\n        imageHistory: imageHistory\r\n    }\r\n}\r\n","import { Reducer } from \"redux\";\r\nimport { RGBAColor } from \"../../structures/RGBAColor\";\r\nimport { ObjectState } from \"../../viewmodel/ObjectState\";\r\nimport NumberAction from \"../actions/types/NumberAction\";\r\nimport RGBAColorAction from \"../actions/types/RGBAColorAction\";\r\nimport StringAction from \"../actions/types/StringAction\";\r\nimport UPDATE_FILL_COLOR from \"../actions/updateFillColor\";\r\nimport UPDATE_FONT_NAME from \"../actions/updateFontName\";\r\nimport UPDATE_STROKE_COLOR from \"../actions/updateStrokeColor\";\r\nimport UPDATE_STROKE_WIDTH from \"../actions/updateStrokeWidth\";\r\nimport UPDATE_TEXT from \"../actions/updateText\";\r\nimport UPDATE_TEXT_COLOR from \"../actions/updateTextColor\";\r\nimport UPDATE_TEXT_PADDING from \"../actions/updateTextPadding\";\r\nimport UPDATE_TEXT_SIZE from \"../actions/updateTextSize\";\r\n\r\nconst updateObjectState: Reducer<ObjectState | undefined, RGBAColorAction | NumberAction | StringAction> =\r\n    (state, action) => {\r\n        if (state === undefined) {\r\n            throw new Error();\r\n        }\r\n        switch (action.type) {\r\n            case UPDATE_FILL_COLOR:\r\n                return {\r\n                    ...state,\r\n                    fillColor: action.value as RGBAColor\r\n                }\r\n            case UPDATE_STROKE_COLOR:\r\n                return {\r\n                    ...state,\r\n                    strokeColor: action.value as RGBAColor\r\n                }\r\n            case UPDATE_STROKE_WIDTH:\r\n                return {\r\n                    ...state,\r\n                    strokeWidth: action.value as number\r\n                }\r\n            case UPDATE_TEXT:\r\n                return {\r\n                    ...state,\r\n                    text: action.value as string\r\n                }\r\n            case UPDATE_TEXT_SIZE:\r\n                return {\r\n                    ...state,\r\n                    textSize: action.value as number\r\n                }\r\n            case UPDATE_TEXT_COLOR:\r\n                return {\r\n                    ...state,\r\n                    textColor: action.value as RGBAColor\r\n                }\r\n            case UPDATE_FONT_NAME:\r\n                return {\r\n                    ...state,\r\n                    fontName: action.value as string\r\n                }\r\n            case UPDATE_TEXT_PADDING:\r\n                return {\r\n                    ...state,\r\n                    padding: action.value as number\r\n                }\r\n            default:\r\n                return state;\r\n        }\r\n    }\r\n\r\nexport default updateObjectState;","import { Action, Reducer } from \"redux\";\r\nimport { cutSelectedArea, selectArea } from \"../../helper/CanvasHelper\";\r\nimport { removeSelectedObject, replaceSelectedObject } from \"../../helper/EditorHelper\";\r\nimport { applyFilter } from \"../../helper/FilterHelper\";\r\nimport { pushToHistory, redoHistory, undoHistory } from \"../../helper/HistoryHelper\";\r\nimport { Editor } from \"../../structures/Editor\";\r\nimport { ViewModel } from \"../../viewmodel/ViewModel\";\r\nimport APPLY_FILTER from \"../actions/applyFilter\";\r\nimport CUT_SELECTED_AREA from \"../actions/cutSelectedArea\";\r\nimport PUSH_TO_HISTORY from \"../actions/pushToHistory\";\r\nimport REDO_HISTORY from \"../actions/redoHistory\";\r\nimport REMOVE_SELECTED_OBJECT from \"../actions/removeSelectedObject\";\r\nimport REPLACE_SELECTED_OBJECT from \"../actions/actionReplaceSelectedObject\";\r\nimport SELECT_AREA from \"../actions/selectArea\";\r\nimport SET_EDITOR from \"../actions/setEditor\";\r\nimport EditorAction from \"../actions/types/EditorAction\";\r\nimport FilterAction from \"../actions/types/FilterAction\";\r\nimport ImageDataAction from \"../actions/types/ImageDataAction\";\r\nimport NumberAction from \"../actions/types/NumberAction\";\r\nimport RGBAColorAction from \"../actions/types/RGBAColorAction\";\r\nimport SelectedAreaAction from \"../actions/types/SelectedAreaAction\";\r\nimport SelectedObjectAction from \"../actions/types/SelectedObjectAction\";\r\nimport StringAction from \"../actions/types/StringAction\";\r\nimport ToolTypeAction from \"../actions/types/ToolTypeAction\";\r\nimport Vector2Action from \"../actions/types/Vector2Action\";\r\nimport UNDO_HISTORY from \"../actions/undoHistory\";\r\nimport UPDATE_TOOL from \"../actions/updateTool\";\r\nimport updateObjectState from \"./updateObjectState\";\r\nimport UPDATE_CANVAS_VIEW_MODEL from \"../actions/updateCanvasViewModel\";\r\nimport CanvasViewModelAction from \"../actions/types/CanvasViewModelAction\";\r\nimport CREATE_NEW_CANVAS from \"../actions/createNewCanvas\";\r\nimport EDIT_CANVAS_SIZE from \"../actions/editCanvasSize\";\r\n\r\nconst reducers: Reducer<ViewModel | undefined,\r\n    EditorAction |\r\n    SelectedObjectAction |\r\n    Vector2Action |\r\n    ToolTypeAction |\r\n    RGBAColorAction |\r\n    NumberAction |\r\n    StringAction |\r\n    CanvasViewModelAction |\r\n    Action> =\r\n    (state, action): ViewModel => {\r\n        if (state === undefined) {\r\n            throw new Error();\r\n        }\r\n        const editor = state.editor;\r\n        let newEditor = {\r\n            canvas: editor.canvas,\r\n            selectedObject: editor.selectedObject\r\n        };\r\n        let imageHistory = state.imageHistory;\r\n        switch (action.type) {\r\n            case SET_EDITOR:\r\n                return {\r\n                    ...state,\r\n                    editor: (action as EditorAction).value as Editor\r\n                }\r\n            case UNDO_HISTORY:\r\n                return undoHistory(state);\r\n            case REDO_HISTORY:\r\n                return redoHistory(state);\r\n            case PUSH_TO_HISTORY:\r\n                return {\r\n                    ...state,\r\n                    imageHistory: pushToHistory(imageHistory, (action as ImageDataAction).value),\r\n                }\r\n            case UPDATE_TOOL:\r\n                return {\r\n                    ...state,\r\n                    currentTool: (action as ToolTypeAction).value,\r\n                }\r\n            case APPLY_FILTER:\r\n                let newImageHistory;\r\n                newImageHistory = pushToHistory(imageHistory, newEditor.canvas);\r\n                newEditor = applyFilter(newEditor, (action as FilterAction).value);\r\n                newImageHistory = pushToHistory(imageHistory, newEditor.canvas);\r\n                return {\r\n                    ...state,\r\n                    imageHistory: newImageHistory,\r\n                    editor: newEditor\r\n                }\r\n            case SELECT_AREA:\r\n                const area = selectArea(editor, (action as SelectedAreaAction).value);\r\n                return {\r\n                    ...state,\r\n                    editor: area\r\n                }\r\n            case CUT_SELECTED_AREA:\r\n                return {\r\n                    ...state,\r\n                    editor: cutSelectedArea(editor)\r\n                }\r\n            case REPLACE_SELECTED_OBJECT:\r\n                newEditor = replaceSelectedObject(editor, (action as SelectedObjectAction).value);\r\n                return {\r\n                    ...state,\r\n                    editor: newEditor\r\n                };\r\n            case REMOVE_SELECTED_OBJECT:\r\n                return {\r\n                    ...state,\r\n                    editor: removeSelectedObject(editor)\r\n                };\r\n            case UPDATE_CANVAS_VIEW_MODEL:\r\n                return {\r\n                    ...state,\r\n                    canvasModel: (action as CanvasViewModelAction).value\r\n                }\r\n            case CREATE_NEW_CANVAS:\r\n                const sizeCreate = (action as Vector2Action).value;\r\n                const newCanvas = new ImageData(sizeCreate.x, sizeCreate.y);\r\n                newCanvas.data.fill(255);\r\n                return {\r\n                    ...state,\r\n                    editor: {\r\n                        ...state.editor,\r\n                        canvas: newCanvas\r\n                    },\r\n                    imageHistory: pushToHistory(imageHistory, newCanvas)\r\n                }\r\n            case EDIT_CANVAS_SIZE:\r\n                const sizeEdit = (action as Vector2Action).value;\r\n                let imageData = new ImageData(sizeEdit.x, sizeEdit.y);\r\n                imageData.data.fill(255);\r\n                const canvas = state.editor.canvas;\r\n                let minWidth = Math.min(sizeEdit.x, canvas.width);\r\n                let minHeight = Math.min(sizeEdit.y, canvas.height);\r\n\r\n                for (let i = 0; i < minHeight; i++) {\r\n                    for (let j = 0; j < minWidth; j++) {\r\n                        let dataIndex = (i * sizeEdit.x + j) * 4;\r\n                        let canvasDataIndex = (i * canvas.width + j) * 4;\r\n                        for (let k = 0; k < 4; k++) {\r\n                            imageData.data[dataIndex + k] = canvas.data[canvasDataIndex + k];\r\n                        }\r\n                    }\r\n                }\r\n                return {\r\n                    ...state,\r\n                    editor: {\r\n                        ...state.editor,\r\n                        canvas: imageData\r\n                    },\r\n                    imageHistory: pushToHistory(imageHistory, imageData)\r\n                }\r\n            default:\r\n                const objectState = updateObjectState(state.objectState, (action as RGBAColorAction | NumberAction | StringAction));\r\n                if (objectState === undefined) {\r\n                    throw new Error();\r\n                }\r\n                return {\r\n                    ...state,\r\n                    objectState: objectState,\r\n                }\r\n        }\r\n    }\r\n\r\nexport default reducers;\r\n","import { createStore } from 'redux';\r\nimport initialViewModel from './initialState';\r\nimport reducers from './reducers/rootReducer';\r\n\r\nconst store = createStore(reducers, initialViewModel);\r\n\r\nexport default store;","import { Provider } from 'react-redux';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport store from './store/store';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nrender();\nexport function render() {\n    ReactDOM.render(\n        <Provider store={store}>\n            <App />\n        </Provider>,\n        document.getElementById('root')\n    );\n}\n\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ObjectParams\":\"ObjectParams_ObjectParams__34bSI\",\"ParamsList\":\"ObjectParams_ParamsList__2892j\"};"],"sourceRoot":""}