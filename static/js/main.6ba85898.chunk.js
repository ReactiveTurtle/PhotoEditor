(this["webpackJsonpphoto-editor"]=this["webpackJsonpphoto-editor"]||[]).push([[0],{108:function(e,t,n){},113:function(e,t,n){e.exports={CanvasContainer:"Canvas_CanvasContainer__3wJou",Canvas:"Canvas_Canvas__2Yiih"}},114:function(e,t,n){e.exports={ToolsRoot:"Tools_ToolsRoot__lQFre",ToolsList:"Tools_ToolsList__1jkVW"}},116:function(e,t,n){e.exports={BrightnessSliderContainer:"BrightnessSlider_BrightnessSliderContainer__22-BP",BrightnessSliderCenter:"BrightnessSlider_BrightnessSliderCenter__15i_G"}},117:function(e,t,n){e.exports={mediaContainer:"WebCameraDialog_mediaContainer__ns1fy"}},152:function(e,t,n){e.exports={App:"App_App__3B_72",AppBar:"App_AppBar__2yUSo"}},298:function(e,t){},302:function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return gn}));var a=n(2),r=n(18),o=n(10),i=n(0),c=n.n(i),l=n(152),s=n.n(l),u=n(338),d=n(346),x=n(8),p=n(339),h=n(7),b=n(365),f=n(341),j=n(340),y=n(167),v=n(367),O=n(51),g=n(337),m=n(156),C=n.n(m),w=Object(h.a)((function(e){return Object(v.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:"#FFFFFF8a",borderRadius:"50%",backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21"},title:{userSelect:"none",msUserSelect:"none",fontFamily:"cursive",color:"#FFFFFFd0",marginLeft:e.spacing(2)}})}))((function(e){var t=e.children,n=e.classes,r=e.onClose,o=Object(y.a)(e,["children","classes","onClose"]);return Object(a.jsxs)(g.a,Object(x.a)(Object(x.a)({disableTypography:!0,className:n.root},o),{},{children:[Object(a.jsx)(O.a,{className:n.title,variant:"h6",children:t}),r?Object(a.jsx)(u.a,{type:"submit","aria-label":"close",className:n.closeButton,onClick:r,children:Object(a.jsx)(C.a,{})}):null]}))})),F=c.a.forwardRef((function(e,t){return Object(a.jsx)(p.a,Object(x.a)({direction:"up",ref:t},e))})),S=Object(h.a)((function(e){return{root:{padding:e.spacing(2)}}}))(j.a),T=Object(h.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(f.a),k=Object(h.a)((function(e){return{root:{"& .MuiDialog-paper":{background:"#cfcfcf33",boxShadow:"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )",backdropFilter:"blur(10.0px)",WebkitBackdropFilter:"blur( 10.0px )",borderRadius:"32px",borderTop:"1px solid rgba( 255, 255, 255, 0.18 )",borderLeft:"1px solid rgba( 255, 255, 255, 0.18 )"},"& label":{color:"#FFFFFF8a"},"& label.Mui-focused":{color:"#62ebff"},"& .MuiInputBase-root":{color:"white"},"& .MuiOutlinedInput-root":{backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21","& fieldset":{borderColor:"transparent"},"&:hover fieldset":{borderColor:"transparent"},"&.Mui-focused fieldset":{borderColor:"#62ebff42"}}}}}))(b.a);var M,z=function(e){var t=function(){e.onClose()};return Object(a.jsxs)(k,{PaperProps:{style:Object(x.a)({},e.paperStyle)},TransitionComponent:F,onClose:function(){return t()},"aria-labelledby":"customized-dialog-title",open:e.isOpen,children:[Object(a.jsx)(w,{id:"customized-dialog-title",onClose:function(){return t()},children:e.title}),Object(a.jsx)(S,{dividers:!0,onScroll:e.onScroll,style:e.contentStyle,children:e.children}),void 0!==e.actions&&Object(a.jsx)(T,{children:void 0!==e.actions&&e.actions()})]})},E=n(360),A=n(342),P=Object(A.a)((function(){return Object(v.a)({root:{userSelect:"none","& .MuiOutlinedInput-root":{borderRadius:"24px"}}})})),L=function(e){var t=P();return Object(a.jsx)(E.a,{classes:{root:"".concat(t.root," ").concat(e.className)},label:e.label,id:void 0===e.id?"outlined-textfield":e.id,variant:"outlined",autoComplete:e.autocomplete,InputProps:{inputProps:{min:e.min}},type:e.type,value:e.text,defaultValue:e.defaultText,onFocus:function(){void 0!==e.onClick&&e.onClick()},onClick:function(){void 0!==e.onClick&&e.onClick()},onChange:function(t){return e.onChange(t)}})},R=Object(A.a)((function(){return Object(v.a)({searchField:{margin:"0 8px"}})}));function I(e){var t=R(),n=Object(r.c)(),c=Object(i.useState)(!1),l=Object(o.a)(c,2),s=l[0],x=l[1],p=Object(i.useState)(!0),h=Object(o.a)(p,2),b=h[0],f=h[1],j=Object(i.useState)({x:800,y:600}),y=Object(o.a)(j,1)[0],v=function(){x(!1)},O=function(){b&&(v(),e.action.value=y,n(e.action))};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){x(!0)},children:e.children}),Object(a.jsxs)(z,{isOpen:s,title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440",onClose:function(){return v()},actions:function(){return Object(a.jsx)(d.a,{autoFocus:!0,onClick:O,color:"secondary",children:e.applyText})},children:[Object(a.jsx)(L,{className:t.searchField,defaultText:y.x+"",type:"number",label:"\u0428\u0438\u0440\u0438\u043d\u0430",min:"0",onChange:function(e){f(""!==e.target.value),y.x=Math.abs(parseInt(e.target.value))}}),Object(a.jsx)(L,{defaultText:y.y+"",type:"number",label:"\u0412\u044b\u0441\u043e\u0442\u0430",min:"0",onChange:function(e){f(""!==e.target.value),y.y=Math.abs(parseInt(e.target.value))}})]})]})}function _(e){return{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16),a:parseInt(e.substr(7,2),16)/255}}function N(e){return W(e)+D(Math.floor(255*e.a))}function D(e){return B(Math.floor(e/16))+B(e%16)}!function(e){e[e.Art=0]="Art",e[e.Rectangle=1]="Rectangle",e[e.Triangle=2]="Triangle",e[e.Circle=3]="Circle",e[e.TextObject=4]="TextObject",e[e.Area=5]="Area"}(M||(M={}));var H=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function B(e){return H[e]}function W(e){return"#"+D(e.r)+D(e.g)+D(e.b)}var G=n(43),V=n.n(G);function U(e,t){var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var a=n.getContext("2d");if(null===a)throw new Error;a.putImageData(t,0,0),e.drawImage(n,0,0),n.remove()}function X(e,t,n){var a,r={x:t.x,y:t.y};switch(n.type){case M.Rectangle:a=Y(e,r,n);break;case M.Triangle:a=function(e,t,n){e.beginPath(),e.moveTo(n.p0.x,n.p0.y),e.lineTo(n.p1.x,n.p1.y),e.lineTo(n.p2.x,n.p2.y),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=W(n.props.fillColor),e.fill(),n.props.strokeWidth>0&&(e.lineWidth=n.props.strokeWidth,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=W(n.props.strokeColor),e.stroke());return e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case M.Circle:a=function(e,t,n){if(e.beginPath(),e.arc(n.position.x,n.position.y,n.radius,0,2*Math.PI),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=W(n.props.fillColor),e.fill(),n.props.strokeWidth>0){var a=n.props.strokeWidth;e.lineWidth=a,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=W(n.props.strokeColor),e.beginPath(),e.arc(n.position.x,n.position.y,n.radius+a/2,0,2*Math.PI),e.closePath(),e.stroke()}return e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case M.Art:a=function(e,t,n){var a=document.createElement("canvas");a.width=n.image.width,a.height=n.image.height;var r=a.getContext("2d");if(null===r)throw new Error;r.putImageData(n.image,0,0);var o=document.createElement("canvas");o.width=Math.max(1,n.size.x),o.height=Math.max(1,n.size.y);var i=o.getContext("2d");if(null===i)throw new Error;return i.scale(n.size.x/n.image.width,n.size.y/n.image.height),i.drawImage(a,0,0),e.drawImage(o,n.position.x,n.position.y),e.getImageData(0,0,t.x,t.y)}(e,r,n);break;case M.TextObject:a=function(e,t,n){Y(e,t,n.rectangle),e.globalAlpha=n.textColor.a,e.fillStyle=W(n.textColor);var a=n.padding;return V.a.fontSize=n.textSize,V.a.font=n.fontName,V.a.align="left",V.a.vAlign="top",V.a.lineHeight=1.25*n.textSize,V.a.drawText(e,n.text,n.rectangle.position.x+a,n.rectangle.position.y+a,n.rectangle.size.x-2*a,n.rectangle.size.y-2*a),e.getImageData(0,0,t.x,t.y)}(e,r,n)}if(e.globalAlpha=1,void 0===a)throw new Error;return a}function Y(e,t,n){if(e.beginPath(),e.moveTo(n.position.x,n.position.y),e.lineTo(n.position.x+n.size.x,n.position.y),e.lineTo(n.position.x+n.size.x,n.position.y+n.size.y),e.lineTo(n.position.x,n.position.y+n.size.y),e.closePath(),e.globalAlpha=n.props.fillColor.a,e.fillStyle=W(n.props.fillColor),e.fill(),n.props.strokeWidth>0){var a=n.props.strokeWidth/2;e.lineWidth=n.props.strokeWidth,e.globalAlpha=n.props.strokeColor.a,e.strokeStyle=W(n.props.strokeColor),e.beginPath(),e.moveTo(n.position.x-a,n.position.y-a),e.lineTo(n.position.x+n.size.x+a,n.position.y-a),e.lineTo(n.position.x+n.size.x+a,n.position.y+n.size.y+a),e.lineTo(n.position.x-a,n.position.y+n.size.y+a),e.closePath(),e.stroke()}return e.getImageData(0,0,t.x,t.y)}var J=n(113),K=n.n(J);function q(e,t,n){var a={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},r=Math.max(e.x,t.x),o=Math.max(e.y,t.y);return{type:M.Rectangle,position:{x:Math.round(a.x),y:Math.round(a.y)},size:{x:Math.round(r-a.x),y:Math.round(o-a.y)},rotation:0,props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}function Z(e,t,n){var a={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},r=Math.max(e.x,t.x),o=Math.max(e.y,t.y);return{type:M.Area,position:{x:Math.round(a.x),y:Math.round(a.y)},size:{x:Math.round(r-a.x),y:Math.round(o-a.y)}}}var Q="REMOVE_SELECTED_OBJECT";function $(){return{type:Q}}var ee="SELECT_AREA";var te=function(e){return{type:ee,value:e}},ne="CUT_SELECTED_AREA";var ae=function(){return{type:ne}},re="PUSH_TO_HISTORY";var oe=function(e){return{type:re,value:e}},ie="REPLACE_SELECTED_OBJECT";var ce=function(e){return{type:ie,value:e}},le="SET_EDITOR";var se,ue=function(e){return{type:le,value:e}};function de(e){switch(e){case se.JPEG:return"jpeg";case se.PNG:return"png";default:return"unknown"}}function xe(e){var t=new ImageData(e.width,e.height);return t.data.set(new Uint8ClampedArray(e.data)),t}function pe(e){return{canvas:xe(e.selectedObject.image),selectedObject:null}}function he(e,t,n){var a=new XMLHttpRequest;void 0!==n&&(a.onprogress=function(e){n(e.loaded/e.total*100)}),a.onload=function(){var e=new Image,n=new Blob([this.response]);e.onload=function(){URL.revokeObjectURL(e.src);var n=document.createElement("canvas");n.width=e.clientWidth,n.height=e.clientHeight;var a=n.getContext("2d");if(null!==a){a.drawImage(e,0,0);var r={type:M.Art,image:a.getImageData(0,0,e.width,e.height),position:{x:0,y:0},size:{x:e.width,y:e.height},rotation:0};t(r)}n.remove(),e.remove()},e.src=window.URL.createObjectURL(n),document.body.appendChild(e)},a.responseType="arraybuffer",a.overrideMimeType("text/plain; charset=x-user-defined"),a.open("GET",e,!0),a.send()}function be(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=fe(t,n);e(oe(null==a?r.canvas:a)),e(ue(r))}function fe(e,t){var n=Object(x.a)(Object(x.a)({},e),{},{selectedObject:t});if(null!=e.selectedObject){var a=document.createElement("canvas");if(a.width=e.canvas.width,a.height=e.canvas.height,null!=a){var r=a.getContext("2d");null!=r&&(r.putImageData(e.canvas,0,0),n.canvas=X(r,{x:e.canvas.width,y:e.canvas.height},e.selectedObject))}}return n}function je(e){return{canvas:xe(e.canvas),selectedObject:null}}function ye(e){return Math.floor(Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)))}!function(e){e[e.JPEG=0]="JPEG",e[e.PNG=1]="PNG"}(se||(se={}));var ve="UPDATE_CANVAS_VIEW_MODEL";var Oe=function(e){return{type:ve,value:e}},ge="UPDATE_TEXT";function me(e){return{type:ge,value:e}}var Ce=n(304),we=n(305),Fe=n(347),Se=n(79),Te="UPDATE_TOOL";var ke,Me=n(114),ze=n.n(Me);!function(e){e[e.Rectangle=0]="Rectangle",e[e.Triangle=1]="Triangle",e[e.Circle=2]="Circle",e[e.Text=3]="Text",e[e.Area=4]="Area"}(ke||(ke={}));var Ee=Object(A.a)((function(e){return Object(v.a)({root:{position:"fixed",margin:"8px 0 0 8px",background:"rgba(255, 255, 255, 0.20)",boxShadow:"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )",backdropFilter:"blur(10.0px)",WebkitBackdropFilter:"blur( 10.0px )",borderRadius:"32px",borderTop:"1px solid rgba( 255, 255, 255, 0.18 )",borderLeft:"1px solid rgba( 255, 255, 255, 0.18 )"},item:{minWidth:"0",width:"48px",height:"48px",borderRadius:"24px",alignContent:"center",margin:"0 4px",padding:"0","&:hover":{background:"#42424242"}},selectedItem:{background:e.palette.secondary.light+"CC","&:hover":{background:e.palette.secondary.light}}})}));function Ae(e){var t=e.onSelected,n=Object(r.c)(),o=Object(r.d)((function(e){return e.currentTool})),i=function(e){e!==o&&(n({type:Te,value:e}),t())},c=Ee();return Object(a.jsx)(Ce.a,{className:ze.a.ToolsRoot+" "+c.root,children:Object(a.jsxs)(we.a,{className:ze.a.ToolsList,component:"nav","aria-label":"\u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b",children:[Object(a.jsx)(Fe.a,{button:!0,onClick:function(){return i(ke.Rectangle)},className:c.item+" "+(o===ke.Rectangle?c.selectedItem:""),children:Object(a.jsx)(Se.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("rect",{x:"0",y:"0",width:"32",height:"32",fill:o===ke.Rectangle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(Fe.a,{button:!0,onClick:function(){return i(ke.Triangle)},className:c.item+" "+(o===ke.Triangle?c.selectedItem:""),children:Object(a.jsx)(Se.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("polygon",{points:"0,32 32,32 16,0",fill:o===ke.Triangle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(Fe.a,{button:!0,onClick:function(){return i(ke.Circle)},className:c.item+" "+(o===ke.Circle?c.selectedItem:""),children:Object(a.jsx)(Se.a,{viewBox:"0 0 32 32",style:{margin:"auto"},children:Object(a.jsx)("circle",{r:"16",cx:"16",cy:"16",fill:o===ke.Circle?"#FFFFFF":"#424242"})})}),Object(a.jsx)(Fe.a,{button:!0,onClick:function(){return i(ke.Text)},className:c.item+" "+(o===ke.Text?c.selectedItem:""),children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",style:{margin:"auto"},children:Object(a.jsx)("path",{d:"M5 4v3h5.5v12h3V7H19V4z",fill:o===ke.Text?"#FFFFFF":"#424242"})})}),Object(a.jsx)(Fe.a,{button:!0,onClick:function(){return i(ke.Area)},className:c.item+" "+(o===ke.Area?c.selectedItem:""),children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",style:{margin:"auto"},children:Object(a.jsx)("path",{d:"M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z",fill:o===ke.Area?"#FFFFFF":"#424242"})})})]})})}function Pe(e,t,n,a){var r=a.canvasModel,o=Object(x.a)({},r);if(!r.isMiddleMouseDown){var i,c,l={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop},s=a.editor,u=s.selectedObject,d=r.tempObject,p=r.scale;if(r.isCanvasDown){var h=r.tempPoint,b=r.start;null!=u&&be(t,s,null);var f=(l.x-b.x)/p,j=(l.y-b.y)/p;if("pointer"===n.style.cursor){if(null!==d&&null!==h)if(d.type===M.Rectangle||d.type===M.TextObject||d.type===M.Art||d.type===M.Area){var y;if(y=d.type===M.TextObject?d.rectangle:d,e.shiftKey&&y.type===M.Art){var v={x:f,y:j},O=ye(v),g=ye(y.size);f=O*(y.size.x/g),j=O*(y.size.y/g);var m=Math.sign(((i=v).x*(c=h).x+i.y*c.y)/(ye(i)*ye(c)));y.position.x+=f*Math.min(h.x,0)*m,y.position.y+=j*Math.min(h.y,0)*m,y.size.x+=f*m,y.size.y+=j*m}else h.x>0?y.size.x+=f:h.x<0&&(y.position.x+=f,y.size.x+=-f),h.y>0?y.size.y+=j:h.y<0&&(y.position.y+=j,y.size.y+=-j);0===y.size.x&&(y.size.x=-1),0===y.size.y&&(y.size.y=-1),y.size.x<0&&(h.x*=-1,y.size.x=Math.abs(y.size.x),y.position.x-=y.size.x),y.size.y<0&&(h.y*=-1,y.size.y=Math.abs(y.size.y),y.position.y-=y.size.y)}else if(d.type===M.Triangle)h.x+=f,h.y+=j;else if(d.type===M.Circle){var C=d;console.log(C),C.radius=Math.round(ye({x:l.x-C.position.x,y:l.y-C.position.y}))}o.start=l}else if("grabbing"===n.style.cursor){var w;if(null!=d)if(d.type===M.Rectangle||d.type===M.Circle||d.type===M.TextObject||d.type===M.Art||d.type===M.Area)(w=d.type===M.TextObject?d.rectangle:d).position.x+=f,w.position.y+=j;else if(d.type===M.Triangle){var F=d;F.p0.x+=f,F.p0.y+=j,F.p1.x+=f,F.p1.y+=j,F.p2.x+=f,F.p2.y+=j}o.start=l}else"default"===n.style.cursor&&""!==a.objectState.text&&t(me("")),function(e,n){if(r.isCanvasDown){var i=null,c=a.currentTool,l=a.objectState;switch(c){case ke.Rectangle:i=q(e,n,l);break;case ke.Triangle:i=function(e,t,n){var a={x:Math.min(e.x,t.x),y:e.y},r={x:Math.max(e.x,t.x),y:t.y};return{type:M.Triangle,p0:{x:a.x,y:a.y},p1:{x:r.x,y:a.y},p2:{x:a.x/2+r.x/2,y:r.y},props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}(e,n,l);break;case ke.Circle:i=function(e,t,n){var a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));return{type:M.Circle,position:{x:e.x,y:e.y},radius:a,props:{fillColor:n.fillColor,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth}}}(e,n,l);break;case ke.Text:i=function(e,t,n){return{type:M.TextObject,rectangle:q(e,t,n),text:n.text,textSize:n.textSize,textColor:n.textColor,fontName:n.fontName,padding:n.padding}}(e,n,l);break;case ke.Area:i=Z(e,n)}o.tempObject=i,t(Oe(r))}}({x:b.x/p,y:b.y/p},{x:l.x/p,y:l.y/p})}else{var S=function(e){o.tempPoint=e};null===u&&null!==d&&d.type===M.Area?Le(n,p,l,d,S):Le(n,p,l,u,S),o.start=l}t(Oe(o))}}function Le(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;if(null!=a){if(a.type===M.Rectangle||a.type===M.TextObject||a.type===M.Art||a.type===M.Area){var o,i={x:(o=a.type===M.TextObject?a.rectangle:a).position.x*t,y:o.position.y*t},c={x:o.size.x*t,y:o.size.y*t},l=[{x:i.x,y:i.y},{x:i.x+c.x/2,y:i.y},{x:i.x+c.x,y:i.y},{x:i.x+c.x,y:i.y+c.y/2},{x:i.x+c.x,y:i.y+c.y},{x:i.x+c.x/2,y:i.y+c.y},{x:i.x,y:i.y+c.y},{x:i.x,y:i.y+c.y/2}],s=l.map((function(e){return ye({x:e.x-n.x,y:e.y-n.y})<=12})).findIndex((function(e){return e}));s>-1?(r({x:Math.sign(l[s].x-(i.x+c.x/2)),y:Math.sign(l[s].y-(i.y+c.y/2))}),e.style.cursor="pointer"):n.x>=i.x&&n.x<=i.x+c.x&&n.y>=i.y&&n.y<=i.y+c.y?e.style.cursor="grab":e.style.cursor="default"}else if(a.type===M.Triangle){var u=a,d=[u.p0,u.p1,u.p2],x=[{x:u.p0.x*t,y:u.p0.y*t},{x:u.p1.x*t,y:u.p1.y*t},{x:u.p2.x*t,y:u.p2.y*t}],p=x.map((function(e){return ye({x:e.x-n.x,y:e.y-n.y})<=12})).findIndex((function(e){return e}));p>-1?(r(d[p]),e.style.cursor="pointer"):Re(n,x[0],x[1],x[2])?e.style.cursor="grab":e.style.cursor="default"}else if(a.type===M.Circle){var h=a,b={x:h.position.x*t,y:h.position.y*t},f=h.radius*t,j=ye({x:n.x-b.x,y:n.y-b.y});j>=f-12&&j<=f+12?(r(b),e.style.cursor="pointer"):ye({x:n.x-b.x,y:n.y-b.y})<Math.max(f-12,0)?e.style.cursor="grab":e.style.cursor="default"}}else e.style.cursor="default"}function Re(e,t,n,a){var r=e.x-a.x,o=e.y-a.y,i=a.x-n.x,c=n.y-a.y,l=c*(t.x-a.x)+i*(t.y-a.y),s=c*r+i*o,u=(a.y-t.y)*r+(t.x-a.x)*o;return l<0?s<=0&&u<=0&&s+u>=l:s>=0&&u>=0&&s+u<=l}function Ie(e){var t=e.focused,n=Object(r.c)(),c=Object(r.d)((function(e){return e})),l=c.editor.selectedObject,s=c.objectState,u=c.canvasModel,d=u.tempObject,p=Object(r.d)((function(e){return e.editor}),r.b),h=p.canvas,b=u.canvasPosition;if(null!=l&&(l.type===M.Rectangle||l.type===M.Triangle||l.type===M.Circle||l.type===M.TextObject)){var f;if(l.type===M.TextObject){var j=l;j.text=s.text,j.textSize=s.textSize,j.textColor=s.textColor,f=j.rectangle.props}else f=l.props;f.fillColor=s.fillColor,f.strokeColor=s.strokeColor,f.strokeWidth=s.strokeWidth}var y=Object(i.useRef)(null),v=Object(i.useRef)(null);Object(i.useEffect)((function(){var e=u.scale;null!==v.current&&null!==y.current&&(v.current.width=h.width*e,v.current.height=h.height*e,null!=v.current&&function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null==e)return;var o=e.getContext("2d");if(null!=o){if(o.scale(t,t),U(o,n),null!=a&&(a.type===M.TextObject?o.putImageData(X(o,{x:n.width,y:n.height},a.rectangle),0,0):o.putImageData(X(o,{x:n.width,y:n.height},a),0,0),Ne(t,a,o)),null!=r)if(r.type!==M.Area){var i=r;i.type===M.TextObject?o.putImageData(X(o,{x:n.width,y:n.height},i.rectangle),0,0):o.putImageData(X(o,{x:n.width,y:n.height},i),0,0)}else Ne(t,r,o);o.scale(1/t,1/t)}}(v.current,e,h,l,u.tempObject))})),Object(i.useEffect)((function(){if(t){var e=u.scale,a=function(t){var a=e,r=t.deltaY<0?1:-2;(a*=Math.exp(.1*r))>4&&(a=e);var o=u.canvasPosition.x-(t.clientX/e-u.canvasPosition.x/e)*(a-e),i=u.canvasPosition.y-(t.clientY/e-u.canvasPosition.y/e)*(a-e),c=Object(x.a)(Object(x.a)({},u),{},{canvasPosition:{x:o,y:i},scale:a});n(Oe(c))};window.addEventListener("wheel",a);var r=function(e){1===e.button&&(document.body.style.cursor="move",null!==v.current&&(v.current.style.cursor="move"),u.isMiddleMouseDown=!0,u.middleMouseStart={x:e.clientX,y:e.clientY},n(Oe(u)))};window.addEventListener("mousedown",r);var o=function(e){u.isMiddleMouseDown&&null!==v.current&&(u.canvasPosition={x:u.canvasPosition.x+(e.clientX-u.middleMouseStart.x),y:u.canvasPosition.y+(e.clientY-u.middleMouseStart.y)},v.current.style.marginLeft="".concat(u.canvasPosition.x,"px"),v.current.style.marginTop="".concat(u.canvasPosition.y,"px"),u.middleMouseStart={x:e.clientX,y:e.clientY},n(Oe(u)))};window.addEventListener("mousemove",o);var i=function(e){1===e.button&&(document.body.style.cursor="default",null!==v.current&&(v.current.style.cursor="default"),u.isMiddleMouseDown=!1,n(Oe(u)))};return window.addEventListener("mouseup",i),function(){window.removeEventListener("wheel",a),window.removeEventListener("mousedown",r),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",i)}}}),[u,n,l,h,t]),Object(i.useEffect)((function(){if(t){var e=function(e){if(e.ctrlKey){if("KeyX"===e.code){if(null!=d&&d.type===M.Area){n(te(d));var t=p.canvas;n(ae()),n(oe(t)),u.tempObject=null,n(Oe(u)),n($())}}else if("KeyA"===e.code&&(null===l||void 0===l?void 0:l.type)!==M.TextObject){var a=Z({x:0,y:0},{x:h.width,y:h.height});n(te(a));var r=p.canvas;n(oe(r))}}else{var o=function(){be(n,p,null),u.tempObject=null,n(Oe(u)),n(me(""))};switch(e.code){case"Escape":if(null==d||d.type!==M.Area){var i=p.canvas;n(ce(null)),n(oe(i))}o();break;case"Delete":null!=d&&d.type===M.Area||n($()),u.tempObject=null,n(Oe(u)),n(me(""));break;case"Enter":if(e.shiftKey)break;o()}}};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}}));var O=Object(i.useState)(!0),g=Object(o.a)(O,2),m=g[0],C=g[1],w=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e;(null===l||void 0===l?void 0:l.type)===M.TextObject&&m?(C(!1),null===(e=w.current)||void 0===e||e.focus()):c.currentTool!==ke.Text&&C(!0)}),[m,C,c,l]),Object(a.jsxs)("div",{ref:y,className:K.a.CanvasContainer,children:[null!==l&&l.type===M.TextObject&&Object(a.jsx)("textarea",{ref:w,style:{marginLeft:b.x+(l.rectangle.position.x+s.padding)*u.scale,marginTop:b.y+(l.rectangle.position.y+s.padding)*u.scale,position:"fixed",width:(l.rectangle.size.x-2*s.padding)*u.scale,height:(l.rectangle.size.y-2*s.padding)*u.scale,resize:"none",fontFamily:s.fontName,fontSize:"".concat(l.textSize*u.scale,"px"),lineHeight:"".concat(l.textSize*u.scale*1.25,"px"),backgroundColor:"#FFFFFF00",border:"none",outline:"none",color:"".concat(N(s.textColor))},value:s.text,onChange:function(e){n(me(e.target.value))}}),Object(a.jsx)("canvas",{id:"canvas",ref:v,className:K.a.Canvas,style:{marginLeft:b.x,marginTop:b.y},onMouseDown:function(e){v.current&&function(e,t,n,a){if(0===e.button){var r=a.editor,o=a.canvasModel,i=Object(x.a)({},o);if(!o.isMiddleMouseDown){var c=r.selectedObject,l=o.tempObject;if("pointer"===n.style.cursor){if(null!=c){if(i.tempObject=c,null==n.getContext("2d"))throw new Error("CanvasHandler: context is null");null!=c&&t($()),i.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop}}}else if("grab"===n.style.cursor)(null!=c||null!==l&&l.type===M.Area)&&(n.style.cursor="grabbing",null===c&&null!==l&&l.type===M.Area||(i.tempObject=c),t($()),i.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop});else{if(null!=c){if(c.type===M.TextObject){var s=r.selectedObject;s.fontName=a.objectState.fontName,s.padding=a.objectState.padding}be(t,r,null)}i.start={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop}}i.isCanvasDown=!0,t(Oe(i))}}}(e,n,v.current,c)},onMouseMove:function(e){v.current&&Pe(e,n,v.current,c)},onMouseUp:function(e){v.current&&function(e,t,n,a){var r={x:e.clientX-n.offsetLeft,y:e.clientY-n.offsetTop},o=a.canvasModel,i=Object(x.a)({},o),c=a.editor,l=c.selectedObject,s=o.tempObject,u=o.scale;if(null!=s)if(Le(n,u,r,s,(function(e){i.tempPoint=e})),s.type!==M.Area)t(ce(s)),i.tempObject=null;else{t(te(s));var d=c.canvas;t(oe(d)),i.tempObject=null,t(Oe(i))}else"default"===n.style.cursor&&(null!=l?be(t,c,null,c.canvas):t(me("")));i.isCanvasDown=!1,t(Oe(i))}(e,n,v.current,c)}})]})}function _e(e,t,n){var a=e.createLinearGradient(t.x,t.y,t.x+n.x,t.y+n.y);return a.addColorStop(0,"#F00"),a.addColorStop(.2,"#FF0"),a.addColorStop(.4,"#0F0"),a.addColorStop(.6,"#0FF"),a.addColorStop(.8,"#00F"),a.addColorStop(1,"#F0F"),a}function Ne(e,t,n){if(n.lineWidth=2/e,t.type===M.Rectangle||t.type===M.TextObject||t.type===M.Art||t.type===M.Area){var a;a=t.type===M.TextObject?t.rectangle:t,t.type===M.Area&&n.setLineDash([3,4]);var r={x:a.position.x,y:a.position.y},o={x:a.size.x,y:a.size.y};n.beginPath();var i=Math.min(r.y+o.y,r.y);n.moveTo(r.x-n.lineWidth,i-n.lineWidth),n.lineTo(r.x+o.x+n.lineWidth,i-n.lineWidth),n.lineTo(r.x+o.x+n.lineWidth,i+Math.abs(o.y)+n.lineWidth),n.lineTo(r.x-n.lineWidth,i+Math.abs(o.y)+n.lineWidth),n.lineTo(r.x-n.lineWidth,i-n.lineWidth),n.closePath(),n.strokeStyle=_e(n,r,o),n.fillStyle=n.strokeStyle,n.stroke();var c=[{x:r.x,y:r.y},{x:r.x+o.x/2,y:r.y},{x:r.x+o.x,y:r.y},{x:r.x+o.x,y:r.y+o.y/2},{x:r.x+o.x,y:r.y+o.y},{x:r.x+o.x/2,y:r.y+o.y},{x:r.x,y:r.y+o.y},{x:r.x,y:r.y+o.y/2}];t.type===M.Area&&n.setLineDash([]),c.forEach((function(t){n.beginPath(),n.arc(t.x,t.y,8/e,0,2*Math.PI,!1),n.closePath(),n.fill(),n.strokeStyle="#424242",n.stroke()}))}else if(t.type===M.Triangle){var l=t;n.beginPath(),n.moveTo(l.p0.x,l.p0.y),n.lineTo(l.p1.x,l.p1.y),n.lineTo(l.p2.x,l.p2.y),n.closePath();var s=[l.p0,l.p1,l.p2],u={x:Math.min(l.p0.x,l.p1.x,l.p2.x),y:Math.min(l.p0.y,l.p1.y,l.p2.y)},d={x:Math.max(l.p0.x,l.p1.x,l.p2.x),y:Math.max(l.p0.y,l.p1.y,l.p2.y)};n.strokeStyle=_e(n,u,{x:d.x-u.x,y:d.y-u.y}),n.fillStyle=n.strokeStyle,n.stroke();s.forEach((function(t){n.beginPath(),n.arc(t.x,t.y,8/e,0,2*Math.PI,!1),n.fill(),n.strokeStyle="#424242",n.stroke(),n.closePath()}))}else if(t.type===M.Circle){var x=t,p=x.position;n.beginPath(),n.moveTo(p.x+x.radius+n.lineWidth,p.y),n.arc(p.x,p.y,x.radius+n.lineWidth,0,2*Math.PI),n.closePath(),n.strokeStyle=_e(n,{x:p.x-x.radius,y:p.y-x.radius},{x:2*x.radius,y:2*x.radius}),n.fillStyle=n.strokeStyle,n.stroke()}}var De=n(165),He=Object(A.a)((function(){return Object(v.a)({root:{margin:"8px 0",color:"#000000","& label":{color:"#aa00ff"},"& .MuiOutlinedInput-root":{backgroundColor:"#FFFFFFa5",boxShadow:"4px 4px 16px #646464a5, -4px -4px 16px #ffffffa5","& fieldset":{borderColor:"#aa00ff"},"&:hover fieldset":{borderColor:"#aa00ff"},"&.Mui-focused fieldset":{borderColor:"#aa00ff"}}}})}));function Be(e){var t=He(),n=Object(i.useState)(e.defaultColor),r=Object(o.a)(n,2),c=r[0],l=r[1],s=Object(i.useState)(!1),u=Object(o.a)(s,2),d=u[0],x=u[1],p=function(t){if(void 0!==t){var n=t.rgb.a;void 0===n&&(n=1);var a={r:t.rgb.r,g:t.rgb.g,b:t.rgb.b,a:n};l(a),e.onChange(a)}};return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{children:[d?Object(a.jsxs)("div",{style:{position:"fixed",zIndex:4},children:[Object(a.jsx)("div",{style:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},onClick:function(){x(!1)}}),Object(a.jsx)("div",{ref:function(e){null!==e&&(e.style.transform="translateY(".concat(-e.clientHeight-8,"px)"))},children:Object(a.jsx)(De.a,{color:{r:c.r,g:c.g,b:c.b,a:c.a},disableAlpha:!1,onChangeComplete:p,onChange:p})})]}):null,Object(a.jsx)(L,{className:t.root,id:e.id,label:e.title,text:N(c),type:"text",onClick:function(){x(!d)},onChange:function(t){t.target.oninput=null;var n=_(t.target.value);l(n),e.onChange(n)}})]})})}var We="UPDATE_FILL_COLOR";var Ge="UPDATE_STROKE_COLOR";var Ve="UPDATE_STROKE_WIDTH";var Ue="UPDATE_TEXT_COLOR";var Xe="UPDATE_TEXT_SIZE";var Ye="UPDATE_FONT_NAME";var Je=n(58),Ke=n.n(Je),qe="UPDATE_TEXT_PADDING";var Ze,Qe=function(){var e=He(),t=Object(r.c)(),n=Object(r.d)((function(e){return e.objectState})),o=Object(r.d)((function(e){return e.currentTool}));return Object(a.jsxs)("div",{className:Ke.a.ObjectParams,children:[Object(a.jsxs)("div",{className:Ke.a.ParamsList,children:[Object(a.jsx)(Be,{id:"TextField-fillColor",title:"\u0426\u0432\u0435\u0442 \u0437\u0430\u043b\u0438\u0432\u043a\u0438",defaultColor:n.fillColor,onChange:function(e){t(function(e){return{type:We,value:e}}(e))}}),Object(a.jsx)(Be,{id:"TextField-strokeColor",title:"\u0426\u0432\u0435\u0442 \u043a\u043e\u043d\u0442\u0443\u0440\u0430",defaultColor:n.strokeColor,onChange:function(e){t({type:Ge,value:e})}}),Object(a.jsx)(L,{className:e.root,label:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043a\u043e\u043d\u0442\u0443\u0440\u0430",defaultText:"".concat(n.strokeWidth),min:"0",type:"number",onChange:function(e){var n=parseInt(e.target.value);t({type:Ve,value:n})}})]}),Object(a.jsxs)("div",{className:Ke.a.ParamsList,children:[o===ke.Text&&Object(a.jsx)(L,{className:e.root,label:"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u043a\u0441\u0442\u0430",defaultText:"".concat(n.textSize),min:"1",type:"number",onChange:function(e){var n;t((n=parseInt(e.target.value),{type:Xe,value:n}))}}),o===ke.Text&&Object(a.jsx)(Be,{id:"TextField-textColor",title:"\u0426\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430",defaultColor:n.textColor,onChange:function(e){t({type:Ue,value:e})}}),o===ke.Text&&Object(a.jsx)(L,{className:e.root,label:"\u0428\u0440\u0438\u0444\u0442",defaultText:"".concat(n.fontName),type:"text",onChange:function(e){var n;t((n=e.target.value,{type:Ye,value:n}))}})]}),Object(a.jsx)("div",{className:Ke.a.ParamsList,children:o===ke.Text&&Object(a.jsx)(L,{className:e.root,label:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u043e\u0442\u0441\u0442\u0443\u043f",defaultText:"".concat(n.padding),min:"0",type:"number",onChange:function(e){var n;t((n=parseInt(e.target.value),{type:qe,value:n}))}})})]})},$e=(n(298),n(361)),et=n(358),tt=n(359),nt=n(357),at=n(166),rt=n(348),ot=n(345);function it(){return Object(a.jsxs)(Se.a,{viewBox:"0 0 512 512",style:{width:"100%",height:"100%"},children:[Object(a.jsx)("path",{style:{fill:"#FFE17D"},d:"M214.71,306.106v197.626c0,6.139,6.46,10.132,11.951,7.386l61.5-30.75  c5.595-2.798,9.13-8.517,9.13-14.772v-159.49c0-5.702,1.967-11.229,5.568-15.649L473.4,81.157c3.602-4.42,5.568-9.947,5.568-15.649  V16.516C478.968,7.395,471.573,0,462.452,0H49.548c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649  l170.541,209.3C212.743,294.877,214.71,300.404,214.71,306.106z"}),Object(a.jsx)("path",{style:{fill:"#FFD164"},d:"M404.355,66.065H198.194c-4.561,0-8.258-3.697-8.258-8.258V0H49.548  c-9.122,0-16.516,7.395-16.516,16.516v48.991c0,5.702,1.967,11.229,5.568,15.649l170.541,209.3c3.602,4.42,5.569,9.948,5.569,15.65  v197.625c0,6.139,6.46,10.132,11.951,7.386l17.105-8.552V305.548c0-4.561,3.697-8.258,8.258-8.258h11.74  c5.474,0,10.593-2.712,13.667-7.242L415.346,86.804C421.33,77.985,415.013,66.065,404.355,66.065z"}),Object(a.jsx)("path",{style:{fill:"#FFC350"},d:"M123.502,66.065H33.08c0.126,5.502,2.037,10.817,5.52,15.091l170.541,209.3  c1.681,2.064,2.968,4.383,3.903,6.835h6.065c5.821,0,9.814-5.86,7.686-11.278L146.561,81.78  C142.836,72.299,133.688,66.065,123.502,66.065z"})]})}!function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Blue=3]="Blue",e[e.Brightness=4]="Brightness",e[e.Blur=5]="Blur"}(Ze||(Ze={}));var ct=Object(A.a)((function(){return Object(v.a)({filtersContainer:{minHeight:"65px",display:"flex",position:"fixed",textAlign:"start",verticalAlign:"middle",left:"9px",top:"332px","&:hover":{"& $paper":{display:"block"}}},button:{color:"#FFFFFF",fontWeight:600,fontFamily:"monospace",fontSize:"16px",padding:"16px",width:"56px",height:"56px",margin:"auto 0",background:"rgba(0, 0, 0, 0.20)",boxShadow:"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )",backdropFilter:"blur(10.0px)",WebkitBackdropFilter:"blur( 10.0px )",borderRadius:"32px",borderTop:"1px solid rgba( 255, 255, 255, 0.18 )",borderLeft:"1px solid rgba( 255, 255, 255, 0.18 )"},paper:{color:"white",display:"none",marginLeft:"8px",background:"rgba(0, 0, 0, 0.20)",boxShadow:"0 8px 32px 0 rgba( 255, 255, 255, 0.2 )",backdropFilter:"blur(10.0px)",WebkitBackdropFilter:"blur( 10.0px )",borderRadius:"32px",borderTop:"1px solid rgba( 255, 255, 255, 0.18 )",borderLeft:"1px solid rgba( 255, 255, 255, 0.18 )"},menuList:{display:"flex","&:first-child":{marginLeft:"8px"},"&:last-child":{marginRight:"8px"}}})}));function lt(e){var t=ct(),n=c.a.useState(!1),r=Object(o.a)(n,2),i=r[0],l=r[1],s=c.a.useRef(null),d=function(e){s.current&&s.current.contains(e.target)||l(!1)};var x=c.a.useRef(i);return c.a.useEffect((function(){!0===x.current&&!1===i&&s.current.focus(),x.current=i}),[i]),Object(a.jsxs)("div",{className:t.filtersContainer,children:[Object(a.jsx)(u.a,{style:{},edge:"end",className:t.button,ref:s,onClick:function(){l((function(e){return!e}))},color:"primary",children:Object(a.jsx)(it,{})}),Object(a.jsx)(Ce.a,{className:t.paper,children:Object(a.jsx)(rt.a,{onClickAway:d,children:Object(a.jsxs)(ot.a,{className:t.menuList,autoFocusItem:i,id:"menu-list-grow",onKeyDown:function(e){"Tab"===e.key&&(e.preventDefault(),l(!1))},children:[Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Grey),d(t)},children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("circle",{r:"12",cx:"12",cy:"12",fill:"#bebebe"})})}),Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Red),d(t)},children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("circle",{r:"12",cx:"12",cy:"12",fill:"#FF0000"})})}),Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Green),d(t)},children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("circle",{r:"12",cx:"12",cy:"12",fill:"#00FF00"})})}),Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Blue),d(t)},children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("circle",{r:"12",cx:"12",cy:"12",fill:"#0000FF"})})}),Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Brightness),d(t)},children:Object(a.jsx)(Se.a,{children:Object(a.jsx)("path",{d:"M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 \r 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 \r 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6z",fill:"#FFFFFF"})})}),Object(a.jsx)(u.a,{onClick:function(t){e.onSelect(Ze.Blur),d(t)},children:Object(a.jsx)(Se.a,{children:Object(a.jsx)("path",{d:"M6 13c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 \r 4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 \r .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm-3 \r .5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM6 5c-.55 0-1 \r .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm15 5.5c.28 0 \r .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM14 7c.55 0 1-.45 \r 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0-3.5c.28 0 \r .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zm-11 10c-.28 \r 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm7 7c-.28 \r 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-17c.28 0 \r .5-.22.5-.5s-.22-.5-.5-.5-.5.22-.5.5.22.5.5.5zM10 7c.55 0 1-.45 \r 1-1s-.45-1-1-1-1 .45-1 1 .45 1 1 1zm0 5.5c-.83 0-1.5.67-1.5 \r 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm8 .5c-.55 0-1 \r .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 4c-.55 0-1 .45-1 1s.45 \r 1 1 1 1-.45 1-1-.45-1-1-1zm0-8c-.55 0-1 .45-1 1s.45 1 1 1 \r 1-.45 1-1-.45-1-1-1zm0-4c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 \r 1-1-.45-1-1-1zm3 8.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zM14 \r 17c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm0 3.5c-.28 \r 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm-4-12c-.83 \r 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0 \r 8.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1zm4-4.5c-.83 \r 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-4c-.83 \r 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z",fill:"#FFFFFF"})})})]})})})]})}function st(e,t){var n=new ImageData(e.canvas.width,e.canvas.height);switch(t){case Ze.Red:ut(e.canvas,n,[1,0,0,1]);break;case Ze.Green:ut(e.canvas,n,[0,1,0,1]);break;case Ze.Blue:ut(e.canvas,n,[0,0,1,1]);break;case Ze.Grey:!function(e,t){for(var n=0;n<t.height;n++)for(var a=0;a<t.width;a++){for(var r=4*(n*t.width+a),o=(e.data[r]+e.data[r+1]+e.data[r+2])/3,i=0;i<3;i++)t.data[r+i]=o;t.data[r+3]=e.data[r+3]}}(e.canvas,n);break;case Ze.Blur:!function(e,t){var n=e.canvas,a=n.data,r=new Uint8ClampedArray(a.length);r.set(a);for(var o=0,i=a.length;o<i;o++)o%4!==3&&(a[o]=(r[o]+(r[o-4]||r[o])+(r[o+4]||r[o])+(r[o-4*n.width]||r[o])+(r[o+4*n.width]||r[o])+(r[o-4*n.width-4]||r[o])+(r[o+4*n.width+4]||r[o])+(r[o+4*n.width-4]||r[o])+(r[o-4*n.width+4]||r[o]))/9);t.data.set(a)}(e,n)}return Object(x.a)(Object(x.a)({},e),{},{canvas:n})}function ut(e,t,n){for(var a=0;a<t.height;a++)for(var r=0;r<t.width;r++)for(var o=4*(a*t.width+r),i=0;i<4;i++)t.data[o+i]=e.data[o+i]*n[i]}var dt=n(368),xt=n(349),pt=n(116),ht=n.n(pt),bt=Object(A.a)((function(e){return Object(v.a)({fab:{marginLeft:"24px"},slider:{width:"350px"}})}));function ft(e){var t=e.onApply,n=e.onChange,r=bt(),c=Object(i.useState)(1),l=Object(o.a)(c,2),s=l[0],u=l[1];return Object(a.jsx)("div",{className:ht.a.BrightnessSliderContainer,children:Object(a.jsxs)("div",{className:ht.a.BrightnessSliderCenter,children:[Object(a.jsx)(dt.a,{className:r.slider,defaultValue:1,"aria-labelledby":"discrete-slider-custom",step:.01,min:0,max:4,valueLabelDisplay:"auto",onChange:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var a=t;u(a),n(a)}))}),Object(a.jsx)(xt.a,{color:"primary","aria-label":"add",size:"small",className:r.fab,onClick:function(e){return t(s)},children:Object(a.jsx)(Se.a,{children:Object(a.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})]})})}function jt(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];return function(e,t){n||(a(!0),setTimeout((function(){t(),a(!1)}),e))}}n(108);function yt(e){return Object(a.jsx)("div",{children:Object(a.jsxs)(z,{title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435",isOpen:e.isOpen,onClose:function(){return e.onClose()},children:[Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){e.onSaveSize(),e.onClose()},color:"secondary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u043e\u043b\u043e\u0442\u043d\u0430"}),Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){e.onChangeSize(),e.onClose()},color:"secondary",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440 \u043f\u043e\u043b\u043e\u0442\u043d\u0430"}),Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){return e.onClose()},color:"secondary",children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})})}var vt="UNDO_HISTORY";var Ot=function(){return{type:vt}},gt="REDO_HISTORY";var mt=function(){return{type:gt}},Ct="EDIT_CANVAS_SIZE";var wt=function(e){return{type:Ct,value:e}},Ft="APPLY_FILTER";var St=function(e){return{type:Ft,value:e}},Tt="CREATE_NEW_CANVAS";var kt=function(e){return{type:Tt,value:e}},Mt=n(355),zt=n(356),Et=n(84),At=n(343),Pt=n(344),Lt=n(366),Rt=n(350),It=n(363),_t=Object(A.a)((function(){return Object(v.a)({slider:{width:"272px",margin:"8px 8px 0 8px"},quality_label:{color:"#FFFFFFa5",marginTop:"16px","&.Mui-focused":{color:"#FFFFFFa5"}},label:{color:"#FFFFFFa5","&.Mui-focused":{color:"#FFFFFFa5"}},radioGroup:{marginTop:"8px",flexDirection:"row"},radio:{color:"#FFFFFF8a"}})}));function Nt(e){var t=_t(),n=c.a.useState(!1),r=Object(o.a)(n,2),i=r[0],l=r[1],s=function(){l(!1)},x=c.a.useState(se.JPEG),p=Object(o.a)(x,2),h=p[0],b=p[1],f=c.a.useState(90),j=Object(o.a)(f,2),y=j[0],v=j[1],O=function(){s(),e.onApply(h,y)};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){l(!0)},children:Object(a.jsxs)(Se.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"})]})}),Object(a.jsx)(z,{isOpen:i,onClose:function(){return s()},title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",actions:function(){return Object(a.jsx)(d.a,{autoFocus:!0,onClick:O,color:"secondary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})},children:Object(a.jsxs)(At.a,{component:"fieldset",children:[Object(a.jsx)(Pt.a,{component:"legend",classes:{root:t.label},children:"\u0424\u043e\u0440\u043c\u0430\u0442"}),Object(a.jsxs)(Lt.a,{className:t.radioGroup,"aria-orientation":"horizontal","aria-label":"format",name:"format1",value:de(h),onChange:function(e){switch(e.target.value){case"jpeg":b(se.JPEG);break;case"png":b(se.PNG);break;default:throw new Error}},children:[Object(a.jsx)(Rt.a,{value:"jpeg",control:Object(a.jsx)(It.a,{className:t.radio}),label:"JPEG"}),Object(a.jsx)(Rt.a,{value:"png",control:Object(a.jsx)(It.a,{className:t.radio}),label:"PNG"})]}),Object(a.jsx)(Pt.a,{component:"legend",classes:{root:t.quality_label},children:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e"}),Object(a.jsx)(dt.a,{className:t.slider,defaultValue:90,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:100,valueLabelDisplay:"auto",onChange:function(e,t){v(t)}})]})})]})}var Dt,Ht=n(351),Bt=n(352);function Wt(e){var t=c.a.useState(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],l=function(){i(!1)},s=function(t){e.onApply(t),l()};return Object(a.jsxs)("div",{children:[Object(a.jsx)(u.a,{color:"inherit",onClick:function(){i(!0)},children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{d:"M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z"})})}),Object(a.jsx)(z,{isOpen:r,title:"\u0412\u0441\u0442\u0430\u0432\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",onClose:l,paperStyle:{width:"320px"},children:Object(a.jsxs)(we.a,{style:{color:"#FFFFFFa5"},component:"nav","aria-label":"",children:[Object(a.jsxs)(Fe.a,{button:!0,onClick:function(){return s(Dt.STORAGE)},children:[Object(a.jsx)(Ht.a,{children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{fill:"#F5F5F58a",d:"M21 2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h7v2H8v2h8v-2h-2v-2h7c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H3V4h18v12z"})})}),Object(a.jsx)(Bt.a,{primary:"\u041a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440"})]}),Object(a.jsxs)(Fe.a,{button:!0,onClick:function(){return s(Dt.PEXELS)},children:[Object(a.jsx)(Ht.a,{children:Object(a.jsxs)(Se.a,{viewBox:"0 0 32 32",children:[Object(a.jsx)("path",{d:"M2 0h28a2 2 0 0 1 2 2v28a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2z",fill:"#05A081"}),Object(a.jsx)("path",{d:"M13 21h3.863v-3.752h1.167a3.124 3.124 0 1 0 0-6.248H13v10zm5.863 2H11V9h7.03a5.124 5.124 0 0 1 .833 10.18V23z",fill:"#fff"})]})}),Object(a.jsx)(Bt.a,{primary:"\u0421\u0435\u0440\u0432\u0438\u0441 Pexels"})]}),Object(a.jsxs)(Fe.a,{button:!0,onClick:function(){return s(Dt.WEB_CAMERA)},children:[Object(a.jsx)(Ht.a,{children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{fill:"#F5F5F58a",d:"M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 \r 2c-2.4 0-4.6.85-6.32 2.25l3.66 6.35.06-.1zM21.54 \r 9c-.92-2.92-3.15-5.26-6-6.34L11.88 9h9.66zm.26 1h-7.49l.29.5 \r 4.76 8.25C21 16.97 22 14.61 22 12c0-.69-.07-1.35-.2-2zM8.54 \r 12l-3.9-6.75C3.01 7.03 2 9.39 2 12c0 .69.07 1.35.2 \r 2h7.49l-1.15-2zm-6.08 3c.92 2.92 3.15 5.26 6 6.34L12.12 \r 15H2.46zm11.27 0l-3.9 6.76c.7.15 1.42.24 2.17.24 \r 2.4 0 4.6-.85 6.32-2.25l-3.66-6.35-.93 1.6z"})})}),Object(a.jsx)(Bt.a,{primary:"\u0412\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0430"})]})]})})]})}!function(e){e[e.STORAGE=0]="STORAGE",e[e.PEXELS=1]="PEXELS",e[e.WEB_CAMERA=2]="WEB_CAMERA"}(Dt||(Dt={}));var Gt=n(353),Vt=n(162),Ut=n.n(Vt),Xt=Object(A.a)((function(){return Object(v.a)({searchContainer:{width:"100%",display:"inline-flex",textAlign:"center"},searchField:{width:"40%",marginLeft:"auto",borderRadius:"24px"},searchButtonWrapper:{display:"flex",width:"fit-content",height:"fit-content",margin:"auto auto auto 8px",borderRadius:"50%",backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21"},photoLineContainer:{display:"inline-block",position:"relative",verticalAlign:"top",width:"24%"},searchResultsWrapper:{textAlign:"start",margin:"auto",width:"69%",color:"#FFFFFFd0",font:"24px cursive"},error:{margin:"16px auto 0 auto",width:"fit-content"},photo:{cursor:"pointer",margin:"1px 0"},progressBar:{margin:"16px 0 4px 0",color:"#62ebff"}})})),Yt=n(161),Jt=Object(Yt.a)("563492ad6f917000010000011d7c21ba52c34f0abbefd675f9034e42");function Kt(e,t,n){"Rate limit exceeded"!==e.error?t(e.photos):n()}var qt=n(364);function Zt(e){var t=Xt(),n=Object(i.useState)(!1),r=Object(o.a)(n,2),c=r[0],l=r[1],s=Object(i.useState)(!1),d=Object(o.a)(s,2),x=d[0],p=d[1],h=Object(i.useState)(1),b=Object(o.a)(h,2),f=b[0],j=b[1],y=Object(i.useState)(""),v=Object(o.a)(y,2),O=v[0],g=v[1],m=Object(i.useState)([]),C=Object(o.a)(m,2),w=C[0],F=C[1],S=Object(i.useState)(!1),T=Object(o.a)(S,2),k=T[0],M=T[1],E=jt(),A=function(e,t){M(!0),function(e,t,n,a){""===e?Jt.photos.curated({query:e,per_page:9,page:t,locale:"ru-RU"}).then((function(e){Kt(e,n,a)})):Jt.photos.search({query:e,per_page:9,page:t,locale:"ru-RU"}).then((function(e){Kt(e,n,a)}))}(O,e,(function(e){M(!1),c&&l(!1),F(t.concat(e))}),(function(){M(!1),console.log("\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d \u043b\u0438\u043c\u0438\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432"),c||l(!0),p(!0),E(3e3,(function(){p(!1)}))})),j(e+1)},P=function(){j(1),F([]),A(1,[])},R=function(t){e.onApply(t)};Object(i.useEffect)((function(){if(e.focused&&e.isOpen){var t=function(e){"Enter"===e.key&&P()};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}}));var I=Object(i.useState)(!1),_=Object(o.a)(I,2),N=_[0],D=_[1];return Object(a.jsxs)(z,{title:"\u041f\u043e\u0438\u0441\u043a \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a \u0432 Pexels",paperStyle:{width:"72%",maxWidth:"72%"},contentStyle:{textAlign:"center"},isOpen:e.isOpen,onScroll:function(e){var t=e.currentTarget;!N&&t.offsetHeight+t.scrollTop>=t.scrollHeight?(D(!0),A(f,w)):N&&D(!1)},onClose:function(){e.onClose()},children:[Object(a.jsxs)("div",{className:t.searchContainer,children:[Object(a.jsx)(L,{className:t.searchField,text:O,type:"text",label:"\u041f\u043e\u0438\u0441\u043a",autocomplete:"off",onChange:function(e){g(e.target.value)}}),Object(a.jsx)("div",{className:t.searchButtonWrapper,children:Object(a.jsx)(u.a,{type:"submit","aria-label":"search",onClick:function(){return P()},children:Object(a.jsx)(Ut.a,{htmlColor:"#FFFFFF8a"})})})]}),w.length>0&&!c&&Object(a.jsx)("div",{className:t.searchResultsWrapper,children:Object(a.jsx)("h5",{children:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0437\u0430\u043f\u0440\u043e\u0441\u0430"})}),x&&Object(a.jsx)(qt.a,{className:t.error,variant:"filled",severity:"error",children:"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043b\u0438\u043c\u0438\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432. \u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0432\u0440\u0435\u043c\u044f"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 0===Qt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return R(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e+""+n)}))}),Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 1===Qt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return R(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e.id+""+n)}))}),Object(a.jsx)("div",{className:t.photoLineContainer,children:w.map((function(e,n){return 2===Qt(w,n)&&Object(a.jsx)("img",{className:t.photo,onClick:function(){return R(e)},src:e.src.medium,alt:"\u0410\u0432\u0442\u043e\u0440: "+e.photographer,width:"98%"},e.id+""+n)}))})]}),Object(a.jsx)(Gt.a,{className:t.progressBar,style:{visibility:k?"visible":"hidden"}})]})}function Qt(e,t){var n=t-t%3,a=e[n].height/e[n].width,r=n+1<e.length?e[n+1].height/e[n+1].width:0,o=n+2<e.length?e[n+2].height/e[n+2].width:0,i=[3];a<=r?r<=o?(i[0]=0,i[1]=1,i[2]=2):(o<a?(i[0]=2,i[1]=0):(i[0]=0,i[1]=2),i[2]=1):a<=o?(i[0]=1,i[1]=0,i[2]=2):(o<r?(i[0]=2,i[1]=1):(i[0]=1,i[1]=2),i[2]=0);var c=(t- -Math.floor(t/3+1)%3+3)%3;switch(i[c]){case 1:case 2:if(0===r)return-1}return i[c]}var $t=Object(A.a)((function(){return Object(v.a)({searchField:{margin:"0 8px"},searchButtonWrapper:{display:"flex",width:"fit-content",height:"fit-content",margin:"auto",borderRadius:"50%",backgroundColor:"#cfcfcf21",boxShadow:"4px 4px 16px #55555521, -4px -4px 16px #ffffff21"}})}));function en(e){var t=$t(),n=Object(i.useState)(!0),r=Object(o.a)(n,2),c=r[0],l=r[1],s=Object(i.useState)({x:0,y:0}),x=Object(o.a)(s,2),p=x[0],h=x[1];return Object(i.useEffect)((function(){e.isOpen||0===p.x?null!==e.photo&&0===p.x&&h({x:e.photo.width,y:e.photo.height}):h({x:0,y:0})}),[e,p]),Object(a.jsxs)(z,{title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",paperStyle:{width:"fit-content"},contentStyle:{display:"inline-flex"},isOpen:e.isOpen,onClose:function(){l(!0),e.onClose()},actions:function(){return Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){return function(){if(c){if(e.onClose(),null===e.photo)throw new Error("Photo is null");e.onResult(p,e.photo.src.original)}}()},color:"secondary",children:"\u0414\u0430\u043b\u0435\u0435"})},children:[Object(a.jsx)(L,{className:t.searchField,text:c?p.x.toString():"",type:"number",label:"\u0428\u0438\u0440\u0438\u043d\u0430",min:"0",onChange:function(t){if(l(""!==t.target.value),""!==t.target.value){var n={x:Math.abs(parseInt(t.target.value)),y:0};null!==e.photo&&(n.y=Math.round(n.x*e.photo.height/e.photo.width)),h(n)}}}),Object(a.jsx)("div",{className:t.searchButtonWrapper,children:Object(a.jsx)(u.a,{disabled:!0,type:"submit","aria-label":"search",children:Object(a.jsx)(Se.a,{viewBox:"0 0 24 24",children:Object(a.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 \r 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 \r 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z",fill:"#FFFFFF8a"})})})}),Object(a.jsx)(L,{className:t.searchField,text:c?p.y.toString():"",type:"number",label:"\u0412\u044b\u0441\u043e\u0442\u0430",min:"0",onChange:function(t){if(l(""!==t.target.value),""!==t.target.value){var n={x:0,y:Math.abs(parseInt(t.target.value))};null!==e.photo&&(n.x=Math.round(n.y*e.photo.width/e.photo.height)),h(n)}}})]})}var tn=n(354);function nn(e){return Object(a.jsxs)($e.a,{display:"flex",alignItems:"center",children:[Object(a.jsx)($e.a,{width:"100%",mr:1,children:Object(a.jsx)(tn.a,Object(x.a)({variant:"determinate"},e))}),Object(a.jsx)($e.a,{minWidth:35,children:Object(a.jsx)(O.a,{variant:"body2",color:"textSecondary",children:"".concat(Math.round(e.value),"%")})})]})}function an(e){var t=e.progress,n=e.isOpen;return Object(a.jsx)(z,{paperStyle:{width:"400px"},title:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",isOpen:n,onClose:function(){},children:Object(a.jsx)(nn,{value:t})})}var rn=n(117),on=n.n(rn);function cn(e){var t=Object(i.useState)(null),n=Object(o.a)(t,2),r=n[0],c=n[1],l=Object(i.useState)(!1),s=Object(o.a)(l,2),u=s[0],x=s[1],p=Object(i.useState)(null),h=Object(o.a)(p,2),b=h[0],f=h[1],j=function(){null!==b?f(null):null!==r&&(x(!1),f(function(e){var t=e.videoWidth,n=e.videoHeight,a=document.createElement("canvas");a.width=t,a.height=n;var r=a.getContext("2d");if(null===r)throw new Error;return r.drawImage(e,0,0,t,n),r.getImageData(0,0,t,n)}(r)))},y=function(){e.onClose(),x(!1)},v=function(t){e.isOpen&&!u&&(!function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e.srcObject=t,e.play()})).catch((function(e){console.log("An error occurred: "+e)}))}(t),x(!0),c(t))};return Object(a.jsxs)(z,{paperStyle:{width:"fit-content",maxWidth:"fit-content"},isOpen:e.isOpen,title:"\u0412\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0430",onClose:y,actions:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){return j()},color:"secondary",children:null===b?"\u0417\u0430\u0445\u0432\u0430\u0442":"\u041f\u043e\u0432\u0442\u043e\u0440"}),Object(a.jsx)(d.a,{autoFocus:!0,onClick:function(){null!==b&&function(t){e.onResult({type:M.Art,image:t,position:{x:0,y:0},size:{x:t.width,y:t.height},rotation:0}),y()}(b)},color:"secondary",children:"\u0414\u0430\u043b\u0435\u0435"})]})},children:[null===b&&Object(a.jsx)("video",{className:on.a.mediaContainer,autoPlay:!0,ref:function(e){null!==e&&v(e)}}),null!==b&&Object(a.jsx)("canvas",{className:on.a.mediaContainer,ref:function(e){if(null!==e){var t=e.getContext("2d");null!==t&&t.putImageData(b,0,0)}},width:b.width,height:b.height})]})}var ln=Object(at.a)({palette:{primary:{main:Mt.a.A700},secondary:{main:zt.a.A200+"8a",light:Et.a.A400},text:{secondary:"#FFFFFF"}}}),sn=Object(A.a)((function(e){return Object(v.a)({root:{flexGrow:1,width:"100%"},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,textAlign:"start",fontFamily:"cursive"}})}));var un=function(){var e=sn(),t=jt(),n=Object(r.c)(),c=Object(r.d)((function(e){return e.editor}),r.b),l=Object(r.d)((function(e){return e.currentTool})),u=Object(i.useState)(!1),d=Object(o.a)(u,2),x=d[0],p=d[1],h=Object(i.useState)(null),b=Object(o.a)(h,2),f=b[0],j=b[1],y=Object(i.useState)(!1),v=Object(o.a)(y,2),g=v[0],m=v[1],C=Object(i.useState)(!1),w=Object(o.a)(C,2),F=w[0],S=w[1],T=Object(i.useState)(null),k=Object(o.a)(T,2),M=k[0],z=k[1],E=Object(i.useState)(null),A=Object(o.a)(E,2),P=A[0],L=A[1],R=Object(i.useState)(0),_=Object(o.a)(R,2),N=_[0],D=_[1],H=Object(i.useState)(!1),B=Object(o.a)(H,2),W=B[0],G=B[1];return Object(i.useEffect)((function(){var e=function(e){e.ctrlKey&&("KeyZ"===e.code?n(Ot()):"KeyY"===e.code&&n(mt()))};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}})),Object(a.jsx)("div",{className:s.a.App,id:"App",children:Object(a.jsxs)(nt.a,{theme:ln,children:[Object(a.jsx)(Ie,{focused:!g&&!F&&null===P}),Object(a.jsxs)($e.a,{position:"fixed",className:e.root,children:[Object(a.jsx)(et.a,{position:"static",style:{background:"#6200ea"},children:Object(a.jsxs)(tt.a,{children:[Object(a.jsx)(O.a,{variant:"h6",color:"inherit",className:e.title,children:"Reactive Photo Editor"}),Object(a.jsx)(I,{applyText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",action:kt({x:0,y:0}),children:Object(a.jsxs)(Se.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})]})}),Object(a.jsx)(I,{applyText:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c",action:wt({x:0,y:0}),children:Object(a.jsxs)(Se.a,{children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})]})}),Object(a.jsx)(Wt,{onApply:function(e){switch(e){case Dt.STORAGE:!function(e,t){if(null!==document){var n=document.createElement("input");n.type="file",n.click(),null!==n&&(n.onchange=function(n){var a=n.target;if(null!=a.files){var r=a.files[0];he(URL.createObjectURL(r),e,t)}})}}((function(e){z(e),m(!0)}));break;case Dt.PEXELS:S(!0);break;case Dt.WEB_CAMERA:G(!0)}}}),Object(a.jsx)(Nt,{onApply:function(e,t){!function(e,t,n){var a=de(t),r=document.createElement("canvas");if(r.width=e.width,r.height=e.height,null!=r){var o=r.getContext("2d");null!=o&&(o.putImageData(e,0,0),r.toBlob((function(e){if(null!=e){var t=window.URL.createObjectURL(new Blob([e])),n=document.createElement("a");n.href=t,n.setAttribute("download","image.".concat(a)),document.body.appendChild(n),n.click(),n.remove(),r.remove()}}),"image/".concat(a),n/100))}}(fe(c,null).canvas,e,t)}}),Object(a.jsx)(yt,{isOpen:g,onSaveSize:function(){var e=null!==c.selectedObject,t=c.canvas;n(ce(M)),e&&n(oe(t))},onChangeSize:function(){var e=null!==c.selectedObject,t=c.canvas;if(null===M)throw new Error;n(wt(M.size)),n(ce(M)),e&&n(oe(t))},onClose:function(){m(!1),z(null)}}),Object(a.jsx)(Zt,{focused:null===P,isOpen:F,onClose:function(){S(!1)},onApply:function(e){L(e)}}),Object(a.jsx)(en,{photo:P,isOpen:null!==P,onResult:function(e,t){null!==P&&he(t,(function(t){t.image=function(e,t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var a=n.getContext("2d");if(null===a)throw new Error;a.putImageData(e,0,0);var r=document.createElement("canvas");r.width=t.x,r.height=t.y;var o=n.getContext("2d");if(null===o)throw new Error;return o.scale(t.x/e.width,t.y/e.height),o.drawImage(n,0,0),o.getImageData(0,0,t.x,t.y)}(t.image,e),t.size=e,S(!1),z(t),m(!0)}),(function(e){D(e)})),L(null)},onClose:function(){L(null)}}),Object(a.jsx)(an,{isOpen:N>0&&N<100,progress:N}),Object(a.jsx)(cn,{isOpen:W,onClose:function(){G(!1)},onResult:function(e){z(e),m(!0)}})]})}),Object(a.jsx)(Ae,{onSelected:function(){if(x){if(null===f)throw new Error;n(ue(f)),p(!1)}}}),Object(a.jsx)(lt,{onSelect:function(e){var t=c;if(null!=c.selectedObject){var a=fe(c,null);n(oe(a.canvas)),n(ue(a)),t=a}e!==Ze.Brightness?n(St(e)):(j(t),p(!0))}})]}),l!==ke.Area&&Object(a.jsx)(Qe,{}),x&&Object(a.jsx)(ft,{onChange:function(e){null!==f&&t(16,(function(){var t=function(e,t){for(var n=new ImageData(e.canvas.width,e.canvas.height),a=e.canvas,r=0;r<n.height;r++)for(var o=0;o<n.width;o++){for(var i=4*(r*n.width+o),c=0;c<3;c++)n.data[i+c]=a.data[i+c]*t;n.data[i+3]=a.data[i+3]}return{selectedObject:null,canvas:n}}(f,e);n(ue(t))}))},onApply:function(e){if(p(!1),1!==e){var t=fe(c,null);n(oe(t.canvas)),n(ue(t))}}})]})})},dn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,370)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))},xn=n(163),pn=function(e,t){var n=new ImageData(t.x,t.y);return n.data.fill(255),Object(x.a)(Object(x.a)({},e),{},{selectedObject:null,canvas:n})}({selectedObject:null,canvas:new ImageData(1,1)},{x:800,y:600}),hn={editor:pn,imageHistory:{history:[pn.canvas],currentHistoryPosition:0},currentTool:ke.Rectangle,objectState:{fillColor:_("#00CCCCFF"),strokeColor:_("#CC0000FF"),strokeWidth:4,text:"",textSize:24,textColor:_("#424242FF"),fontName:"Arial",padding:0},canvasModel:{isCanvasDown:!1,start:{x:0,y:0},tempObject:null,isMiddleMouseDown:!1,middleMouseStart:{x:0,y:0},tempPoint:null,scale:1,canvasPosition:{x:(window.innerWidth-pn.canvas.width)/2,y:(window.innerHeight-pn.canvas.height)/2}}};function bn(e,t){for(var n={history:e.history.flatMap((function(e){return xe(e)})),currentHistoryPosition:e.currentHistoryPosition};n.currentHistoryPosition<n.history.length-1;)n.history.pop();return n.currentHistoryPosition===n.history.length-1&&n.currentHistoryPosition++,n.history.push(xe(t)),n}var fn=function(e,t){if(void 0===e)throw new Error;switch(t.type){case We:return Object(x.a)(Object(x.a)({},e),{},{fillColor:t.value});case Ge:return Object(x.a)(Object(x.a)({},e),{},{strokeColor:t.value});case Ve:return Object(x.a)(Object(x.a)({},e),{},{strokeWidth:t.value});case ge:return Object(x.a)(Object(x.a)({},e),{},{text:t.value});case Xe:return Object(x.a)(Object(x.a)({},e),{},{textSize:t.value});case Ue:return Object(x.a)(Object(x.a)({},e),{},{textColor:t.value});case Ye:return Object(x.a)(Object(x.a)({},e),{},{fontName:t.value});case qe:return Object(x.a)(Object(x.a)({},e),{},{padding:t.value});default:return e}},jn=function(e,t){if(void 0===e)throw new Error;var n=e.editor,a={canvas:n.canvas,selectedObject:n.selectedObject},r=e.imageHistory;switch(t.type){case le:return Object(x.a)(Object(x.a)({},e),{},{editor:t.value});case vt:return function(e){var t={selectedObject:e.editor.selectedObject,canvas:e.editor.canvas},n=e.imageHistory;if(n.history.length>0&&(n.currentHistoryPosition>0||null!=t.selectedObject)){if(null==t.selectedObject)n.currentHistoryPosition--;else{if(n=bn(n,xe((t=fe(t,null)).canvas)),void 0===e)throw new Error;n.currentHistoryPosition--}t.canvas=xe(n.history[n.currentHistoryPosition])}return Object(x.a)(Object(x.a)({},e),{},{imageHistory:n,editor:t})}(e);case gt:return function(e){var t={selectedObject:e.editor.selectedObject,canvas:e.editor.canvas},n=e.imageHistory;return n.history.length>0&&n.currentHistoryPosition<n.history.length-1&&(n.currentHistoryPosition++,t.canvas=xe(n.history[n.currentHistoryPosition])),Object(x.a)(Object(x.a)({},e),{},{editor:t,imageHistory:n})}(e);case re:return Object(x.a)(Object(x.a)({},e),{},{imageHistory:bn(r,t.value)});case Te:return Object(x.a)(Object(x.a)({},e),{},{currentTool:t.value});case Ft:var o;return bn(r,a.canvas),o=bn(r,(a=st(a,t.value)).canvas),Object(x.a)(Object(x.a)({},e),{},{imageHistory:o,editor:a});case ee:var i=function(e,t){console.log(t);for(var n={type:M.Art,image:new ImageData(t.size.x,t.size.y),position:{x:Math.round(t.position.x),y:Math.round(t.position.y)},size:{x:Math.round(t.size.x),y:Math.round(t.size.y)},rotation:0},a=xe(e.canvas),r=0;r<n.size.y;r++)for(var o=r*n.size.x,i=(r+n.position.y)*a.width,c=0;c<n.size.x;c++){for(var l=4*(o+c),s=4*(i+c+n.position.x),u=0;u<4;u++)n.image.data[l+u]=a.data[s+u];a.data[s+3]=0}return Object(x.a)(Object(x.a)({},e),{},{selectedObject:n,canvas:a})}(n,t.value);return Object(x.a)(Object(x.a)({},e),{},{editor:i});case ne:return Object(x.a)(Object(x.a)({},e),{},{editor:pe(n)});case ie:return a=fe(n,t.value),Object(x.a)(Object(x.a)({},e),{},{editor:a});case Q:return Object(x.a)(Object(x.a)({},e),{},{editor:je(n)});case ve:return Object(x.a)(Object(x.a)({},e),{},{canvasModel:t.value});case Tt:var c=t.value,l=new ImageData(c.x,c.y);return l.data.fill(255),Object(x.a)(Object(x.a)({},e),{},{editor:Object(x.a)(Object(x.a)({},e.editor),{},{canvas:l}),imageHistory:bn(r,l)});case Ct:var s=t.value,u=new ImageData(s.x,s.y);u.data.fill(255);for(var d=e.editor.canvas,p=Math.min(s.x,d.width),h=Math.min(s.y,d.height),b=0;b<h;b++)for(var f=0;f<p;f++)for(var j=4*(b*s.x+f),y=4*(b*d.width+f),v=0;v<4;v++)u.data[j+v]=d.data[y+v];return Object(x.a)(Object(x.a)({},e),{},{editor:Object(x.a)(Object(x.a)({},e.editor),{},{canvas:u}),imageHistory:bn(r,u)});default:var O=fn(e.objectState,t);if(void 0===O)throw new Error;return Object(x.a)(Object(x.a)({},e),{},{objectState:O})}},yn=Object(xn.a)(jn,hn),vn=n(13),On=n.n(vn);function gn(){On.a.render(Object(a.jsx)(r.a,{store:yn,children:Object(a.jsx)(un,{})}),document.getElementById("root"))}gn(),dn()},58:function(e,t,n){e.exports={ObjectParams:"ObjectParams_ObjectParams__34bSI",ParamsList:"ObjectParams_ParamsList__2892j"}}},[[302,1,2]]]);
//# sourceMappingURL=main.6ba85898.chunk.js.map